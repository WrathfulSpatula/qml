
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Learn how to interpret the Bernstein-Vazirani algorithm with qutrits" property="og:description" />
<meta content="https://pennylane.ai/qml/_images/thumbnail_tutorial_qutrits_bernstein_vazirani.png" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Qutrits and quantum algorithms &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_qutrits_bernstein_vazirani.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Learn how to interpret the Bernstein-Vazirani algorithm with qutrits" property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Qutrits and quantum algorithms &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_qutrits_bernstein_vazirani.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Compilation of quantum circuits" href="tutorial_circuit_compilation.html" />
    <link rel="prev" title="Pulse programming on Rydberg atom hardware" href="ahs_aquila.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial_circuit_compilation.html" title="Compilation of quantum circuits"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ahs_aquila.html" title="Pulse programming on Rydberg atom hardware"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-computing.html" accesskey="U">Quantum Computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Qutrits and quantum algorithms</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-demos-tutorial-qutrits-bernstein-vazirani-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="qutrits-and-quantum-algorithms">
<span id="sphx-glr-demos-tutorial-qutrits-bernstein-vazirani-py"></span><h1>Qutrits and quantum algorithms<a class="headerlink" href="#qutrits-and-quantum-algorithms" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = [];
    var related_tutorials_titles = [];
</script></p>
<p><em>Author: Guillermo Alonso-Linaje — Posted: 9 May 2023. Last updated: 9 May 2023.</em></p>
<p>A qutrit is a basic quantum unit that can exist in a superposition of three possible quantum states, represented as <span class="math notranslate nohighlight">\(|0\rangle\)</span>, <span class="math notranslate nohighlight">\(|1\rangle\)</span>, and <span class="math notranslate nohighlight">\(|2\rangle\)</span>, which functions as a generalization of the qubit.
There are many problems to which we can apply these units, among which we can highlight an improved decomposition of the Toffoli gate.
Using only qubits, it would take at least 6 CNOTs to decompose the gate, whereas with qutrits it would be enough to use 3 <a class="footnote-reference brackets" href="#toffoli-qutrits" id="id1">2</a>.
This is one of the reasons why it is important to develop the intuition behind this basic unit of information, to see where qutrits can provide an advantage. The goal of this demo is to start working with qutrits from an algorithmic point of view. To do so, we will start with the Bernstein–Vazirani algorithm, which we will initially explore using qubits, and later using qutrits.</p>
<div class="section" id="bernsteinvazirani-algorithm">
<h2>Bernstein–Vazirani algorithm<a class="headerlink" href="#bernsteinvazirani-algorithm" title="Permalink to this headline">¶</a></h2>
<p>The Bernstein–Vazirani algorithm is a quantum algorithm developed by Ethan Bernstein and Umesh Vazirani <a class="footnote-reference brackets" href="#bv" id="id2">1</a>.
It was one of the first examples that demonstrated an exponential advantage of a quantum computer over a traditional one. So, in this first section we will understand the problem that they tackled.</p>
<p>Suppose there is some hidden bit string “a” that we are trying to learn, and that we have access to a function <span class="math notranslate nohighlight">\(f(\vec{x})\)</span> that implements the following scalar product:</p>
<div class="math notranslate nohighlight">
\[f(\vec{x}) := \vec{a}\cdot\vec{x} \pmod 2,\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{a}=(a_0,a_1,...,a_{n-1})\)</span> and <span class="math notranslate nohighlight">\(\vec{x}=(x_0,x_1,...,x_{n-1})\)</span> are bit strings of length <span class="math notranslate nohighlight">\(n\)</span> with <span class="math notranslate nohighlight">\(a_i, x_i \in \{0,1\}\)</span>. Our challenge will be to discover the hidden value of <span class="math notranslate nohighlight">\(\vec{a}\)</span> by using the function <span class="math notranslate nohighlight">\(f\)</span>. We don’t know anything about <span class="math notranslate nohighlight">\(\vec{a}\)</span> so the only thing we can do is to evaluate <span class="math notranslate nohighlight">\(f\)</span> at different points <span class="math notranslate nohighlight">\(\vec{x}\)</span> with the idea of gaining hidden information.</p>
<p>To give an example, let’s imagine that we take <span class="math notranslate nohighlight">\(\vec{x}=(1,0,1)\)</span> and get the value <span class="math notranslate nohighlight">\(f(\vec{x}) = 0\)</span>. Although it may not seem obvious, knowing the structure that <span class="math notranslate nohighlight">\(f\)</span> has, this gives us some information about <span class="math notranslate nohighlight">\(\vec{a}\)</span>. In this case, <span class="math notranslate nohighlight">\(a_0\)</span> and <span class="math notranslate nohighlight">\(a_2\)</span> have the same value. This is because taking that value of <span class="math notranslate nohighlight">\(\vec{x}\)</span>, the function will be equivalent to <span class="math notranslate nohighlight">\(a_0 + a_2 \pmod 2\)</span>, which will only take the value 0 if they are equal.
I invite you to take your time to think of a possible strategy (at the classical level) in order to determine <span class="math notranslate nohighlight">\(\vec{a}\)</span> with the minimum number of evaluations of the function <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>The optimal solution requires only <span class="math notranslate nohighlight">\(n\)</span> calls to the function! Let’s see how we can do this.
Knowing the form of <span class="math notranslate nohighlight">\(\vec{a}\)</span> and <span class="math notranslate nohighlight">\(\vec{x}\)</span>, we can rewrite <span class="math notranslate nohighlight">\(f\)</span> as:</p>
<div class="math notranslate nohighlight">
\[f(\vec{x})=\sum_{i=0}^{n-1}a_ix_i \pmod 2.\]</div>
<p>The strategy will be to deduce one element of <span class="math notranslate nohighlight">\(\vec{a}\)</span> with each call to the function. Imagine that we want to determine the value <span class="math notranslate nohighlight">\(a_i\)</span>. We can simply choose <span class="math notranslate nohighlight">\(\vec{x}\)</span> as a vector of all zeros except a one in the i-th position, since in this case:</p>
<div class="math notranslate nohighlight">
\[f(\vec{x})= 0\cdot a_0 + 0\cdot a_1 + ... + 1\cdot a_i + ... + 0\cdot a_{n-1} \pmod 2 \quad= a_i.\]</div>
<p>It is trivial to see, therefore, that <span class="math notranslate nohighlight">\(n\)</span> evaluations of <span class="math notranslate nohighlight">\(f\)</span> are needed. The question is: can we do it more efficiently with a quantum computer? The answer is yes, and in fact, we only need to make one call to the function!</p>
<p>The first step is to see how we can represent this statement in a circuit. In this case, we will assume that we have an oracle <span class="math notranslate nohighlight">\(U_f\)</span> that encodes the function, as we can see in the picture below.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/oracle_qutrit.jpg"><img alt="Oracle definition." src="../_images/oracle_qutrit.jpg" style="width: 628.5999999999999px; height: 345.79999999999995px;" /></a>
<p class="caption"><span class="caption-text">Oracle representation of the function.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>In general, <span class="math notranslate nohighlight">\(U_f\)</span> sends the state <span class="math notranslate nohighlight">\(|\vec{x} \rangle |y\rangle\)</span> to the state <span class="math notranslate nohighlight">\(| \vec{x} \rangle |y + \vec{a} \cdot \vec{x} \pmod{2} \rangle\)</span>.</p>
<p>Suppose, for example, that <span class="math notranslate nohighlight">\(\vec{a}=[0,1,0]\)</span>. Then <span class="math notranslate nohighlight">\(U_f|111\rangle |0\rangle = |111\rangle|1\rangle\)</span>, since we are evaluating <span class="math notranslate nohighlight">\(f\)</span> at the point <span class="math notranslate nohighlight">\(\vec{x} = [1,1,1]\)</span>. The scalar product between the two values is <span class="math notranslate nohighlight">\(1\)</span>, so the last qubit of the output will take the value <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>The Bernstein–Vazirani algorithm makes use of this oracle according to the following circuit:</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../_images/bernstein_vazirani_algorithm.jpg"><img alt="Bernstein-Vazirani's algorithm" src="../_images/bernstein_vazirani_algorithm.jpg" style="width: 669.9px; height: 371.0px;" /></a>
<p class="caption"><span class="caption-text">Bernstein–Vazirani algorithm.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>What we can see is that, by simply using Hadamard gates before and after the oracle, after a single run, the output of the circuit is exactly the hidden value of <span class="math notranslate nohighlight">\(\vec{a}\)</span>. Let’s do a little math to verify that this is so.</p>
<p>First, the input to our circuit is <span class="math notranslate nohighlight">\(|0001\rangle\)</span>. The second step is to apply Hadamard gates to this state, and for this we must use the following property:</p>
<div class="math notranslate nohighlight">
\[H^{\otimes n}|\vec{x}\rangle = \frac{1}{\sqrt{2^n}}\sum_{\vec{z} \in \{0,1\}^n}(-1)^{\vec{x}\cdot\vec{z}}|\vec{z}\rangle.\]</div>
<p>Taking as input the value <span class="math notranslate nohighlight">\(|0001\rangle\)</span>, we obtain the state</p>
<div class="math notranslate nohighlight">
\[|\phi_1\rangle=H^{\otimes 4}|0001\rangle = H^{\otimes 3}|000\rangle\otimes H|1\rangle = \frac{1}{\sqrt{2^3}}\left(\sum_{z \in \{0,1\}^3}|\vec{z}\rangle\right)\left(\frac{|0\rangle-|1\rangle}{\sqrt{2}}\right).\]</div>
<p>As you can see, we have separated the first three qubits from the fourth for clarity.
If we now apply our operator <span class="math notranslate nohighlight">\(U_f\)</span>,</p>
<div class="math notranslate nohighlight">
\[|\phi_2\rangle= U_f |\phi_1\rangle = \frac{1}{\sqrt{2^3}}\left(\sum_{\vec{z} \in \{0,1\}^3}|\vec{z}\rangle\frac{|\vec{a}\cdot\vec{z} \pmod 2\rangle-|1 + \vec{a}\cdot\vec{z} \pmod 2\rangle}{\sqrt{2}}\right).\]</div>
<p>Depending on the value of <span class="math notranslate nohighlight">\(f(\vec{x})\)</span>, the final part of the expression can take two values and it can be checked that</p>
<div class="math notranslate nohighlight">
\[|\phi_2\rangle = \frac{1}{\sqrt{2^3}}\left(\sum_{\vec{z} \in \{0,1\}^3}|\vec{z}\rangle(-1)^{\vec{a}\cdot\vec{z}}\frac{|0\rangle-|1\rangle}{\sqrt{2}}\right).\]</div>
<p>This is because, if <span class="math notranslate nohighlight">\(\vec{a}\cdot\vec{z}\)</span> takes the value <span class="math notranslate nohighlight">\(0\)</span>, we will have the <span class="math notranslate nohighlight">\(\frac{|0\rangle - |1\rangle}{\sqrt{2}}\)</span>, and if it takes the value <span class="math notranslate nohighlight">\(1\)</span>, the result will be <span class="math notranslate nohighlight">\(\frac{|1\rangle - |0\rangle}{\sqrt{2}} = - \frac{|0\rangle - |1\rangle}{\sqrt{2}}\)</span>. Therefore, by calculating <span class="math notranslate nohighlight">\((-1)^{\vec{a}\cdot\vec{z}}\)</span> we cover both cases.
After this, we can include the <span class="math notranslate nohighlight">\((-1)^{\vec{a}\cdot\vec{z}}\)</span> factor in the <span class="math notranslate nohighlight">\(|\vec{z}\rangle\)</span> term and disregard the last qubit, since we are not going to use it again:</p>
<div class="math notranslate nohighlight">
\[|\phi_2\rangle =\frac{1}{\sqrt{2^3}}\sum_{\vec{z} \in \{0,1\}^3}(-1)^{\vec{a}\cdot\vec{z}}|\vec{z}\rangle.\]</div>
<p>Note that you cannot always disregard a qubit. In cases where there is entanglement with other qubits that is not possible, but in this case the state is separable.</p>
<p>Finally, we will reapply the property of the first step to calculate the result after using the Hadamard:</p>
<div class="math notranslate nohighlight">
\[|\phi_3\rangle = H^{\otimes 3}|\phi_2\rangle = \frac{1}{2^3}\sum_{\vec{z} \in \{0,1\}^3}(-1)^{\vec{a}\cdot\vec{z}}\left(\sum_{\vec{y} \in \{0,1\}^3}(-1)^{\vec{z}\cdot\vec{y}}|\vec{y}\rangle\right).\]</div>
<p>Rearranging this expression, we obtain:</p>
<div class="math notranslate nohighlight">
\[|\phi_3\rangle  = \frac{1}{2^3}\sum_{\vec{y} \in \{0,1\}^3}\left(\sum_{\vec{z} \in \{0,1\}^3}(-1)^{\vec{a}\cdot\vec{z}+\vec{y}\cdot\vec{z}}\right)|\vec{y}\rangle.\]</div>
<p>Perfect! The only thing left to check is that, in fact, the previous state is exactly <span class="math notranslate nohighlight">\(|\vec{a}\rangle\)</span>. It may seem complicated, but I invite you to demonstrate it by showing that <span class="math notranslate nohighlight">\(\langle \vec{a}|\phi_3\rangle = 1\)</span>. Let’s go to the code and check that it works.</p>
</div>
<div class="section" id="algorithm-coding-with-qubits">
<h2>Algorithm coding with qubits<a class="headerlink" href="#algorithm-coding-with-qubits" title="Permalink to this headline">¶</a></h2>
<p>We will first code the classical solution. We will do this inside a quantum circuit to understand how to use the oracle, but we are really just programming the qubits as bits.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">shots</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Uf</span><span class="p">():</span>
    <span class="c1"># The oracle in charge of encoding a hidden &quot;a&quot; value.</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span> <span class="p">,</span><span class="mi">3</span><span class="p">])</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit0</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Circuit used to derive a0&quot;&quot;&quot;</span>


    <span class="c1"># Initialize x = [1,0,0]</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Apply our oracle</span>

    <span class="n">Uf</span><span class="p">()</span>

    <span class="c1"># We measure the last qubit</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit1</span><span class="p">():</span>
    <span class="c1"># Circuit used to derive a1</span>

    <span class="c1"># Initialize x = [0,1,0]</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># We apply our oracle</span>
    <span class="n">Uf</span><span class="p">()</span>

    <span class="c1"># We measure the last qubit</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit2</span><span class="p">():</span>
    <span class="c1"># Circuit used to derive a2</span>
    <span class="c1"># Initialize x = [0,0,1]</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># We apply our oracle</span>
    <span class="n">Uf</span><span class="p">()</span>

    <span class="c1"># We measure the last qubit</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># We run for x = [1,0,0]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a0</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit0</span></a><span class="p">()</span>

<span class="c1"># We run for x = [0,1,0]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a1</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit1</span></a><span class="p">()</span>

<span class="c1"># We run for x = [0,0,1]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a2</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit2</span></a><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The value of &#39;a&#39; is [</span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a0</span></a><span class="si">}</span><span class="s2">,</span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a1</span></a><span class="si">}</span><span class="s2">,</span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a2</span></a><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The value of &#39;a&#39; is [0,1,1]
</pre></div>
</div>
<p>In this case, with 3 queries (<span class="math notranslate nohighlight">\(n=3\)</span>), we have discovered the value of <span class="math notranslate nohighlight">\(\vec{a}\)</span>. Let’s run the Bernstein–Vazirani subroutine (using qubits as qubits this time) to check that one call is enough:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit</span><span class="p">():</span>

    <span class="c1"># We initialize to |0001&gt;</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># We run the Hadamards</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1"># We apply our function</span>
    <span class="n">Uf</span><span class="p">()</span>

    <span class="c1"># We run the Hadamards</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1"># We measure the first 3 qubits</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit</span></a><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The value of a is </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The value of a is [0 1 1]
</pre></div>
</div>
<p>Great! Everything works as expected, and we have successfully executed the Bernstein–Vazirani algorithm.
It is important to note that, because of how we defined our device, we are only using a single shot to find this value!</p>
</div>
<div class="section" id="generalization-to-qutrits">
<h2>Generalization to qutrits<a class="headerlink" href="#generalization-to-qutrits" title="Permalink to this headline">¶</a></h2>
<p>To make things more interesting, let’s imagine a new scenario. We are given a function of the form <span class="math notranslate nohighlight">\(f(\vec{x}) := \vec{a}\cdot\vec{x} \pmod 3\)</span> where, <span class="math notranslate nohighlight">\(\vec{a}=(a_0,a_1,...,a_{n-1})\)</span> and <span class="math notranslate nohighlight">\(\vec{x}=(x_0,x_1,...,x_{n-1})\)</span> are strings of length <span class="math notranslate nohighlight">\(n\)</span> with <span class="math notranslate nohighlight">\(a_i, x_i \in \{0,1,2\}\)</span>. How can we minimize the number of calls to the function to discover <span class="math notranslate nohighlight">\(\vec{a}\)</span>? In this case, the classical procedure to detect the value of <span class="math notranslate nohighlight">\(\vec{a}\)</span> is the same as in the case of qubits: we will evaluate the output of the inputs <span class="math notranslate nohighlight">\([1,0,0]\)</span>, <span class="math notranslate nohighlight">\([0,1,0]\)</span> and <span class="math notranslate nohighlight">\([0,0,1]\)</span>.</p>
<p>But how can we work with these kinds of functions in a simple way? To do this we must use a qutrit and its operators.
By using this new unit of information and unlocking the third orthogonal state, we will have states represented with a vector of dimension <span class="math notranslate nohighlight">\(3^n\)</span> and the operators will be <span class="math notranslate nohighlight">\(3^n \times 3^n\)</span> matrices where <span class="math notranslate nohighlight">\(n\)</span> is the number of qutrits.
Specifically, we will use the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TShift.html#pennylane.TShift" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TShift</span></code></a> gate, which is equivalent to the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">PauliX</span></code></a> gate for qutrits. It has the following property:</p>
<div class="math notranslate nohighlight">
\[\text{TShift}|0\rangle = |1\rangle\]</div>
<div class="math notranslate nohighlight">
\[\text{TShift}|1\rangle = |2\rangle\]</div>
<div class="math notranslate nohighlight">
\[\text{TShift}|2\rangle = |0\rangle\]</div>
<p>This means we can use this gate to initialize each of the states.
Another gate that we will use for the oracle definition is the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TAdd.html#pennylane.TAdd" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TAdd</span></code></a> gate, which is the generalization of the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Toffoli.html#pennylane.Toffoli" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Toffoli</span></code></a> gate for qutrits.
These generalizations simply adjust the addition operation to be performed in modulo 3 instead of modulo 2.
So, with these ingredients, we are ready to go to the code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qutrit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Uf</span><span class="p">():</span>
    <span class="c1"># The oracle in charge of encoding a hidden &quot;a&quot; value.</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TAdd.html#pennylane.TAdd" title="pennylane.TAdd" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">TAdd</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TAdd.html#pennylane.TAdd" title="pennylane.TAdd" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">TAdd</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TAdd.html#pennylane.TAdd" title="pennylane.TAdd" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">TAdd</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit0</span><span class="p">():</span>

    <span class="c1"># Initialize x = [1,0,0]</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TShift.html#pennylane.TShift" title="pennylane.TShift" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">TShift</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># We apply our oracle</span>
    <span class="n">Uf</span><span class="p">()</span>

    <span class="c1"># We measure the last qutrit</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit1</span><span class="p">():</span>

    <span class="c1"># Initialize x = [0,1,0]</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TShift.html#pennylane.TShift" title="pennylane.TShift" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">TShift</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># We apply our oracle</span>
    <span class="n">Uf</span><span class="p">()</span>

    <span class="c1"># We measure the last qutrit</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit2</span><span class="p">():</span>

    <span class="c1"># Initialize x = [0,0,1]</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TShift.html#pennylane.TShift" title="pennylane.TShift" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">TShift</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># We apply our oracle</span>
    <span class="n">Uf</span><span class="p">()</span>

    <span class="c1"># We measure the last qutrit</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Run to obtain the three trits of a</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a0</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit0</span></a><span class="p">()</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a1</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit1</span></a><span class="p">()</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a2</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit2</span></a><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The value of a is [</span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a0</span></a><span class="si">}</span><span class="s2">,</span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a1</span></a><span class="si">}</span><span class="s2">,</span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a2</span></a><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The value of a is [0,2,1]
</pre></div>
</div>
<p>The question is, can we perform the same procedure as we have done before to find <span class="math notranslate nohighlight">\(\vec{a}\)</span> using a single shot? The Hadamard gate also generalizes to qutrits (also denoted as <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.THadamard.html#pennylane.THadamard" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">THadamard</span></code></a>), so we could try to simply substitute it and see what happens!</p>
<p>The definition of the Hadamard gate in this space is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{THadamard}=\frac{-i}{\sqrt{3}}\begin{pmatrix}
1 &amp; 1 &amp; 1\\
1 &amp; w &amp; w^2\\
1 &amp; w^2 &amp; w
\end{pmatrix},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(w = e^{\frac{2 \pi i}{3}}\)</span>.
Let’s go to the code and see how to run this in PennyLane.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.devices.default_qutrit.DefaultQutrit.html#pennylane.devices.default_qutrit.DefaultQutrit" title="pennylane.devices.default_qutrit.DefaultQutrit" class="sphx-glr-backref-module-pennylane-devices-default_qutrit sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dev</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit</span><span class="p">():</span>

    <span class="c1"># We initialize to |0001&gt;</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.TShift.html#pennylane.TShift" title="pennylane.TShift" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">TShift</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># We run the THadamard</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.THadamard.html#pennylane.THadamard" title="pennylane.THadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">THadamard</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>

<span class="c1"># We run the oracle</span>
    <span class="n">Uf</span><span class="p">()</span>

<span class="c1"># We run the THadamard again</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.THadamard.html#pennylane.THadamard" title="pennylane.THadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">THadamard</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>

    <span class="c1"># We measure the first 3 qutrits</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit</span></a><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The value of a is </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The value of a is [0 2 1]
</pre></div>
</div>
<p>Awesome! The Bernstein–Vazirani algorithm generalizes perfectly to qutrits! Let’s do the mathematical calculations again to check that it does indeed make sense.</p>
<p>As before, the input of our circuit is <span class="math notranslate nohighlight">\(|0001\rangle\)</span>.
We will then use the Hadamard definition applied to qutrits:</p>
<div class="math notranslate nohighlight">
\[H^{\otimes n}|\vec{x}\rangle = \frac{1}{\sqrt{3^n}}\sum_{\vec{z} \in \{0,1,2\}^n}w^{\vec{x}\cdot\vec{z}}|\vec{z}\rangle.\]</div>
<p>In this case, we are disregarding the global phase of <span class="math notranslate nohighlight">\(-i\)</span> for simplicity.
Applying this to the state <span class="math notranslate nohighlight">\(|0001\rangle\)</span>, we obtain</p>
<div class="math notranslate nohighlight">
\[|\phi_1\rangle=H^{\otimes 4}|0001\rangle = H^{\otimes 3}|000\rangle\otimes H|1\rangle = \frac{1}{\sqrt{3^3}}\left(\sum_{z \in \{0,1,2\}^3}|\vec{z}\rangle\frac{|0\rangle+w|1\rangle+w^2|2\rangle}{\sqrt{3}}\right).\]</div>
<p>After that, we apply the operator <span class="math notranslate nohighlight">\(U_f\)</span> to obtain</p>
<div class="math notranslate nohighlight">
\[|\phi_2\rangle= U_f |\phi_1\rangle = \frac{1}{\sqrt{3^3}}\left(\sum_{\vec{z} \in \{0,1,2\}^3}|\vec{z}\rangle\frac{|0 + \vec{a}\cdot\vec{z} \pmod 3 \rangle+w|1+ \vec{a}\cdot\vec{z} \pmod 3 \rangle+w^2|2+ \vec{a}\cdot\vec{z} \pmod 3 \rangle}{\sqrt{3}}\right).\]</div>
<p>Depending on the value of <span class="math notranslate nohighlight">\(f(\vec{x})\)</span>, as before, we obtain three possible states:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(\vec{a}\cdot\vec{z} = 0\)</span>, we have <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{3}}\left(|0\rangle+w|1\rangle+w^2|2\rangle\right)\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\vec{a}\cdot\vec{z} = 1\)</span>, we have <span class="math notranslate nohighlight">\(\frac{w^2}{\sqrt{3}}\left(|0\rangle+|1\rangle+w|2\rangle\right)\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\vec{a}\cdot\vec{z} = 2\)</span>, we have <span class="math notranslate nohighlight">\(\frac{w}{\sqrt{3}}\left(|0\rangle+w^2|1\rangle+|2\rangle\right)\)</span>.</p></li>
</ul>
<p>Based on this, we can group the three states as <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{3}}w^{-\vec{a}\cdot\vec{z}}\left(|0\rangle+w|1\rangle+w^2|2\rangle\right)\)</span>.</p>
<p>After this, we can enter the coefficient in the <span class="math notranslate nohighlight">\(|\vec{z}\rangle\)</span> term and, as before, disregard the last qutrit, since we are not going to use it again:</p>
<div class="math notranslate nohighlight">
\[|\phi_2\rangle =\frac{1}{\sqrt{3^3}}\sum_{\vec{z} \in \{0,1,2\}^3}w^{-\vec{a}\cdot\vec{z}}|\vec{z}\rangle.\]</div>
<p>Finally, we reapply the THadamard:</p>
<div class="math notranslate nohighlight">
\[|\phi_3\rangle := H^{\otimes 3}|\phi_2\rangle = \frac{1}{3^3}\sum_{\vec{z} \in \{0,1,2\}^3}w^{-\vec{a}\cdot\vec{z}}\left(\sum_{\vec{y} \in \{0,1,2\}^3}w^{\vec{z}\cdot\vec{y}}|\vec{y}\rangle\right).\]</div>
<p>Rearranging this expression, we obtain:</p>
<div class="math notranslate nohighlight">
\[|\phi_3\rangle  = \frac{1}{3^3}\sum_{\vec{y} \in \{0,1,2\}^3}\left(\sum_{\vec{z} \in \{0,1,2\}^3}w^{-\vec{a}\cdot\vec{z}+\vec{y}\cdot\vec{z}}\right)|\vec{y}\rangle.\]</div>
<p>In the same way as before, it can be easily checked that <span class="math notranslate nohighlight">\(\langle \vec{a}|\phi_3\rangle = 1\)</span> and therefore, when measuring, one shot will be enough to obtain the value of <span class="math notranslate nohighlight">\(\vec{a}\)</span>!</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>In this demo, we have practised the use of basic qutrit gates such as TShift or THadamard by applying the Bernstein–Vazirani algorithm. In this case, the generalization has been straightforward and we have found that it makes mathematical sense, but we cannot always substitute qubit gates for qutrit gates as we have seen in the demo. To give an easy example of this, we know the property that <span class="math notranslate nohighlight">\(X = HZH\)</span>, but it turns out that this property does not generalize! The general property is actually <span class="math notranslate nohighlight">\(X = H^{\dagger}ZH\)</span>. In the case of qubits it holds that <span class="math notranslate nohighlight">\(H = H^{\dagger}\)</span>, but in other dimensions it does not. I invite you to continue practising with other types of algorithms. For instance, will the <a class="reference external" href="https://en.wikipedia.org/wiki/Deutsch–Jozsa_algorithm">Deutsch–Jozsa algorithm</a> generalize well? Take a pen and paper and check it out!</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="bv"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Ethan Bernstein, Umesh Vazirani, “Quantum Complexity Theory”. <a class="reference external" href="https://epubs.siam.org/doi/10.1137/S0097539796300921">SIAM Journal on Computing Vol. 26 (1997).</a></p>
</dd>
<dt class="label" id="toffoli-qutrits"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>Alexey Galda, Michael Cubeddu, Naoki Kanazawa, Prineha Narang, Nathan Earnest-Noble, <a class="reference external" href="https://arxiv.org/pdf/2109.00558.pdf">“Implementing a Ternary Decomposition of the Toffoli Gate on Fixed-FrequencyTransmon Qutrits”.</a></p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/guillermo_alonso.jpeg" alt="Guillermo Alonso-Linaje" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Guillermo Alonso-Linaje</h4>
        <p class="bio-text__author-description">Guillermo is a mathematics and computer science graduate from the university of Valladolid and is currently working as an educator and quantum researcher at Xanadu. Fun fact, Guillermo is a great foosball player and is also a paella master.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.029 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-qutrits-bernstein-vazirani-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/6f5dd4d6c6e19d1fdc3c7fbbbee95574/tutorial_qutrits_bernstein_vazirani.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_qutrits_bernstein_vazirani.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b362fbda728333ddbdfb83c294d010f7/tutorial_qutrits_bernstein_vazirani.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_qutrits_bernstein_vazirani.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_qutrits_bernstein_vazirani</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Qutrits and quantum algorithms</a><ul class='current'>
<li class='current'><a class="reference internal" href="#bernsteinvazirani-algorithm">Bernstein–Vazirani algorithm</a></li>
<li class='current'><a class="reference internal" href="#algorithm-coding-with-qubits">Algorithm coding with qubits</a></li>
<li class='current'><a class="reference internal" href="#generalization-to-qutrits">Generalization to qutrits</a></li>
<li class='current'><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_qutrits_bernstein_vazirani</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_quantum-computing.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial_circuit_compilation.html" title="Compilation of quantum circuits"
             >next</a> |</li>
        <li class="right" >
          <a href="ahs_aquila.html" title="Pulse programming on Rydberg atom hardware"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-computing.html" >Quantum Computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Qutrits and quantum algorithms</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>