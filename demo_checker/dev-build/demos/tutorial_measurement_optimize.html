
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Optimize and reduce the number of measurements required to evaluate a variational algorithm cost function." property="og:description" />
<meta content="https://pennylane.ai/qml/_images/grouping.png" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Measurement optimization &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_measurement_optimize.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Optimize and reduce the number of measurements required to evaluate a variational algorithm cost function." property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Measurement optimization &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/xanadu.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_measurement_optimize.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="VQE with parallel QPUs with Rigetti" href="vqe_parallel.html" />
    <link rel="prev" title="VQE in different spin sectors" href="tutorial_vqe_spin_sectors.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="vqe_parallel.html" title="VQE with parallel QPUs with Rigetti"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_vqe_spin_sectors.html" title="VQE in different spin sectors"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demos_quantum-chemistry.html" accesskey="U">Quantum Chemistry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Measurement optimization</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-demos-tutorial-measurement-optimize-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="measurement-optimization">
<span id="sphx-glr-demos-tutorial-measurement-optimize-py"></span><h1>Measurement optimization<a class="headerlink" href="#measurement-optimization" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = ["tutorial_vqe.html", "tutorial_quantum_chemistry.html", "tutorial_qaoa_intro.html"];
    var related_tutorials_titles = ['A brief overview of VQE', 'Building molecular Hamiltonians', 'Intro to QAOA'];
</script></p>
<p><em>Author: Josh Izaac — Posted: 18 January 2021. Last updated: 29 August 2023.</em></p>
<p>The variational quantum eigensolver (VQE) is the OG variational quantum algorithm. Harnessing
near-term quantum hardware to solve for the electronic structure of molecules, VQE is <em>the</em>
algorithm that sparked the variational circuit craze of the last 5 years, and holds great
promise for showcasing a quantum advantage on near-term quantum hardware. It has also inspired
other quantum algorithms such as the <a class="reference internal" href="tutorial_qaoa_intro.html"><span class="doc">Quantum Approximate Optimization Algorithm (QAOA)</span></a>.</p>
<p>To scale VQE beyond the regime of classical computation, however, we need to solve for the
ground state of increasingly larger molecules. A consequence is that the number of
measurements we need to make on the quantum hardware also grows polynomially—a huge bottleneck,
especially when quantum hardware access is limited and expensive.</p>
<p>To mitigate this ‘measurement problem’, a plethora of recent research dropped over the course of
2019 and 2020 <a class="footnote-reference brackets" href="#yen2020" id="id1">2</a> <a class="footnote-reference brackets" href="#izmaylov2019" id="id2">3</a> <a class="footnote-reference brackets" href="#huggins2019" id="id3">4</a> <a class="footnote-reference brackets" href="#gokhale2020" id="id4">5</a> <a class="footnote-reference brackets" href="#verteletskyi2020" id="id5">6</a> ,
exploring potential strategies to minimize the number of measurements required. In fact, by grouping
commuting terms of the Hamiltonian, we can significantly reduce the number of
measurements needed—in some cases, reducing the number of measurements by up to 90%!</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/grouping.png"><img alt="../_images/grouping.png" src="../_images/grouping.png" style="width: 90%;" /></a>
</div>
<p>In this demonstration, we revisit the VQE algorithm, see first-hand how the required number of
measurements scales as molecule size increases, and finally use these measurement optimization
strategies to minimize the number of measurements we need to make. These techniques are valuable
beyond just VQE, allowing you to add measurement optimization to your toolkit of techniques to
perform variational algorithms more efficiently.</p>
<div class="section" id="revisiting-vqe">
<h2>Revisiting VQE<a class="headerlink" href="#revisiting-vqe" title="Permalink to this headline">¶</a></h2>
<p>The study of <span class="xref std std-doc">variational quantum algorithms</span> was spearheaded
by the introduction of the <a class="reference internal" href="tutorial_vqe.html"><span class="doc">variational quantum eigensolver</span></a> (VQE) algorithm in
2014 <a class="footnote-reference brackets" href="#peruzzo2014" id="id6">1</a>. While classical variational techniques have been known for decades to estimate
the ground state energy of a molecule, VQE allowed this variational technique to be applied using
quantum computers. Since then, the field of variational quantum algorithms has evolved
significantly, with larger and more complex models being proposed (such as
<a class="reference internal" href="quantum_neural_net.html"><span class="doc">quantum neural networks</span></a>, <a class="reference internal" href="tutorial_QGAN.html"><span class="doc">QGANs</span></a>, and
<a class="reference internal" href="tutorial_variational_classifier.html"><span class="doc">variational classifiers</span></a>). However, quantum chemistry
remains one of the flagship use-cases for variational quantum algorithms, and VQE the standard-bearer.</p>
<p>Part of the appeal of VQE lies within its simplicity. A circuit ansatz <span class="math notranslate nohighlight">\(U(\theta)\)</span> is chosen
(typically the Unitary Coupled-Cluster Singles and Doubles
(<code class="xref py py-func docutils literal notranslate"><span class="pre">UCCSD()</span></code>) ansatz), and the qubit representation of the
molecular Hamiltonian is computed:</p>
<div class="math notranslate nohighlight">
\[H = \sum_i c_i h_i,\]</div>
<p>where <span class="math notranslate nohighlight">\(h_i\)</span> are the terms of the Hamiltonian written as a tensor product of Pauli operators or the identity
acting on wire <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(P_n \in \{I, \sigma_x, \sigma_y, \sigma_z\}\)</span>:</p>
<div class="math notranslate nohighlight">
\[h_i = \bigotimes_{n=0}^{N-1} P_n.\]</div>
<p>(The <span class="math notranslate nohighlight">\(h_i\)</span> product of Pauli terms is often referred to as a ‘Pauli word’ in the literature.) The cost
function of the VQE is then simply the expectation value of this Hamiltonian on the state obtained
after running the variational quantum circuit:</p>
<div class="math notranslate nohighlight">
\[\text{cost}(\theta) = \langle 0 | U(\theta)^\dagger H U(\theta) | 0 \rangle.\]</div>
<p>By using a classical optimizer to <em>minimize</em> this quantity, we can estimate
the ground state energy of the Hamiltonian <span class="math notranslate nohighlight">\(H\)</span>:</p>
<div class="math notranslate nohighlight">
\[H U(\theta_{min}) |0\rangle = E_{min} U(\theta_{min}) |0\rangle.\]</div>
<p>In practice, when we are using quantum hardware to compute these expectation values we expand out
the Hamiltonian as its summation, resulting in separate expectation values that need to be calculated for each term:</p>
<div class="math notranslate nohighlight">
\[\text{cost}(\theta) = \langle 0 | U(\theta)^\dagger \left(\sum_i c_i h_i\right) U(\theta) | 0 \rangle
                    = \sum_i c_i \langle 0 | U(\theta)^\dagger h_i U(\theta) | 0 \rangle.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>How do we compute the qubit representation of the molecular Hamiltonian? This is a more
complicated story that involves applying a self-consistent field method (such as Hartree-Fock),
and then performing a fermionic-to-qubit mapping such as the Jordan-Wigner or Bravyi-Kitaev
transformations.</p>
<p>For more details on this process, check out the <a class="reference internal" href="tutorial_quantum_chemistry.html"><span class="doc">Building molecular Hamiltonians</span></a>
tutorial.</p>
</div>
</div>
<div class="section" id="the-measurement-problem">
<h2>The measurement problem<a class="headerlink" href="#the-measurement-problem" title="Permalink to this headline">¶</a></h2>
<p>For small molecules, the VQE algorithm scales and performs exceedingly well. For example, for the
Hydrogen molecule <span class="math notranslate nohighlight">\(\text{H}_2\)</span>, the final Hamiltonian in its qubit representation
has 15 terms that need to be measured. Let’s obtain the Hamiltonian from
<a class="reference external" href="https://pennylane.ai/datasets/qchem/h2-molecule">PennyLane’s dataset library</a>
to verify the number of terms. In this tutorial, we use the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.data.load.html#pennylane.data.load" title="(in PennyLane v0.32)"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a>
function to download the dataset of the molecule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">pennylane</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.data.Dataset.html#pennylane.data.Dataset" title="pennylane.data.Dataset" class="sphx-glr-backref-module-pennylane-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.data.load.html#pennylane.data.load" title="pennylane.data.load" class="sphx-glr-backref-module-pennylane-data sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span></a><span class="p">(</span><span class="s1">&#39;qchem&#39;</span><span class="p">,</span> <span class="n">molname</span><span class="o">=</span><span class="s2">&quot;H2&quot;</span><span class="p">,</span> <span class="n">bondlength</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">,</span> <span class="n">num_qubits</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span><span class="o">.</span><span class="n">hamiltonian</span></a><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">dataset</span><span class="o">.</span><span class="n">hamiltonian</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Required number of qubits:&quot;</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Required number of qubits: 4
  (-0.24274207634326223) [Z3]
+ (-0.24274207634326217) [Z2]
+ (-0.0420810913108105) [I0]
+ (0.17771264351002827) [Z1]
+ (0.1777126435100283) [Z0]
+ (0.12293296729540214) [Z0 Z2]
+ (0.12293296729540214) [Z1 Z3]
+ (0.16768313073714647) [Z0 Z3]
+ (0.16768313073714647) [Z1 Z2]
+ (0.17059731519782262) [Z0 Z1]
+ (0.17627633955709188) [Z2 Z3]
+ (-0.04475016344174434) [Y0 Y1 X2 X3]
+ (-0.04475016344174434) [X0 X1 Y2 Y3]
+ (0.04475016344174434) [Y0 X1 X2 Y3]
+ (0.04475016344174434) [X0 Y1 Y2 X3]
</pre></div>
</div>
<p>Here, we can see that the Hamiltonian involves 15 terms, so we expect to compute 15 expectation values
on hardware. Let’s generate the cost function to check this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 4 qubit simulator</span>
<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># number of electrons</span>
<span class="n">electrons</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Define the Hartree-Fock initial state for our variational circuit</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">initial_state</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.hf_state.html#pennylane.qchem.hf_state" title="pennylane.qchem.hf_state" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">hf_state</span></a><span class="p">(</span><span class="n">electrons</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">)</span>

<span class="c1"># Construct the UCCSD ansatz</span>
<span class="n">singles</span><span class="p">,</span> <span class="n">doubles</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.excitations.html#pennylane.qchem.excitations" title="pennylane.qchem.excitations" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">excitations</span></a><span class="p">(</span><span class="n">electrons</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">)</span>
<span class="n">s_wires</span><span class="p">,</span> <span class="n">d_wires</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.excitations_to_wires.html#pennylane.qchem.excitations_to_wires" title="pennylane.qchem.excitations_to_wires" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">excitations_to_wires</span></a><span class="p">(</span><span class="n">singles</span><span class="p">,</span> <span class="n">doubles</span><span class="p">)</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.UCCSD.html#pennylane.UCCSD" title="pennylane.UCCSD" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">UCCSD</span></a><span class="p">,</span> <span class="n">init_state</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">initial_state</span></a><span class="p">,</span> <span class="n">s_wires</span><span class="o">=</span><span class="n">s_wires</span><span class="p">,</span> <span class="n">d_wires</span><span class="o">=</span><span class="n">d_wires</span>
<span class="p">)</span>

<span class="c1"># generate the cost function</span>
<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cost_circuit</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">):</span>
    <span class="n">ansatz</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Device.html#pennylane.Device.wires" title="pennylane.Device.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">dev</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">)</span>
</pre></div>
</div>
<p>If we evaluate this cost function, we can see that it corresponds to 15 different
QNodes under the hood—one per expectation value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">singles</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">doubles</span><span class="p">))</span>
<span class="k">with</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Tracker.html#pennylane.Tracker" title="pennylane.Tracker" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Tracker</span></a><span class="p">(</span><span class="n">dev</span><span class="p">)</span> <span class="k">as</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Tracker.html#pennylane.Tracker" title="pennylane.Tracker" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tracker</span></a><span class="p">:</span>  <span class="c1"># track the number of executions</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cost function value:&quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cost_circuit</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of quantum evaluations:&quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Tracker.html#pennylane.Tracker" title="pennylane.Tracker" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tracker</span></a><span class="o">.</span><span class="n">totals</span><span class="p">[</span><span class="s1">&#39;executions&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Cost function value: -0.6072419446603419
Number of quantum evaluations: 15
</pre></div>
</div>
<p>How about a larger molecule? Let’s try the
<a class="reference external" href="https://pennylane.ai/datasets/qchem/h2o-molecule">water molecule</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.data.Dataset.html#pennylane.data.Dataset" title="pennylane.data.Dataset" class="sphx-glr-backref-module-pennylane-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.data.load.html#pennylane.data.load" title="pennylane.data.load" class="sphx-glr-backref-module-pennylane-data sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span></a><span class="p">(</span><span class="s1">&#39;qchem&#39;</span><span class="p">,</span> <span class="n">molname</span><span class="o">=</span><span class="s2">&quot;H2O&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">,</span> <span class="n">num_qubits</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span><span class="o">.</span><span class="n">hamiltonian</span></a><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">dataset</span><span class="o">.</span><span class="n">hamiltonian</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Required number of qubits:&quot;</span><span class="p">,</span> <span class="n">num_qubits</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Hamiltonian terms/required measurements:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.ops" title="pennylane.Hamiltonian.ops" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">ops</span></a><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Required number of qubits: 14
Number of Hamiltonian terms/required measurements: 1086

   (-46.421431675914974) [I0]
+ (0.7790316054736188) [Z10]
+ (0.7790316054736188) [Z11]
+ (0.8061952803651908) [Z13]
+ (0.8061952803651911) [Z12]
+ (1.2103083151126837) [Z4]
+ (1.2103083151126837) [Z5]
+ (1.3157388307150877) [Z6]
+ (1.315738830715088) [Z7]
+ (1.3709101481720398) [Z8]
+ (1.3709101481720398) [Z9]
+ (1.6565547785025518) [Z2]
+ (1.656554778502552) [Z3]
+ (12.413502468737338) [Z0]
+ (12.41350246873734) [Z1]
+ (0.0032420967157235307) [Y1 Y3]
+ (0.0032420967157235307) [X1 X3]
+ (0.10415911586049934) [Y0 Y2]
+ (0.10415911586049934) [X0 X2]
+ (0.11275822703796641) [Z10 Z12]
+ (0.11275822703796641) [Z11 Z13]
+ (0.1145787909816291) [Z4 Z12]
+ (0.1145787909816291) [Z5 Z13]
+ (0.120097414040042) [Z6 Z10]
+ (0.120097414040042) [Z7 Z11]
+ (0.1251441480918281) [Z4 Z10]
+ (0.1251441480918281) [Z5 Z11]
+ (0.12519112874902263) [Z2 Z4]
+ (0.12519112874902263) [Z3 Z5]
+ (0.1280760452120424) [Z2 Z10]
+ (0.1280760452120424) [Z3 Z11]
+ (0.13482163964137722) [Z6 Z12]
+ (0.13482163964137722) [Z7 Z13]
+ (0.13727090968290484) [Z6 Z11]
+ (0.13727090968290484) [Z7 Z10]
+ (0.13759370130162096) [Z8 Z10]
+ (0.13759370130162096) [Z9 Z11]
+ (0.1378272591963818) [Z4 Z6]
+ (0.1378272591963818) [Z5 Z7]
+ (0.13790564745509523) [Z2 Z6]
+ (0.13790564745509523) [Z3 Z7]
+ (0.14059032342640723) [Z2 Z12]
+ (0.14059032342640723) [Z3 Z13]
+ (0.1415851059922314) [Z10 Z13]
+ (0.1415851059922314) [Z11 Z12]
+ (0.14287143233732985) [Z4 Z11]
+ (0.14287143233732985) [Z5 Z10]
+ (0.14724321799698614) [Z8 Z11]
+ (0.14724321799698614) [Z9 Z10]
+ (0.14928944434357572) [Z10 Z11]
+ (0.14963856770280556) [Z4 Z7]
+ (0.14963856770280556) [Z5 Z6]
+ (0.15003230798525516) [Z4 Z8]
+ (0.15003230798525516) [Z5 Z9]
+ (0.15016565255618913) [Z8 Z12]
+ (0.15016565255618913) [Z9 Z13]
+ (0.15073589889609734) [Z2 Z8]
+ (0.15073589889609734) [Z3 Z9]
+ (0.1520653000883398) [Z6 Z13]
+ (0.1520653000883398) [Z7 Z12]
+ (0.1526993467697872) [Z4 Z13]
+ (0.1526993467697872) [Z5 Z12]
+ (0.15355197195070946) [Z2 Z11]
+ (0.15355197195070946) [Z3 Z10]
+ (0.15488922030082442) [Z12 Z13]
+ (0.15606531401720045) [Z2 Z13]
+ (0.15606531401720045) [Z3 Z12]
+ (0.1562528137728379) [Z8 Z13]
+ (0.1562528137728379) [Z9 Z12]
+ (0.15723368530539267) [Z4 Z9]
+ (0.15723368530539267) [Z5 Z8]
+ (0.15826676384715085) [Z4 Z5]
+ (0.16130188559439496) [Z2 Z5]
+ (0.16130188559439496) [Z3 Z4]
+ (0.16825359450925598) [Z6 Z8]
+ (0.16825359450925598) [Z7 Z9]
+ (0.16891501010958085) [Z2 Z7]
+ (0.16891501010958085) [Z3 Z6]
+ (0.1820492068930126) [Z2 Z3]
+ (0.18223454190628713) [Z6 Z9]
+ (0.18223454190628713) [Z7 Z8]
+ (0.18684980748771135) [Z2 Z9]
+ (0.18684980748771135) [Z3 Z8]
+ (0.19285571144790767) [Z0 Z10]
+ (0.19285571144790767) [Z1 Z11]
+ (0.19569423041070688) [Z6 Z7]
+ (0.19725502492385955) [Z0 Z4]
+ (0.19725502492385955) [Z1 Z5]
+ (0.20000397432263523) [Z0 Z5]
+ (0.20000397432263523) [Z1 Z4]
+ (0.20068578779013369) [Z0 Z11]
+ (0.20068578779013369) [Z1 Z10]
+ (0.2118980369777341) [Z0 Z12]
+ (0.2118980369777341) [Z1 Z13]
+ (0.21724649031212645) [Z0 Z13]
+ (0.21724649031212645) [Z1 Z12]
+ (0.22003977334376124) [Z8 Z9]
+ (0.23659660906959434) [Z0 Z2]
+ (0.23659660906959434) [Z1 Z3]
+ (0.2430241869727193) [Z0 Z6]
+ (0.2430241869727193) [Z1 Z7]
+ (0.2499689161457651) [Z0 Z7]
+ (0.2499689161457651) [Z1 Z6]
+ (0.2511396491382947) [Z0 Z3]
+ (0.2511396491382947) [Z1 Z2]
+ (0.27232288002835) [Z0 Z8]
+ (0.27232288002835) [Z1 Z9]
+ (0.2788340572623095) [Z0 Z9]
+ (0.2788340572623095) [Z1 Z8]
+ (1.1861251621636024) [Z0 Z1]
+ (0.1250560526426366) [Y0 Z1 Y2]
+ (0.1250560526426366) [X0 Z1 X2]
+ (0.1250560526426367) [Y1 Z2 Y3]
+ (0.1250560526426367) [X1 Z2 X3]
+ (-0.0381205557881581) [Y4 Y5 X12 X13]
+ (-0.0381205557881581) [X4 X5 Y12 Y13]
+ (-0.036113908591614015) [Y2 Y3 X8 X9]
+ (-0.036113908591614015) [X2 X3 Y8 Y9]
+ (-0.0361107568453723) [Y2 Y3 X4 X5]
+ (-0.0361107568453723) [X2 X3 Y4 Y5]
+ (-0.031009362654485624) [Y2 Y3 X6 X7]
+ (-0.031009362654485624) [X2 X3 Y6 Y7]
+ (-0.02882687895426497) [Y10 Y11 X12 X13]
+ (-0.02882687895426497) [X10 X11 Y12 Y13]
+ (-0.026113308105017777) [Y3 Z4 Z5 Y7]
+ (-0.026113308105017777) [X3 Z4 Z5 X7]
+ (-0.025475926738667033) [Y2 Y3 X10 X11]
+ (-0.025475926738667033) [X2 X3 Y10 Y11]
+ (-0.01918681967778316) [Y3 Y4 X11 X12]
+ (-0.01918681967778316) [X3 X4 Y11 Y12]
+ (-0.017727284245501754) [Y4 Y5 X10 X11]
+ (-0.017727284245501754) [X4 X5 Y10 Y11]
+ (-0.017243660446962596) [Y6 Y7 X12 X13]
+ (-0.017243660446962596) [X6 X7 Y12 Y13]
+ (-0.017173495642862826) [Y6 Y7 X10 X11]
+ (-0.017173495642862826) [X6 X7 Y10 Y11]
+ (-0.015474990590793231) [Y2 Y3 X12 X13]
+ (-0.015474990590793231) [X2 X3 Y12 Y13]
+ (-0.014543040068700303) [Y0 Y1 X2 X3]
+ (-0.014543040068700303) [X0 X1 Y2 Y3]
+ (-0.013980947397031169) [Y6 Y7 X8 X9]
+ (-0.013980947397031169) [X6 X7 Y8 Y9]
+ (-0.011811308506423746) [Y4 Y5 X6 X7]
+ (-0.011811308506423746) [X4 X5 Y6 Y7]
+ (-0.011108457108600134) [Y5 X6 X11 Y12]
+ (-0.011108457108600134) [X5 Y6 Y11 X12]
+ (-0.009649516695365153) [Y8 Y9 X10 X11]
+ (-0.009649516695365153) [X8 X9 Y10 Y11]
+ (-0.008115181324565627) [Y1 X2 X8 Y9]
+ (-0.008115181324565627) [Y1 Y2 Y8 Y9]
+ (-0.008115181324565627) [X1 X2 X8 X9]
+ (-0.008115181324565627) [X1 Y2 Y8 X9]
+ (-0.007830076342226015) [Y0 Y1 X10 X11]
+ (-0.007830076342226015) [X0 X1 Y10 Y11]
+ (-0.0072013773201374965) [Y4 Y5 X8 X9]
+ (-0.0072013773201374965) [X4 X5 Y8 Y9]
+ (-0.006944729173045844) [Y0 Y1 X6 X7]
+ (-0.006944729173045844) [X0 X1 Y6 Y7]
+ (-0.006511177233959526) [Y0 Y1 X8 X9]
+ (-0.006511177233959526) [X0 X1 Y8 Y9]
+ (-0.006087161216648779) [Y8 Y9 X12 X13]
+ (-0.006087161216648779) [X8 X9 Y12 Y13]
+ (-0.005348453334392331) [Y0 Y1 X12 X13]
+ (-0.005348453334392331) [X0 X1 Y12 Y13]
+ (-0.004990156593291568) [Y3 X4 X5 Y6]
+ (-0.004990156593291568) [X3 Y4 Y5 X6]
+ (-0.004730293682201409) [Y1 X2 X6 Y7]
+ (-0.004730293682201409) [Y1 Y2 Y6 Y7]
+ (-0.004730293682201409) [X1 X2 X6 X7]
+ (-0.004730293682201409) [X1 Y2 Y6 X7]
+ (-0.004576297243946688) [Y1 X2 X12 Y13]
+ (-0.004576297243946688) [Y1 Y2 Y12 Y13]
+ (-0.004576297243946688) [X1 X2 X12 X13]
+ (-0.004576297243946688) [X1 Y2 Y12 X13]
+ (-0.004441903192898146) [Y1 X2 X4 Y5]
+ (-0.004441903192898146) [Y1 Y2 Y4 Y5]
+ (-0.004441903192898146) [X1 X2 X4 X5]
+ (-0.004441903192898146) [X1 Y2 Y4 X5]
+ (-0.0032629526380604343) [Y2 Z3 Z5 Y6]
+ (-0.0032629526380604343) [X2 Z3 Z5 X6]
+ (-0.0032629526380604343) [Y3 Z4 Z6 Y7]
+ (-0.0032629526380604343) [X3 Z4 Z6 X7]
+ (-0.0027489493987757044) [Y0 Y1 X4 X5]
+ (-0.0027489493987757044) [X0 X1 Y4 Y5]
+ (-0.0017014938967297535) [Y1 X2 X10 Y11]
+ (-0.0017014938967297535) [Y1 Y2 Y10 Y11]
+ (-0.0017014938967297535) [X1 X2 X10 X11]
+ (-0.0017014938967297535) [X1 Y2 Y10 X11]
+ (-0.0004385463157808554) [Y7 Y8 X9 X10]
+ (-0.0004385463157808554) [X7 X8 Y9 Y10]
+ (0.0004385463157808554) [Y7 X8 X9 Y10]
+ (0.0004385463157808554) [X7 Y8 Y9 X10]
+ (0.001031592666904919) [Y2 Z4 Z5 Y6]
+ (0.001031592666904919) [X2 Z4 Z5 X6]
+ (0.0011014787796554295) [Y0 Z1 Y2 Z5]
+ (0.0011014787796554295) [X0 Z1 X2 Z5]
+ (0.0011014787796554295) [Y1 Z2 Y3 Z4]
+ (0.0011014787796554295) [X1 Z2 X3 Z4]
+ (0.001727203955231133) [Y2 Z3 Z4 Y6]
+ (0.001727203955231133) [X2 Z3 Z4 X6]
+ (0.001727203955231133) [Y3 Z5 Z6 Y7]
+ (0.001727203955231133) [X3 Z5 Z6 X7]
+ (0.0017445080722106642) [Y0 Z1 Y2 Z11]
+ (0.0017445080722106642) [X0 Z1 X2 Z11]
+ (0.0017445080722106642) [Y1 Z2 Y3 Z10]
+ (0.0017445080722106642) [X1 Z2 X3 Z10]
+ (0.0023500642240618943) [Y0 Z1 Y2 Z13]
+ (0.0023500642240618943) [X0 Z1 X2 Z13]
+ (0.0023500642240618943) [Y1 Z2 Y3 Z12]
+ (0.0023500642240618943) [X1 Z2 X3 Z12]
+ (0.0027489493987757044) [Y0 X1 X4 Y5]
+ (0.0027489493987757044) [X0 Y1 Y4 X5]
+ (0.0029234099933600575) [Y0 Z1 Y2 Z9]
+ (0.0029234099933600575) [X0 Z1 X2 Z9]
+ (0.0029234099933600575) [Y1 Z2 Y3 Z8]
+ (0.0029234099933600575) [X1 Z2 X3 Z8]
+ (0.003242096715723531) [Y0 Z1 Y2 Z3]
+ (0.003242096715723531) [X0 Z1 X2 Z3]
+ (0.0033922983124215615) [Y0 Z1 Y2 Z7]
+ (0.0033922983124215615) [X0 Z1 X2 Z7]
+ (0.0033922983124215615) [Y1 Z2 Y3 Z6]
+ (0.0033922983124215615) [X1 Z2 X3 Z6]
+ (0.0034460019689404177) [Y0 Z1 Y2 Z10]
+ (0.0034460019689404177) [X0 Z1 X2 Z10]
+ (0.0034460019689404177) [Y1 Z2 Y3 Z11]
+ (0.0034460019689404177) [X1 Z2 X3 Z11]
+ (0.004990156593291568) [Y3 Y4 X5 X6]
+ (0.004990156593291568) [X3 X4 Y5 Y6]
+ (0.005348453334392331) [Y0 X1 X12 Y13]
+ (0.005348453334392331) [X0 Y1 Y12 X13]
+ (0.005543381972553576) [Y0 Z1 Y2 Z4]
+ (0.005543381972553576) [X0 Z1 X2 Z4]
+ (0.005543381972553576) [Y1 Z2 Y3 Z5]
+ (0.005543381972553576) [X1 Z2 X3 Z5]
+ (0.006087161216648779) [Y8 X9 X12 Y13]
+ (0.006087161216648779) [X8 Y9 Y12 X13]
+ (0.006511177233959526) [Y0 X1 X8 Y9]
+ (0.006511177233959526) [X0 Y1 Y8 X9]
+ (0.006926361468008581) [Y0 Z1 Y2 Z12]
+ (0.006926361468008581) [X0 Z1 X2 Z12]
+ (0.006926361468008581) [Y1 Z2 Y3 Z13]
+ (0.006926361468008581) [X1 Z2 X3 Z13]
+ (0.006944729173045844) [Y0 X1 X6 Y7]
+ (0.006944729173045844) [X0 Y1 Y6 X7]
+ (0.0072013773201374965) [Y4 X5 X8 Y9]
+ (0.0072013773201374965) [X4 Y5 Y8 X9]
+ (0.007830076342226015) [Y0 X1 X10 Y11]
+ (0.007830076342226015) [X0 Y1 Y10 X11]
+ (0.008122591994622971) [Y0 Z1 Y2 Z6]
+ (0.008122591994622971) [X0 Z1 X2 Z6]
+ (0.008122591994622971) [Y1 Z2 Y3 Z7]
+ (0.008122591994622971) [X1 Z2 X3 Z7]
+ (0.009649516695365153) [Y8 X9 X10 Y11]
+ (0.009649516695365153) [X8 Y9 Y10 X11]
+ (0.011038591317925684) [Y0 Z1 Y2 Z8]
+ (0.011038591317925684) [X0 Z1 X2 Z8]
+ (0.011038591317925684) [Y1 Z2 Y3 Z9]
+ (0.011038591317925684) [X1 Z2 X3 Z9]
+ (0.011108457108600134) [Y5 Y6 X11 X12]
+ (0.011108457108600134) [X5 X6 Y11 Y12]
+ (0.011146162857686246) [Y7 Z8 Z9 Y11]
+ (0.011146162857686246) [X7 Z8 Z9 X11]
+ (0.011811308506423746) [Y4 X5 X6 Y7]
+ (0.011811308506423746) [X4 Y5 Y6 X7]
+ (0.013980947397031169) [Y6 X7 X8 Y9]
+ (0.013980947397031169) [X6 Y7 Y8 X9]
+ (0.014543040068700303) [Y0 X1 X2 Y3]
+ (0.014543040068700303) [X0 Y1 Y2 X3]
+ (0.015474990590793231) [Y2 X3 X12 Y13]
+ (0.015474990590793231) [X2 Y3 Y12 X13]
+ (0.017173495642862826) [Y6 X7 X10 Y11]
+ (0.017173495642862826) [X6 Y7 Y10 X11]
+ (0.017243660446962596) [Y6 X7 X12 Y13]
+ (0.017243660446962596) [X6 Y7 Y12 X13]
+ (0.017727284245501754) [Y4 X5 X10 Y11]
+ (0.017727284245501754) [X4 Y5 Y10 X11]
+ (0.01918681967778316) [Y3 X4 X11 Y12]
+ (0.01918681967778316) [X3 Y4 Y11 X12]
+ (0.025475926738667033) [Y2 X3 X10 Y11]
+ (0.025475926738667033) [X2 Y3 Y10 X11]
+ (0.02882687895426497) [Y10 X11 X12 Y13]
+ (0.02882687895426497) [X10 Y11 Y12 X13]
+ (0.029062607989074667) [Y6 Z7 Z8 Y10]
+ (0.029062607989074667) [X6 Z7 Z8 X10]
+ (0.029062607989074667) [Y7 Z9 Z10 Y11]
+ (0.029062607989074667) [X7 Z9 Z10 X11]
+ (0.02950115430485552) [Y6 Z7 Z9 Y10]
+ (0.02950115430485552) [X6 Z7 Z9 X10]
+ (0.02950115430485552) [Y7 Z8 Z10 Y11]
+ (0.02950115430485552) [X7 Z8 Z10 X11]
+ (0.030339181585633854) [Y6 Z8 Z9 Y10]
+ (0.030339181585633854) [X6 Z8 Z9 X10]
+ (0.031009362654485624) [Y2 X3 X6 Y7]
+ (0.031009362654485624) [X2 Y3 Y6 X7]
+ (0.0361107568453723) [Y2 X3 X4 Y5]
+ (0.0361107568453723) [X2 Y3 Y4 X5]
+ (0.036113908591614015) [Y2 X3 X8 Y9]
+ (0.036113908591614015) [X2 Y3 Y8 X9]
+ (0.0381205557881581) [Y4 X5 X12 Y13]
+ (0.0381205557881581) [X4 Y5 Y12 X13]
+ (0.10415911586049934) [Z0 Y1 Z2 Y3]
+ (0.10415911586049934) [Z0 X1 Z2 X3]
+ (-0.11917869163093105) [Y2 Z3 Z4 Z5 Y6]
+ (-0.11917869163093105) [X2 Z3 Z4 Z5 X6]
+ (-0.11917869163093095) [Y3 Z4 Z5 Z6 Y7]
+ (-0.11917869163093095) [X3 Z4 Z5 Z6 X7]
+ (0.2235534339753114) [Y6 Z7 Z8 Z9 Y10]
+ (0.2235534339753114) [X6 Z7 Z8 Z9 X10]
+ (0.22355343397531147) [Y7 Z8 Z9 Z10 Y11]
+ (0.22355343397531147) [X7 Z8 Z9 Z10 X11]
+ (-0.0321039261079718) [Z0 Y3 Z4 Z5 Z6 Y7]
+ (-0.0321039261079718) [Z0 X3 Z4 Z5 Z6 X7]
+ (-0.0321039261079718) [Z1 Y2 Z3 Z4 Z5 Y6]
+ (-0.0321039261079718) [Z1 X2 Z3 Z4 Z5 X6]
+ (-0.02647931144310871) [Z0 Y2 Z3 Z4 Z5 Y6]
+ (-0.02647931144310871) [Z0 X2 Z3 Z4 Z5 X6]
+ (-0.02647931144310871) [Z1 Y3 Z4 Z5 Z6 Y7]
+ (-0.02647931144310871) [Z1 X3 Z4 Z5 Z6 X7]
+ (-0.026113308105017774) [Y2 Z3 Z4 Z5 Y6 Z7]
+ (-0.026113308105017774) [X2 Z3 Z4 Z5 X6 Z7]
+ (-0.017195669926984895) [Y2 Z3 Z4 Z5 Y6 Z9]
+ (-0.017195669926984895) [X2 Z3 Z4 Z5 X6 Z9]
+ (-0.017195669926984895) [Y3 Z4 Z5 Z6 Y7 Z8]
+ (-0.017195669926984895) [X3 Z4 Z5 Z6 X7 Z8]
+ (-0.014478375425960595) [Y7 Z8 Z9 X10 X12 Y13]
+ (-0.014478375425960595) [Y7 Z8 Z9 Y10 Y12 Y13]
+ (-0.014478375425960595) [X7 Z8 Z9 X10 X12 X13]
+ (-0.014478375425960595) [X7 Z8 Z9 Y10 Y12 X13]
+ (-0.011909274393827508) [Y4 Z5 Y6 Y11 Z12 Y13]
+ (-0.011909274393827508) [Y4 Z5 Y6 X11 Z12 X13]
+ (-0.011909274393827508) [X4 Z5 X6 Y11 Z12 Y13]
+ (-0.011909274393827508) [X4 Z5 X6 X11 Z12 X13]
+ (-0.011909274393827508) [Y5 Z6 Y7 Y10 Z11 Y12]
+ (-0.011909274393827508) [Y5 Z6 Y7 X10 Z11 X12]
+ (-0.011909274393827508) [X5 Z6 X7 Y10 Z11 Y12]
+ (-0.011909274393827508) [X5 Z6 X7 X10 Z11 X12]
+ (-0.011728278016662264) [Y3 Z4 Z5 X6 X8 Y9]
+ (-0.011728278016662264) [Y3 Z4 Z5 Y6 Y8 Y9]
+ (-0.011728278016662264) [X3 Z4 Z5 X6 X8 X9]
+ (-0.011728278016662264) [X3 Z4 Z5 Y6 Y8 X9]
+ (-0.00883482834151563) [Y2 Z3 Z4 X5 X11 Y12]
+ (-0.00883482834151563) [Y2 Z3 Z4 Y5 Y11 Y12]
+ (-0.00883482834151563) [X2 Z3 Z4 X5 X11 X12]
+ (-0.00883482834151563) [X2 Z3 Z4 Y5 Y11 X12]
+ (-0.00883482834151563) [Y3 X4 X10 Z11 Z12 Y13]
+ (-0.00883482834151563) [Y3 Y4 Y10 Z11 Z12 Y13]
+ (-0.00883482834151563) [X3 X4 X10 Z11 Z12 X13]
+ (-0.00883482834151563) [X3 Y4 Y10 Z11 Z12 X13]
+ (-0.008115181324565627) [Y0 Z1 Z2 Y3 X8 X9]
+ (-0.008115181324565627) [X0 Z1 Z2 X3 Y8 Y9]
+ (-0.007148739430122435) [Y4 X5 X7 Z8 Z9 Y10]
+ (-0.007148739430122435) [Y4 Y5 Y7 Z8 Z9 Y10]
+ (-0.007148739430122435) [X4 X5 X7 Z8 Z9 X10]
+ (-0.007148739430122435) [X4 Y5 Y7 Z8 Z9 X10]
+ (-0.005624614664863097) [Y0 X1 X3 Z4 Z5 Y6]
+ (-0.005624614664863097) [Y0 Y1 Y3 Z4 Z5 Y6]
+ (-0.005624614664863097) [X0 X1 X3 Z4 Z5 X6]
+ (-0.005624614664863097) [X0 Y1 Y3 Z4 Z5 X6]
+ (-0.005467391910322628) [Y2 Z3 Z4 Z5 Y6 Z8]
+ (-0.005467391910322628) [X2 Z3 Z4 Z5 X6 Z8]
+ (-0.005467391910322628) [Y3 Z4 Z5 Z6 Y7 Z9]
+ (-0.005467391910322628) [X3 Z4 Z5 Z6 X7 Z9]
+ (-0.004990156593291568) [Y2 Z3 Y4 Y5 Z6 Y7]
+ (-0.004990156593291568) [Y2 Z3 Y4 X5 Z6 X7]
+ (-0.004990156593291568) [X2 Z3 X4 Y5 Z6 Y7]
+ (-0.004990156593291568) [X2 Z3 X4 X5 Z6 X7]
+ (-0.004730293682201409) [Y0 Z1 Z2 Y3 X6 X7]
+ (-0.004730293682201409) [X0 Z1 Z2 X3 Y6 Y7]
+ (-0.004663033553314072) [Y1 X2 X7 Z8 Z9 Y10]
+ (-0.004663033553314072) [X1 Y2 Y7 Z8 Z9 X10]
+ (-0.0045762972439466875) [Y0 Z1 Z2 Y3 X12 X13]
+ (-0.0045762972439466875) [X0 Z1 Z2 X3 Y12 Y13]
+ (-0.004441903192898146) [Y0 Z1 Z2 Y3 X4 X5]
+ (-0.004441903192898146) [X0 Z1 Z2 X3 Y4 Y5]
+ (-0.004167186732622282) [Y3 Z4 Z5 X6 X12 Y13]
+ (-0.004167186732622282) [Y3 Z4 Z5 Y6 Y12 Y13]
+ (-0.004167186732622282) [X3 Z4 Z5 X6 X12 X13]
+ (-0.004167186732622282) [X3 Z4 Z5 Y6 Y12 X13]
+ (-0.003453983911928454) [Y2 Z3 Z4 Z5 Y6 Z13]
+ (-0.003453983911928454) [X2 Z3 Z4 Z5 X6 Z13]
+ (-0.003453983911928454) [Y3 Z4 Z5 Z6 Y7 Z12]
+ (-0.003453983911928454) [X3 Z4 Z5 Z6 X7 Z12]
+ (-0.0028416496638794374) [Y1 Z2 Z3 Z4 Z5 Y7]
+ (-0.0028416496638794374) [X1 Z2 Z3 Z4 Z5 X7]
+ (-0.002303637244403484) [Y1 X2 X3 Z4 Z5 Y6]
+ (-0.002303637244403484) [X1 Y2 Y3 Z4 Z5 X6]
+ (-0.0017473251907744994) [Y1 Z2 Z3 X4 X11 Y12]
+ (-0.0017473251907744994) [X1 Z2 Z3 Y4 Y11 X12]
+ (-0.0017014938967297535) [Y0 Z1 Z2 Y3 X10 X11]
+ (-0.0017014938967297535) [X0 Z1 Z2 X3 Y10 Y11]
+ (-0.0008604027503185595) [Y1 Z2 Z3 Y4 X5 X6]
+ (-0.0008604027503185595) [X1 Z2 Z3 X4 Y5 Y6]
+ (-0.000800817285227372) [Y4 Z5 Y6 X10 Z11 X12]
+ (-0.000800817285227372) [X4 Z5 X6 Y10 Z11 Y12]
+ (-0.000800817285227372) [Y5 Z6 Y7 X11 Z12 X13]
+ (-0.000800817285227372) [X5 Z6 X7 Y11 Z12 Y13]
+ (-0.0005931662854672171) [Y2 Z3 Z4 Z5 Y6 Z10]
+ (-0.0005931662854672171) [X2 Z3 Z4 Z5 X6 Z10]
+ (-0.0005931662854672171) [Y3 Z4 Z5 Z6 Y7 Z11]
+ (-0.0005931662854672171) [X3 Z4 Z5 Z6 X7 Z11]
+ (-0.00014205969755517298) [Y0 X1 X7 Z8 Z9 Y10]
+ (-0.00014205969755517298) [Y0 Y1 Y7 Z8 Z9 Y10]
+ (-0.00014205969755517298) [X0 X1 X7 Z8 Z9 X10]
+ (-0.00014205969755517298) [X0 Y1 Y7 Z8 Z9 X10]
+ (0.0004385463157808554) [Y6 Z7 Y8 Y9 Z10 Y11]
+ (0.0004385463157808554) [Y6 Z7 Y8 X9 Z10 X11]
+ (0.0004385463157808554) [X6 Z7 X8 Y9 Z10 Y11]
+ (0.0004385463157808554) [X6 Z7 X8 X9 Z10 X11]
+ (0.0007132028206938282) [Y2 Z3 Z4 Z5 Y6 Z12]
+ (0.0007132028206938282) [X2 Z3 Z4 Z5 X6 Z12]
+ (0.0007132028206938282) [Y3 Z4 Z5 Z6 Y7 Z13]
+ (0.0007132028206938282) [X3 Z4 Z5 Z6 X7 Z13]
+ (0.0008604027503185595) [Y1 Z2 Z3 X4 X5 Y6]
+ (0.0008604027503185595) [X1 Z2 Z3 Y4 Y5 X6]
+ (0.001031592666904919) [Z2 Y3 Z4 Z5 Z6 Y7]
+ (0.001031592666904919) [Z2 X3 Z4 Z5 Z6 X7]
+ (0.0016177412410934733) [Y0 Z1 Z2 Z3 Z4 Y6]
+ (0.0016177412410934733) [X0 Z1 Z2 Z3 Z4 X6]
+ (0.0016177412410934733) [Y1 Z2 Z3 Z5 Z6 Y7]
+ (0.0016177412410934733) [X1 Z2 Z3 Z5 Z6 X7]
+ (0.0017014938967297535) [Y0 Z1 Z2 X3 X10 Y11]
+ (0.0017014938967297535) [X0 Z1 Z2 Y3 Y10 X11]
+ (0.0017111938289173794) [Y0 Z1 Z3 Z4 Z5 Y6]
+ (0.0017111938289173794) [X0 Z1 Z3 Z4 Z5 X6]
+ (0.0017111938289173794) [Y1 Z2 Z4 Z5 Z6 Y7]
+ (0.0017111938289173794) [X1 Z2 Z4 Z5 Z6 X7]
+ (0.0017473251907744994) [Y1 Z2 Z3 Y4 X11 X12]
+ (0.0017473251907744994) [X1 Z2 Z3 X4 Y11 Y12]
+ (0.002303637244403484) [Y1 Y2 X3 Z4 Z5 X6]
+ (0.002303637244403484) [X1 X2 Y3 Z4 Z5 Y6]
+ (0.0024781439914120327) [Y0 Z1 Z2 Z3 Z5 Y6]
+ (0.0024781439914120327) [X0 Z1 Z2 Z3 Z5 X6]
+ (0.0024781439914120327) [Y1 Z2 Z3 Z4 Z6 Y7]
+ (0.0024781439914120327) [X1 Z2 Z3 Z4 Z6 X7]
+ (0.004014831073320863) [Y0 Z1 Z2 Z4 Z5 Y6]
+ (0.004014831073320863) [X0 Z1 Z2 Z4 Z5 X6]
+ (0.004014831073320863) [Y1 Z3 Z4 Z5 Z6 Y7]
+ (0.004014831073320863) [X1 Z3 Z4 Z5 Z6 X7]
+ (0.004441903192898146) [Y0 Z1 Z2 X3 X4 Y5]
+ (0.004441903192898146) [X0 Z1 Z2 Y3 Y4 X5]
+ (0.0045762972439466875) [Y0 Z1 Z2 X3 X12 Y13]
+ (0.0045762972439466875) [X0 Z1 Z2 Y3 Y12 X13]
+ (0.004663033553314072) [Y1 Y2 X7 Z8 Z9 X10]
+ (0.004663033553314072) [X1 X2 Y7 Z8 Z9 Y10]
+ (0.004730293682201409) [Y0 Z1 Z2 X3 X6 Y7]
+ (0.004730293682201409) [X0 Z1 Z2 Y3 Y6 X7]
+ (0.005237865951339788) [Y2 X3 X7 Z8 Z9 Y10]
+ (0.005237865951339788) [Y2 Y3 Y7 Z8 Z9 Y10]
+ (0.005237865951339788) [X2 X3 X7 Z8 Z9 X10]
+ (0.005237865951339788) [X2 Y3 Y7 Z8 Z9 X10]
+ (0.005466638630990263) [Y2 Z3 Y4 X10 Z11 X12]
+ (0.005466638630990263) [X2 Z3 X4 Y10 Z11 Y12]
+ (0.005466638630990263) [Y3 Z4 Y5 X11 Z12 X13]
+ (0.005466638630990263) [X3 Z4 X5 Y11 Z12 Y13]
+ (0.007703555918589493) [Y4 Z5 Y6 Y10 Z11 Y12]
+ (0.007703555918589493) [X4 Z5 X6 X10 Z11 X12]
+ (0.007703555918589493) [Y5 Z6 Y7 Y11 Z12 Y13]
+ (0.007703555918589493) [X5 Z6 X7 X11 Z12 X13]
+ (0.008115181324565627) [Y0 Z1 Z2 X3 X8 Y9]
+ (0.008115181324565627) [X0 Z1 Z2 Y3 Y8 X9]
+ (0.008504373203816865) [Y4 Z5 X6 X10 Z11 Y12]
+ (0.008504373203816865) [X4 Z5 Y6 Y10 Z11 X12]
+ (0.008504373203816865) [Y5 Z6 X7 X11 Z12 Y13]
+ (0.008504373203816865) [X5 Z6 Y7 Y11 Z12 X13]
+ (0.010351991336267529) [Y2 Z3 X4 X10 Z11 Y12]
+ (0.010351991336267529) [X2 Z3 Y4 Y10 Z11 X12]
+ (0.010351991336267529) [Y3 Z4 X5 X11 Z12 Y13]
+ (0.010351991336267529) [X3 Z4 Y5 Y11 Z12 X13]
+ (0.010381586788370381) [Y6 Z7 Z8 Z9 Y10 Z13]
+ (0.010381586788370381) [X6 Z7 Z8 Z9 X10 Z13]
+ (0.010381586788370381) [Y7 Z8 Z9 Z10 Y11 Z12]
+ (0.010381586788370381) [X7 Z8 Z9 Z10 X11 Z12]
+ (0.01081040801711422) [Z4 Y7 Z8 Z9 Z10 Y11]
+ (0.01081040801711422) [Z4 X7 Z8 Z9 Z10 X11]
+ (0.01081040801711422) [Z5 Y6 Z7 Z8 Z9 Y10]
+ (0.01081040801711422) [Z5 X6 Z7 Z8 Z9 X10]
+ (0.011146162857686246) [Y6 Z7 Z8 Z9 Y10 Z11]
+ (0.011146162857686246) [X6 Z7 Z8 Z9 X10 Z11]
+ (0.01464877513787094) [Y2 Z3 Z4 Z5 Y6 Z11]
+ (0.01464877513787094) [X2 Z3 Z4 Z5 X6 Z11]
+ (0.01464877513787094) [Y3 Z4 Z5 Z6 Y7 Z10]
+ (0.01464877513787094) [X3 Z4 Z5 Z6 X7 Z10]
+ (0.015241941423338158) [Y3 Z4 Z5 X6 X10 Y11]
+ (0.015241941423338158) [Y3 Z4 Z5 Y6 Y10 Y11]
+ (0.015241941423338158) [X3 Z4 Z5 X6 X10 X11]
+ (0.015241941423338158) [X3 Z4 Z5 Y6 Y10 X11]
+ (0.01581862996725779) [Y2 Z3 Y4 Y10 Z11 Y12]
+ (0.01581862996725779) [X2 Z3 X4 X10 Z11 X12]
+ (0.01581862996725779) [Y3 Z4 Y5 Y11 Z12 Y13]
+ (0.01581862996725779) [X3 Z4 X5 X11 Z12 X13]
+ (0.01795914744723666) [Z4 Y6 Z7 Z8 Z9 Y10]
+ (0.01795914744723666) [Z4 X6 Z7 Z8 Z9 X10]
+ (0.01795914744723666) [Z5 Y7 Z8 Z9 Z10 Y11]
+ (0.01795914744723666) [Z5 X7 Z8 Z9 Z10 X11]
+ (0.018615226765381715) [Z2 Y6 Z7 Z8 Z9 Y10]
+ (0.018615226765381715) [Z2 X6 Z7 Z8 Z9 X10]
+ (0.018615226765381715) [Z3 Y7 Z8 Z9 Z10 Y11]
+ (0.018615226765381715) [Z3 X7 Z8 Z9 Z10 X11]
+ (0.019612830312416996) [Y4 Z5 Z6 X7 X11 Y12]
+ (0.019612830312416996) [Y4 Z5 Z6 Y7 Y11 Y12]
+ (0.019612830312416996) [X4 Z5 Z6 X7 X11 X12]
+ (0.019612830312416996) [X4 Z5 Z6 Y7 Y11 X12]
+ (0.019612830312416996) [Y5 X6 X10 Z11 Z12 Y13]
+ (0.019612830312416996) [Y5 Y6 Y10 Z11 Z12 Y13]
+ (0.019612830312416996) [X5 X6 X10 Z11 Z12 X13]
+ (0.019612830312416996) [X5 Y6 Y10 Z11 Z12 X13]
+ (0.023853092716721508) [Z2 Y7 Z8 Z9 Z10 Y11]
+ (0.023853092716721508) [Z2 X7 Z8 Z9 Z10 X11]
+ (0.023853092716721508) [Z3 Y6 Z7 Z8 Z9 Y10]
+ (0.023853092716721508) [Z3 X6 Z7 Z8 Z9 X10]
+ (0.02465345830877342) [Y2 Z3 Y4 Y11 Z12 Y13]
+ (0.02465345830877342) [Y2 Z3 Y4 X11 Z12 X13]
+ (0.02465345830877342) [X2 Z3 X4 Y11 Z12 Y13]
+ (0.02465345830877342) [X2 Z3 X4 X11 Z12 X13]
+ (0.02465345830877342) [Y3 Z4 Y5 Y10 Z11 Y12]
+ (0.02465345830877342) [Y3 Z4 Y5 X10 Z11 X12]
+ (0.02465345830877342) [X3 Z4 X5 Y10 Z11 Y12]
+ (0.02465345830877342) [X3 Z4 X5 X10 Z11 X12]
+ (0.024859962214330976) [Y6 Z7 Z8 Z9 Y10 Z12]
+ (0.024859962214330976) [X6 Z7 Z8 Z9 X10 Z12]
+ (0.024859962214330976) [Y7 Z8 Z9 Z10 Y11 Z13]
+ (0.024859962214330976) [X7 Z8 Z9 Z10 X11 Z13]
+ (0.030339181585633854) [Z6 Y7 Z8 Z9 Z10 Y11]
+ (0.030339181585633854) [Z6 X7 Z8 Z9 Z10 X11]
+ (0.04590691044276786) [Y0 Z2 Z3 Z4 Z5 Y6]
+ (0.04590691044276786) [X0 Z2 Z3 Z4 Z5 X6]
+ (0.0548292979513475) [Z0 Y7 Z8 Z9 Z10 Y11]
+ (0.0548292979513475) [Z0 X7 Z8 Z9 Z10 X11]
+ (0.0548292979513475) [Z1 Y6 Z7 Z8 Z9 Y10]
+ (0.0548292979513475) [Z1 X6 Z7 Z8 Z9 X10]
+ (0.05497135764890268) [Z0 Y6 Z7 Z8 Z9 Y10]
+ (0.05497135764890268) [Z0 X6 Z7 Z8 Z9 X10]
+ (0.05497135764890268) [Z1 Y7 Z8 Z9 Z10 Y11]
+ (0.05497135764890268) [Z1 X7 Z8 Z9 Z10 X11]
+ (0.04275636364542444) [Y0 Z1 Z2 Z3 Z4 Z5 Y6]
+ (0.04275636364542444) [X0 Z1 Z2 Z3 Z4 Z5 X6]
+ (0.042756363645424456) [Y1 Z2 Z3 Z4 Z5 Z6 Y7]
+ (0.042756363645424456) [X1 Z2 Z3 Z4 Z5 Z6 X7]
+ (-0.047449406213253845) [Y4 Z5 Z6 Z7 Z8 Z10 Z11 Y12]
+ (-0.047449406213253845) [X4 Z5 Z6 Z7 Z8 Z10 Z11 X12]
+ (-0.047449406213253845) [Y5 Z6 Z7 Z9 Z10 Z11 Z12 Y13]
+ (-0.047449406213253845) [X5 Z6 Z7 Z9 Z10 Z11 Z12 X13]
+ (-0.04152762530256189) [Y4 Z5 Z6 Z7 Z9 Z10 Z11 Y12]
+ (-0.04152762530256189) [X4 Z5 Z6 Z7 Z9 Z10 Z11 X12]
+ (-0.04152762530256189) [Y5 Z6 Z7 Z8 Z10 Z11 Z12 Y13]
+ (-0.04152762530256189) [X5 Z6 Z7 Z8 Z10 Z11 Z12 X13]
+ (-0.04001225729326298) [Y4 Z5 Z6 Z8 Z9 Z10 Z11 Y12]
+ (-0.04001225729326298) [X4 Z5 Z6 Z8 Z9 Z10 Z11 X12]
+ (-0.04001225729326298) [Y5 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.04001225729326298) [X5 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.03965111254280651) [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Y10]
+ (-0.03965111254280651) [X2 Z3 Z4 Z5 Z6 Z7 Z8 X10]
+ (-0.03965111254280651) [Y3 Z4 Z5 Z6 Z7 Z9 Z10 Y11]
+ (-0.03965111254280651) [X3 Z4 Z5 Z6 Z7 Z9 Z10 X11]
+ (-0.03943722274279532) [Y4 Z5 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.03943722274279532) [X4 Z5 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.03943722274279532) [Y5 Z6 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.03943722274279532) [X5 Z6 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.0357306173477048) [Y2 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.0357306173477048) [X2 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.02990727274132846) [Y2 Z3 Z4 Z5 Z7 Z8 Z9 Y10]
+ (-0.02990727274132846) [X2 Z3 Z4 Z5 Z7 Z8 Z9 X10]
+ (-0.02990727274132846) [Y3 Z4 Z5 Z6 Z8 Z9 Z10 Y11]
+ (-0.02990727274132846) [X3 Z4 Z5 Z6 Z8 Z9 Z10 X11]
+ (-0.0289996837204243) [Y2 Z3 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.0289996837204243) [X2 Z3 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.0289996837204243) [Y3 Z4 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.0289996837204243) [X3 Z4 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.025611553896356325) [Y4 Z5 Z6 Z7 Z8 Z9 Z11 Y12]
+ (-0.025611553896356325) [X4 Z5 Z6 Z7 Z8 Z9 Z11 X12]
+ (-0.025611553896356325) [Y5 Z6 Z7 Z8 Z9 Z10 Z12 Y13]
+ (-0.025611553896356325) [X5 Z6 Z7 Z8 Z9 Z10 Z12 X13]
+ (-0.02487143827678226) [Y2 Z3 Z4 Z5 Z6 Z7 Z9 Y10]
+ (-0.02487143827678226) [X2 Z3 Z4 Z5 Z6 Z7 Z9 X10]
+ (-0.02487143827678226) [Y3 Z4 Z5 Z6 Z7 Z8 Z10 Y11]
+ (-0.02487143827678226) [X3 Z4 Z5 Z6 Z7 Z8 Z10 X11]
+ (-0.024199216699019505) [Y3 Z4 Z5 Z6 Z7 Z8 Z9 Y11]
+ (-0.024199216699019505) [X3 Z4 Z5 Z6 Z7 Z8 Z9 X11]
+ (-0.023299101488190407) [Y5 Z6 Z7 Z8 Z9 Z10 Z11 Y13]
+ (-0.023299101488190407) [X5 Z6 Z7 Z8 Z9 Z10 Z11 X13]
+ (-0.022603736449447423) [Y4 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.022603736449447423) [X4 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.022057527937452057) [Y2 Z3 Z4 Z5 Z6 Z8 Z9 Y10]
+ (-0.022057527937452057) [X2 Z3 Z4 Z5 Z6 Z8 Z9 X10]
+ (-0.022057527937452057) [Y3 Z4 Z5 Z7 Z8 Z9 Z10 Y11]
+ (-0.022057527937452057) [X3 Z4 Z5 Z7 Z8 Z9 Z10 X11]
+ (-0.01918681967778316) [Y2 Z3 Z4 Y5 X10 Z11 Z12 X13]
+ (-0.01918681967778316) [X2 Z3 Z4 X5 Y10 Z11 Z12 Y13]
+ (-0.01906094409083804) [Y3 Y4 X7 Z8 Z9 Z10 Z11 X12]
+ (-0.01906094409083804) [X3 X4 Y7 Z8 Z9 Z10 Z11 Y12]
+ (-0.018973622778297) [Y2 Z3 Z4 Z6 Z7 Z8 Z9 Y10]
+ (-0.018973622778297) [X2 Z3 Z4 Z6 Z7 Z8 Z9 X10]
+ (-0.018973622778297) [Y3 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.018973622778297) [X3 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.016126269312017345) [Y5 Z6 Z7 Z8 Z9 X10 X11 Y12]
+ (-0.016126269312017345) [X5 Z6 Z7 Z8 Z9 Y10 Y11 X12]
+ (-0.015241941423338158) [Y2 Z3 Z4 Z5 Z6 X7 X10 Y11]
+ (-0.015241941423338158) [X2 Z3 Z4 Z5 Z6 Y7 Y10 X11]
+ (-0.01477967426602425) [Y3 Z4 Z5 Z6 Z7 Y8 X9 X10]
+ (-0.01477967426602425) [X3 Z4 Z5 Z6 Z7 X8 Y9 Y10]
+ (-0.014478375425960595) [Y6 Z7 Z8 Z9 Z10 Y11 X12 X13]
+ (-0.014478375425960595) [X6 Z7 Z8 Z9 Z10 X11 Y12 Y13]
+ (-0.011728278016662264) [Y2 Z3 Z4 Z5 Z6 Y7 X8 X9]
+ (-0.011728278016662264) [X2 Z3 Z4 Z5 Z6 X7 Y8 Y9]
+ (-0.011108457108600134) [Y4 Z5 Z6 X7 X10 Z11 Z12 Y13]
+ (-0.011108457108600134) [X4 Z5 Z6 Y7 Y10 Z11 Z12 X13]
+ (-0.010026060942127298) [Y3 X4 X5 Z6 Z7 Z8 Z9 Y10]
+ (-0.010026060942127298) [X3 Y4 Y5 Z6 Z7 Z8 Z9 X10]
+ (-0.00948528458433898) [Y4 Z5 Z6 Z7 Z8 Z9 Z10 Y12]
+ (-0.00948528458433898) [X4 Z5 Z6 Z7 Z8 Z9 Z10 X12]
+ (-0.00948528458433898) [Y5 Z6 Z7 Z8 Z9 Z11 Z12 Y13]
+ (-0.00948528458433898) [X5 Z6 Z7 Z8 Z9 Z11 Z12 X13]
+ (-0.0078497448038764) [Y3 Z4 Z5 X6 X7 Z8 Z9 Y10]
+ (-0.0078497448038764) [X3 Z4 Z5 Y6 Y7 Z8 Z9 X10]
+ (-0.007148739430122435) [Y4 Y5 X6 Z7 Z8 Z9 Z10 X11]
+ (-0.007148739430122435) [X4 X5 Y6 Z7 Z8 Z9 Z10 Y11]
+ (-0.005921780910691961) [Y5 Z6 Z7 Y8 X9 Z10 Z11 X12]
+ (-0.005921780910691961) [X5 Z6 Z7 X8 Y9 Z10 Z11 Y12]
+ (-0.005624614664863097) [Y0 Y1 X2 Z3 Z4 Z5 Z6 X7]
+ (-0.005624614664863097) [X0 X1 Y2 Z3 Z4 Z5 Z6 Y7]
+ (-0.0052378659513397895) [Y2 X3 X6 Z7 Z8 Z9 Z10 Y11]
+ (-0.0052378659513397895) [X2 Y3 Y6 Z7 Z8 Z9 Z10 X11]
+ (-0.004167186732622282) [Y2 Z3 Z4 Z5 Z6 Y7 X12 X13]
+ (-0.004167186732622282) [X2 Z3 Z4 Z5 Z6 X7 Y12 Y13]
+ (-0.003363223715137501) [Y1 Z2 Z3 Z4 Z5 X6 X8 Y9]
+ (-0.003363223715137501) [Y1 Z2 Z3 Z4 Z5 Y6 Y8 Y9]
+ (-0.003363223715137501) [X1 Z2 Z3 Z4 Z5 X6 X8 X9]
+ (-0.003363223715137501) [X1 Z2 Z3 Z4 Z5 Y6 Y8 X9]
+ (-0.003300645095402382) [Y1 Z2 Z3 Z4 Z5 X6 X12 Y13]
+ (-0.003300645095402382) [Y1 Z2 Z3 Z4 Z5 Y6 Y12 Y13]
+ (-0.003300645095402382) [X1 Z2 Z3 Z4 Z5 X6 X12 X13]
+ (-0.003300645095402382) [X1 Z2 Z3 Z4 Z5 Y6 Y12 X13]
+ (-0.0028416496638794374) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 Z7]
+ (-0.0028416496638794374) [X0 Z1 Z2 Z3 Z4 Z5 X6 Z7]
+ (-0.002713561285855519) [Y0 Z1 Z2 Z3 X4 X10 Z11 Y12]
+ (-0.002713561285855519) [X0 Z1 Z2 Z3 Y4 Y10 Z11 X12]
+ (-0.002713561285855519) [Y1 Z2 Z3 Z4 X5 X11 Z12 Y13]
+ (-0.002713561285855519) [X1 Z2 Z3 Z4 Y5 Y11 Z12 X13]
+ (-0.002303637244403484) [Y0 Z1 Y2 Y3 Z4 Z5 Z6 Y7]
+ (-0.002303637244403484) [Y0 Z1 Y2 X3 Z4 Z5 Z6 X7]
+ (-0.002303637244403484) [X0 Z1 X2 Y3 Z4 Z5 Z6 Y7]
+ (-0.002303637244403484) [X0 Z1 X2 X3 Z4 Z5 Z6 X7]
+ (-0.0009662360950810196) [Y0 Z1 Z2 Z3 Z4 X5 X11 Y12]
+ (-0.0009662360950810196) [Y0 Z1 Z2 Z3 Z4 Y5 Y11 Y12]
+ (-0.0009662360950810196) [X0 Z1 Z2 Z3 Z4 X5 X11 X12]
+ (-0.0009662360950810196) [X0 Z1 Z2 Z3 Z4 Y5 Y11 X12]
+ (-0.0009662360950810196) [Y1 Z2 Z3 X4 X10 Z11 Z12 Y13]
+ (-0.0009662360950810196) [Y1 Z2 Z3 Y4 Y10 Z11 Z12 Y13]
+ (-0.0009662360950810196) [X1 Z2 Z3 X4 X10 Z11 Z12 X13]
+ (-0.0009662360950810196) [X1 Z2 Z3 Y4 Y10 Z11 Z12 X13]
+ (-0.0005750345504676655) [Y5 Y6 X7 Z8 Z9 Z10 Z11 X12]
+ (-0.0005750345504676655) [X5 X6 Y7 Z8 Z9 Z10 Z11 Y12]
+ (-0.00014205969755517298) [Y0 Y1 X6 Z7 Z8 Z9 Z10 X11]
+ (-0.00014205969755517298) [X0 X1 Y6 Z7 Z8 Z9 Z10 Y11]
+ (-7.069366888106928e-05) [Y1 Z2 Z3 Z4 Z5 X6 X10 Y11]
+ (-7.069366888106928e-05) [Y1 Z2 Z3 Z4 Z5 Y6 Y10 Y11]
+ (-7.069366888106928e-05) [X1 Z2 Z3 Z4 Z5 X6 X10 X11]
+ (-7.069366888106928e-05) [X1 Z2 Z3 Z4 Z5 Y6 Y10 X11]
+ (0.00014205969755517298) [Y0 X1 X6 Z7 Z8 Z9 Z10 Y11]
+ (0.00014205969755517298) [X0 Y1 Y6 Z7 Z8 Z9 Z10 X11]
+ (0.0004228951678538497) [Y0 Z1 X2 X6 Z7 Z8 Z9 Y10]
+ (0.0004228951678538497) [X0 Z1 Y2 Y6 Z7 Z8 Z9 X10]
+ (0.0004228951678538497) [Y1 Z2 X3 X7 Z8 Z9 Z10 Y11]
+ (0.0004228951678538497) [X1 Z2 Y3 Y7 Z8 Z9 Z10 X11]
+ (0.0005581394839450502) [Y0 Z1 Y2 Y7 Z8 Z9 Z10 Y11]
+ (0.0005581394839450502) [Y0 Z1 Y2 X7 Z8 Z9 Z10 X11]
+ (0.0005581394839450502) [X0 Z1 X2 Y7 Z8 Z9 Z10 Y11]
+ (0.0005581394839450502) [X0 Z1 X2 X7 Z8 Z9 Z10 X11]
+ (0.0005581394839450502) [Y1 Z2 Y3 Y6 Z7 Z8 Z9 Y10]
+ (0.0005581394839450502) [Y1 Z2 Y3 X6 Z7 Z8 Z9 X10]
+ (0.0005581394839450502) [X1 Z2 X3 Y6 Z7 Z8 Z9 Y10]
+ (0.0005581394839450502) [X1 Z2 X3 X6 Z7 Z8 Z9 X10]
+ (0.0005750345504676655) [Y5 X6 X7 Z8 Z9 Z10 Z11 Y12]
+ (0.0005750345504676655) [X5 Y6 Y7 Z8 Z9 Z10 Z11 X12]
+ (0.0008604027503185595) [Y0 Z1 Z2 Z3 Y4 Y5 Z6 Y7]
+ (0.0008604027503185595) [Y0 Z1 Z2 Z3 Y4 X5 Z6 X7]
+ (0.0008604027503185595) [X0 Z1 Z2 Z3 X4 Y5 Z6 Y7]
+ (0.0008604027503185595) [X0 Z1 Z2 Z3 X4 X5 Z6 X7]
+ (0.0010425048494544027) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 Z13]
+ (0.0010425048494544027) [X0 Z1 Z2 Z3 Z4 Z5 X6 Z13]
+ (0.0010425048494544027) [Y1 Z2 Z3 Z4 Z5 Z6 Y7 Z12]
+ (0.0010425048494544027) [X1 Z2 Z3 Z4 Z5 Z6 X7 Z12]
+ (0.001279765782649418) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 Z9]
+ (0.001279765782649418) [X0 Z1 Z2 Z3 Z4 Z5 X6 Z9]
+ (0.001279765782649418) [Y1 Z2 Z3 Z4 Z5 Z6 Y7 Z8]
+ (0.001279765782649418) [X1 Z2 Z3 Z4 Z5 Z6 X7 Z8]
+ (0.0013365318044795305) [Y0 Z1 Z2 Z3 Y4 Y10 Z11 Y12]
+ (0.0013365318044795305) [X0 Z1 Z2 Z3 X4 X10 Z11 X12]
+ (0.0013365318044795305) [Y1 Z2 Z3 Z4 Y5 Y11 Z12 Y13]
+ (0.0013365318044795305) [X1 Z2 Z3 Z4 X5 X11 Z12 X13]
+ (0.00230276789956055) [Y0 Z1 Z2 Z3 Y4 Y11 Z12 Y13]
+ (0.00230276789956055) [Y0 Z1 Z2 Z3 Y4 X11 Z12 X13]
+ (0.00230276789956055) [X0 Z1 Z2 Z3 X4 Y11 Z12 Y13]
+ (0.00230276789956055) [X0 Z1 Z2 Z3 X4 X11 Z12 X13]
+ (0.00230276789956055) [Y1 Z2 Z3 Z4 Y5 Y10 Z11 Y12]
+ (0.00230276789956055) [Y1 Z2 Z3 Z4 Y5 X10 Z11 X12]
+ (0.00230276789956055) [X1 Z2 Z3 Z4 X5 Y10 Z11 Y12]
+ (0.00230276789956055) [X1 Z2 Z3 Z4 X5 X10 Z11 X12]
+ (0.004050093090335049) [Y0 Z1 Z2 Z3 Y4 X10 Z11 X12]
+ (0.004050093090335049) [X0 Z1 Z2 Z3 X4 Y10 Z11 Y12]
+ (0.004050093090335049) [Y1 Z2 Z3 Z4 Y5 X11 Z12 X13]
+ (0.004050093090335049) [X1 Z2 Z3 Z4 X5 Y11 Z12 Y13]
+ (0.004167186732622282) [Y2 Z3 Z4 Z5 Z6 X7 X12 Y13]
+ (0.004167186732622282) [X2 Z3 Z4 Z5 Z6 Y7 Y12 X13]
+ (0.004343149944856784) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 Z12]
+ (0.004343149944856784) [X0 Z1 Z2 Z3 Z4 Z5 X6 Z12]
+ (0.004343149944856784) [Y1 Z2 Z3 Z4 Z5 Z6 Y7 Z13]
+ (0.004343149944856784) [X1 Z2 Z3 Z4 Z5 Z6 X7 Z13]
+ (0.004642989497786919) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 Z8]
+ (0.004642989497786919) [X0 Z1 Z2 Z3 Z4 Z5 X6 Z8]
+ (0.004642989497786919) [Y1 Z2 Z3 Z4 Z5 Z6 Y7 Z9]
+ (0.004642989497786919) [X1 Z2 Z3 Z4 Z5 Z6 X7 Z9]
+ (0.005085928721167921) [Y0 Z1 Z2 X3 X7 Z8 Z9 Y10]
+ (0.005085928721167921) [Y0 Z1 Z2 Y3 Y7 Z8 Z9 Y10]
+ (0.005085928721167921) [X0 Z1 Z2 X3 X7 Z8 Z9 X10]
+ (0.005085928721167921) [X0 Z1 Z2 Y3 Y7 Z8 Z9 X10]
+ (0.005085928721167921) [Y1 X2 X6 Z7 Z8 Z9 Z10 Y11]
+ (0.005085928721167921) [Y1 Y2 Y6 Z7 Z8 Z9 Z10 Y11]
+ (0.005085928721167921) [X1 X2 X6 Z7 Z8 Z9 Z10 X11]
+ (0.005085928721167921) [X1 Y2 Y6 Z7 Z8 Z9 Z10 X11]
+ (0.005221173037259123) [Y0 Z1 Y2 X6 Z7 Z8 Z9 X10]
+ (0.005221173037259123) [X0 Z1 X2 Y6 Z7 Z8 Z9 Y10]
+ (0.005221173037259123) [Y1 Z2 Y3 X7 Z8 Z9 Z10 X11]
+ (0.005221173037259123) [X1 Z2 X3 Y7 Z8 Z9 Z10 Y11]
+ (0.0052378659513397895) [Y2 Y3 X6 Z7 Z8 Z9 Z10 X11]
+ (0.0052378659513397895) [X2 X3 Y6 Z7 Z8 Z9 Z10 Y11]
+ (0.005298613608873187) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 Z11]
+ (0.005298613608873187) [X0 Z1 Z2 Z3 Z4 Z5 X6 Z11]
+ (0.005298613608873187) [Y1 Z2 Z3 Z4 Z5 Z6 Y7 Z10]
+ (0.005298613608873187) [X1 Z2 Z3 Z4 Z5 Z6 X7 Z10]
+ (0.0053693072777542565) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 Z10]
+ (0.0053693072777542565) [X0 Z1 Z2 Z3 Z4 Z5 X6 Z10]
+ (0.0053693072777542565) [Y1 Z2 Z3 Z4 Z5 Z6 Y7 Z11]
+ (0.0053693072777542565) [X1 Z2 Z3 Z4 Z5 Z6 X7 Z11]
+ (0.005624614664863097) [Y0 X1 X2 Z3 Z4 Z5 Z6 Y7]
+ (0.005624614664863097) [X0 Y1 Y2 Z3 Z4 Z5 Z6 X7]
+ (0.005644068205112972) [Y0 Z1 Y2 Y6 Z7 Z8 Z9 Y10]
+ (0.005644068205112972) [X0 Z1 X2 X6 Z7 Z8 Z9 X10]
+ (0.005644068205112972) [Y1 Z2 Y3 Y7 Z8 Z9 Z10 Y11]
+ (0.005644068205112972) [X1 Z2 X3 X7 Z8 Z9 Z10 X11]
+ (0.005921780910691961) [Y5 Z6 Z7 X8 X9 Z10 Z11 Y12]
+ (0.005921780910691961) [X5 Z6 Z7 Y8 Y9 Z10 Z11 X12]
+ (0.007148739430122435) [Y4 X5 X6 Z7 Z8 Z9 Z10 Y11]
+ (0.007148739430122435) [X4 Y5 Y6 Z7 Z8 Z9 Z10 X11]
+ (0.0078497448038764) [Y3 Z4 Z5 Y6 X7 Z8 Z9 X10]
+ (0.0078497448038764) [X3 Z4 Z5 X6 Y7 Z8 Z9 Y10]
+ (0.010026060942127298) [Y3 Y4 X5 Z6 Z7 Z8 Z9 X10]
+ (0.010026060942127298) [X3 X4 Y5 Z6 Z7 Z8 Z9 Y10]
+ (0.011108457108600134) [Y4 Z5 Z6 Y7 X10 Z11 Z12 X13]
+ (0.011108457108600134) [X4 Z5 Z6 X7 Y10 Z11 Z12 Y13]
+ (0.011728278016662264) [Y2 Z3 Z4 Z5 Z6 X7 X8 Y9]
+ (0.011728278016662264) [X2 Z3 Z4 Z5 Z6 Y7 Y8 X9]
+ (0.014478375425960595) [Y6 Z7 Z8 Z9 Z10 X11 X12 Y13]
+ (0.014478375425960595) [X6 Z7 Z8 Z9 Z10 Y11 Y12 X13]
+ (0.01477967426602425) [Y3 Z4 Z5 Z6 Z7 X8 X9 Y10]
+ (0.01477967426602425) [X3 Z4 Z5 Z6 Z7 Y8 Y9 X10]
+ (0.015241941423338158) [Y2 Z3 Z4 Z5 Z6 Y7 X10 X11]
+ (0.015241941423338158) [X2 Z3 Z4 Z5 Z6 X7 Y10 Y11]
+ (0.016126269312017345) [Y5 Z6 Z7 Z8 Z9 Y10 X11 X12]
+ (0.016126269312017345) [X5 Z6 Z7 Z8 Z9 X10 Y11 Y12]
+ (0.01906094409083804) [Y3 X4 X7 Z8 Z9 Z10 Z11 Y12]
+ (0.01906094409083804) [X3 Y4 Y7 Z8 Z9 Z10 Z11 X12]
+ (0.01918681967778316) [Y2 Z3 Z4 X5 X10 Z11 Z12 Y13]
+ (0.01918681967778316) [X2 Z3 Z4 Y5 Y10 Z11 Z12 X13]
+ (0.04590691044276786) [Z0 Y1 Z2 Z3 Z4 Z5 Z6 Y7]
+ (0.04590691044276786) [Z0 X1 Z2 Z3 Z4 Z5 Z6 X7]
+ (-0.369053428062863) [Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.369053428062863) [X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.369053428062863) [Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.369053428062863) [X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.2842056452544454) [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.2842056452544454) [X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.28420564525444536) [Y3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.28420564525444536) [X3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.09059904907366144) [Z0 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.09059904907366144) [Z0 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.09059904907366144) [Z1 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.09059904907366144) [Z1 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.08676981942781828) [Z0 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.08676981942781828) [Z0 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.08676981942781828) [Z1 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.08676981942781828) [Z1 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.07709206903841534) [Z0 Y3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.07709206903841534) [Z0 X3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.07709206903841534) [Z1 Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.07709206903841534) [Z1 X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.06814071243605765) [Z0 Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.06814071243605765) [Z0 X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.06814071243605765) [Z1 Y3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.06814071243605765) [Z1 X3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.0357306173477048) [Z2 Y3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.0357306173477048) [Z2 X3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.03456473585183325) [Z2 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.03456473585183325) [Z2 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.03456473585183325) [Z3 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.03456473585183325) [Z3 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.024485319290453236) [Z2 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.024485319290453236) [Z2 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.024485319290453236) [Z3 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.024485319290453236) [Z3 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.0241992166990195) [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Z11]
+ (-0.0241992166990195) [X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10 Z11]
+ (-0.023299101488190407) [Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12 Z13]
+ (-0.023299101488190407) [X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12 Z13]
+ (-0.02260373644944742) [Z4 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.02260373644944742) [Z4 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.01975448870163509) [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Z12]
+ (-0.01975448870163509) [X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10 Z12]
+ (-0.01975448870163509) [Y3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11 Z13]
+ (-0.01975448870163509) [X3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11 Z13]
+ (-0.017264789466435247) [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Z13]
+ (-0.017264789466435247) [X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10 Z13]
+ (-0.017264789466435247) [Y3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11 Z12]
+ (-0.017264789466435247) [X3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11 Z12]
+ (-0.016126269312017345) [Y4 Z5 Z6 Z7 Z8 Z9 Y10 Y11 Z12 Y13]
+ (-0.016126269312017345) [Y4 Z5 Z6 Z7 Z8 Z9 Y10 X11 Z12 X13]
+ (-0.016126269312017345) [X4 Z5 Z6 Z7 Z8 Z9 X10 Y11 Z12 Y13]
+ (-0.016126269312017345) [X4 Z5 Z6 Z7 Z8 Z9 X10 X11 Z12 X13]
+ (-0.010079416561380007) [Y2 X3 X5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.010079416561380007) [Y2 Y3 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.010079416561380007) [X2 X3 X5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.010079416561380007) [X2 Y3 Y5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.010026060942127298) [Y2 Z3 Y4 Y5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.010026060942127298) [Y2 Z3 Y4 X5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.010026060942127298) [X2 Z3 X4 Y5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.010026060942127298) [X2 Z3 X4 X5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.008951356602357697) [Y0 X1 X3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.008951356602357697) [Y0 Y1 Y3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.008951356602357697) [X0 X1 X3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.008951356602357697) [X0 Y1 Y3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.008521275767382375) [Y2 Z3 Z4 X5 X7 Z8 Z9 Z10 Z11 Y12]
+ (-0.008521275767382375) [Y2 Z3 Z4 Y5 Y7 Z8 Z9 Z10 Z11 Y12]
+ (-0.008521275767382375) [X2 Z3 Z4 X5 X7 Z8 Z9 Z10 Z11 X12]
+ (-0.008521275767382375) [X2 Z3 Z4 Y5 Y7 Z8 Z9 Z10 Z11 X12]
+ (-0.008521275767382375) [Y3 X4 X6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.008521275767382375) [Y3 Y4 Y6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.008521275767382375) [X3 X4 X6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.008521275767382375) [X3 Y4 Y6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.0078497448038764) [Y2 Z3 Z4 Z5 Y6 Y7 Z8 Z9 Z10 Y11]
+ (-0.0078497448038764) [Y2 Z3 Z4 Z5 Y6 X7 Z8 Z9 Z10 X11]
+ (-0.0078497448038764) [X2 Z3 Z4 Z5 X6 Y7 Z8 Z9 Z10 Y11]
+ (-0.0078497448038764) [X2 Z3 Z4 Z5 X6 X7 Z8 Z9 Z10 X11]
+ (-0.004663033553314072) [Y0 Z1 Z2 X3 X6 Z7 Z8 Z9 Z10 Y11]
+ (-0.004663033553314072) [X0 Z1 Z2 Y3 Y6 Z7 Z8 Z9 Z10 X11]
+ (-0.003937817000684219) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Y8 X9 X10]
+ (-0.003937817000684219) [X1 Z2 Z3 Z4 Z5 Z6 Z7 X8 Y9 Y10]
+ (-0.0038292296458431593) [Y0 X1 X5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.0038292296458431593) [Y0 Y1 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.0038292296458431593) [X0 X1 X5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.0038292296458431593) [X0 Y1 Y5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.003469104323684921) [Y1 Y2 X5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.003469104323684921) [X1 X2 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.003363223715137501) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Y7 X8 X9]
+ (-0.003363223715137501) [X0 Z1 Z2 Z3 Z4 Z5 Z6 X7 Y8 Y9]
+ (-0.003300645095402382) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Y7 X12 X13]
+ (-0.003300645095402382) [X0 Z1 Z2 Z3 Z4 Z5 Z6 X7 Y12 Y13]
+ (-0.002101947391258152) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y11]
+ (-0.002101947391258152) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X11]
+ (-0.0017473251907744994) [Y0 Z1 Z2 Z3 Z4 X5 X10 Z11 Z12 Y13]
+ (-0.0017473251907744994) [X0 Z1 Z2 Z3 Z4 Y5 Y10 Z11 Z12 X13]
+ (-0.0016617472194694503) [Y1 X2 X3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.0016617472194694503) [X1 Y2 Y3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.0014669314604466611) [Y0 Z1 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (-0.0014669314604466611) [X0 Z1 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (-0.0014669314604466611) [Y1 Z2 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.0014669314604466611) [X1 Z2 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.0007876906921286223) [Y1 Z2 Z3 Y4 X5 Z6 Z7 Z8 Z9 X10]
+ (-0.0007876906921286223) [X1 Z2 Z3 X4 Y5 Z6 Z7 Z8 Z9 Y10]
+ (-0.0005850708471813604) [Y1 Z2 Z3 Z4 Z5 Y6 X7 Z8 Z9 X10]
+ (-0.0005850708471813604) [X1 Z2 Z3 Z4 Z5 X6 Y7 Z8 Z9 Y10]
+ (-0.00020630418719142928) [Y1 Z2 Z3 Y4 X7 Z8 Z9 Z10 Z11 X12]
+ (-0.00020630418719142928) [X1 Z2 Z3 X4 Y7 Z8 Z9 Z10 Z11 Y12]
+ (-7.069366888106928e-05) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Y7 X10 X11]
+ (-7.069366888106928e-05) [X0 Z1 Z2 Z3 Z4 Z5 Z6 X7 Y10 Y11]
+ (-4.992654621975633e-05) [Y0 Z1 Z2 Z3 Z4 Z6 Z7 Z8 Z9 Y10]
+ (-4.992654621975633e-05) [X0 Z1 Z2 Z3 Z4 Z6 Z7 Z8 Z9 X10]
+ (-4.992654621975633e-05) [Y1 Z2 Z3 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-4.992654621975633e-05) [X1 Z2 Z3 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (7.069366888106928e-05) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 X7 X10 Y11]
+ (7.069366888106928e-05) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Y7 Y10 X11]
+ (0.00019481575902278927) [Y0 Z1 Z2 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (0.00019481575902278927) [X0 Z1 Z2 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (0.00019481575902278927) [Y1 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (0.00019481575902278927) [X1 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (0.00020630418719142928) [Y1 Z2 Z3 X4 X7 Z8 Z9 Z10 Z11 Y12]
+ (0.00020630418719142928) [X1 Z2 Z3 Y4 Y7 Z8 Z9 Z10 Z11 X12]
+ (0.00021591029712012032) [Y2 Z3 Y4 X6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.00021591029712012032) [X2 Z3 X4 Y6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.00021591029712012032) [Y3 Z4 Y5 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.00021591029712012032) [X3 Z4 X5 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.0005750345504676655) [Y4 Z5 Y6 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.0005750345504676655) [Y4 Z5 Y6 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.0005750345504676655) [X4 Z5 X6 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.0005750345504676655) [X4 Z5 X6 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.0005850708471813604) [Y1 Z2 Z3 Z4 Z5 X6 X7 Z8 Z9 Y10]
+ (0.0005850708471813604) [X1 Z2 Z3 Z4 Z5 Y6 Y7 Z8 Z9 X10]
+ (0.000737764145908866) [Y0 Z1 Z2 Z3 Z5 Z6 Z7 Z8 Z9 Y10]
+ (0.000737764145908866) [X0 Z1 Z2 Z3 Z5 Z6 Z7 Z8 Z9 X10]
+ (0.000737764145908866) [Y1 Z2 Z3 Z4 Z6 Z7 Z8 Z9 Z10 Y11]
+ (0.000737764145908866) [X1 Z2 Z3 Z4 Z6 Z7 Z8 Z9 Z10 X11]
+ (0.0007876906921286223) [Y1 Z2 Z3 X4 X5 Z6 Z7 Z8 Z9 Y10]
+ (0.0007876906921286223) [X1 Z2 Z3 Y4 Y5 Z6 Z7 Z8 Z9 X10]
+ (0.0015523710562676545) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Y10]
+ (0.0015523710562676545) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 X10]
+ (0.0015523710562676545) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z9 Z10 Y11]
+ (0.0015523710562676545) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Z9 Z10 X11]
+ (0.0016617472194694503) [Y1 Y2 X3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (0.0016617472194694503) [X1 X2 Y3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (0.0017473251907744994) [Y0 Z1 Z2 Z3 Z4 Y5 X10 Z11 Z12 X13]
+ (0.0017473251907744994) [X0 Z1 Z2 Z3 Z4 X5 Y10 Z11 Z12 Y13]
+ (0.0024896992351998402) [Y3 Z4 Z5 Z6 Z7 Z8 Z9 X10 X12 Y13]
+ (0.0024896992351998402) [Y3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Y12 Y13]
+ (0.0024896992351998402) [X3 Z4 Z5 Z6 Z7 Z8 Z9 X10 X12 X13]
+ (0.0024896992351998402) [X3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Y12 X13]
+ (0.003300645095402382) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 X7 X12 Y13]
+ (0.003300645095402382) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Y7 Y12 X13]
+ (0.003363223715137501) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 X7 X8 Y9]
+ (0.003363223715137501) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Y7 Y8 X9]
+ (0.003469104323684921) [Y1 X2 X5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.003469104323684921) [X1 Y2 Y5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.003937817000684219) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 X8 X9 Y10]
+ (0.003937817000684219) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Y8 Y9 X10]
+ (0.004663033553314072) [Y0 Z1 Z2 Y3 X6 Z7 Z8 Z9 Z10 X11]
+ (0.004663033553314072) [X0 Z1 Z2 X3 Y6 Z7 Z8 Z9 Z10 Y11]
+ (0.004810701809059672) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z8 Z9 Y10]
+ (0.004810701809059672) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z8 Z9 X10]
+ (0.004810701809059672) [Y1 Z2 Z3 Z4 Z5 Z7 Z8 Z9 Z10 Y11]
+ (0.004810701809059672) [X1 Z2 Z3 Z4 Z5 Z7 Z8 Z9 Z10 X11]
+ (0.005395772656241034) [Y0 Z1 Z2 Z3 Z4 Z5 Z7 Z8 Z9 Y10]
+ (0.005395772656241034) [X0 Z1 Z2 Z3 Z4 Z5 Z7 Z8 Z9 X10]
+ (0.005395772656241034) [Y1 Z2 Z3 Z4 Z5 Z6 Z8 Z9 Z10 Y11]
+ (0.005395772656241034) [X1 Z2 Z3 Z4 Z5 Z6 Z8 Z9 Z10 X11]
+ (0.005490188056951873) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z9 Y10]
+ (0.005490188056951873) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z9 X10]
+ (0.005490188056951873) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z10 Y11]
+ (0.005490188056951873) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z10 X11]
+ (0.005921780910691961) [Y4 Z5 Z6 Z7 Y8 Y9 Z10 Z11 Z12 Y13]
+ (0.005921780910691961) [Y4 Z5 Z6 Z7 Y8 X9 Z10 Z11 Z12 X13]
+ (0.005921780910691961) [X4 Z5 Z6 Z7 X8 Y9 Z10 Z11 Z12 Y13]
+ (0.005921780910691961) [X4 Z5 Z6 Z7 X8 X9 Z10 Z11 Z12 X13]
+ (0.010539668323455662) [Y2 Z3 X4 X6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.010539668323455662) [X2 Z3 Y4 Y6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.010539668323455662) [Y3 Z4 X5 X7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.010539668323455662) [X3 Z4 Y5 Y7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.010755578620575785) [Y2 Z3 Y4 Y6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.010755578620575785) [X2 Z3 X4 X6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.010755578620575785) [Y3 Z4 Y5 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.010755578620575785) [X3 Z4 X5 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.01477967426602425) [Y2 Z3 Z4 Z5 Z6 Z7 Y8 Y9 Z10 Y11]
+ (0.01477967426602425) [Y2 Z3 Z4 Z5 Z6 Z7 Y8 X9 Z10 X11]
+ (0.01477967426602425) [X2 Z3 Z4 Z5 Z6 Z7 X8 Y9 Z10 Y11]
+ (0.01477967426602425) [X2 Z3 Z4 Z5 Z6 Z7 X8 X9 Z10 X11]
+ (0.019276854387958158) [Y2 Z3 Y4 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.019276854387958158) [Y2 Z3 Y4 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.019276854387958158) [X2 Z3 X4 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.019276854387958158) [X2 Z3 X4 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.019276854387958158) [Y3 Z4 Y5 Y6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.019276854387958158) [Y3 Z4 Y5 X6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.019276854387958158) [X3 Z4 X5 Y6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.019276854387958158) [X3 Z4 X5 X6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.05950861542666956) [Y0 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (0.05950861542666956) [X0 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (0.07266230744354596) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10]
+ (0.07266230744354596) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10]
+ (0.07266230744354596) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (0.07266230744354596) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.01906094409083804) [Y2 Z3 Z4 Y5 X6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.01906094409083804) [X2 Z3 Z4 X5 Y6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.01007941656138001) [Y2 Y3 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.01007941656138001) [X2 X3 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.008951356602357697) [Y0 Y1 X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.008951356602357697) [X0 X1 Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.007652598403883308) [Y0 Z1 Y2 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.007652598403883308) [X0 Z1 X2 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.007652598403883308) [Y1 Z2 Y3 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.007652598403883308) [X1 Z2 X3 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.005776407189565959) [Y0 Z1 Z2 X3 X5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.005776407189565959) [Y0 Z1 Z2 Y3 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.005776407189565959) [X0 Z1 Z2 X3 X5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.005776407189565959) [X0 Z1 Z2 Y3 Y5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.005776407189565959) [Y1 X2 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.005776407189565959) [Y1 Y2 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.005776407189565959) [X1 X2 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.005776407189565959) [X1 Y2 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.005345295538002268) [Y0 Z1 Y2 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.005345295538002268) [X0 Z1 X2 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.005345295538002268) [Y1 Z2 Y3 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.005345295538002268) [X1 Z2 X3 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.0038292296458431597) [Y0 Y1 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.0038292296458431597) [X0 X1 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.003048698142505014) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10 X12 Y13]
+ (-0.003048698142505014) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Y12 Y13]
+ (-0.003048698142505014) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10 X12 X13]
+ (-0.003048698142505014) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Y12 X13]
+ (-0.0024896992351998402) [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11 X12 Y13]
+ (-0.0024896992351998402) [X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11 Y12 X13]
+ (-0.0023073028658810377) [Y0 Z1 X2 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.0023073028658810377) [X0 Z1 Y2 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.0023073028658810377) [Y1 Z2 X3 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.0023073028658810377) [X1 Z2 Y3 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.002101947391258152) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Z11]
+ (-0.002101947391258152) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10 Z11]
+ (-0.0018761912143173479) [Y0 Z1 Y2 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.0018761912143173479) [Y0 Z1 Y2 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.0018761912143173479) [X0 Z1 X2 Y5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.0018761912143173479) [X0 Z1 X2 X5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.0018761912143173479) [Y1 Z2 Y3 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.0018761912143173479) [Y1 Z2 Y3 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.0018761912143173479) [X1 Z2 X3 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.0018761912143173479) [X1 Z2 X3 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.0016617472194694503) [Y0 Z1 Y2 Y3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.0016617472194694503) [Y0 Z1 Y2 X3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.0016617472194694503) [X0 Z1 X2 Y3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (-0.0016617472194694503) [X0 Z1 X2 X3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.0012406051908830898) [Y0 Z1 Z2 Z3 Z4 X5 X7 Z8 Z9 Z10 Z11 Y12]
+ (-0.0012406051908830898) [Y0 Z1 Z2 Z3 Z4 Y5 Y7 Z8 Z9 Z10 Z11 Y12]
+ (-0.0012406051908830898) [X0 Z1 Z2 Z3 Z4 X5 X7 Z8 Z9 Z10 Z11 X12]
+ (-0.0012406051908830898) [X0 Z1 Z2 Z3 Z4 Y5 Y7 Z8 Z9 Z10 Z11 X12]
+ (-0.0012406051908830898) [Y1 Z2 Z3 X4 X6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.0012406051908830898) [Y1 Z2 Z3 Y4 Y6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.0012406051908830898) [X1 Z2 Z3 X4 X6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.0012406051908830898) [X1 Z2 Z3 Y4 Y6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.0010343010036916603) [Y0 Z1 Z2 Z3 X4 X6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (-0.0010343010036916603) [X0 Z1 Z2 Z3 Y4 Y6 Z7 Z8 Z9 Z10 Z11 X12]
+ (-0.0010343010036916603) [Y1 Z2 Z3 Z4 X5 X7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.0010343010036916603) [X1 Z2 Z3 Z4 Y5 Y7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.0005850708471813603) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 Y7 Z8 Z9 Z10 Y11]
+ (0.0005850708471813603) [Y0 Z1 Z2 Z3 Z4 Z5 Y6 X7 Z8 Z9 Z10 X11]
+ (0.0005850708471813603) [X0 Z1 Z2 Z3 Z4 Z5 X6 Y7 Z8 Z9 Z10 Y11]
+ (0.0005850708471813603) [X0 Z1 Z2 Z3 Z4 Z5 X6 X7 Z8 Z9 Z10 X11]
+ (0.0007876906921286222) [Y0 Z1 Z2 Z3 Y4 Y5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (0.0007876906921286222) [Y0 Z1 Z2 Z3 Y4 X5 Z6 Z7 Z8 Z9 Z10 X11]
+ (0.0007876906921286222) [X0 Z1 Z2 Z3 X4 Y5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (0.0007876906921286222) [X0 Z1 Z2 Z3 X4 X5 Z6 Z7 Z8 Z9 Z10 X11]
+ (0.0011686711558014777) [Y0 Z1 Z2 Z3 Y4 Y6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.0011686711558014777) [X0 Z1 Z2 Z3 X4 X6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.0011686711558014777) [Y1 Z2 Z3 Z4 Y5 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.0011686711558014777) [X1 Z2 Z3 Z4 X5 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.0012821637148731798) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Z13]
+ (0.0012821637148731798) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10 Z13]
+ (0.0012821637148731798) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11 Z12]
+ (0.0012821637148731798) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11 Z12]
+ (0.002202972159493139) [Y0 Z1 Z2 Z3 Y4 X6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.002202972159493139) [X0 Z1 Z2 Z3 X4 Y6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.002202972159493139) [Y1 Z2 Z3 Z4 Y5 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.002202972159493139) [X1 Z2 Z3 Z4 X5 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.0024092763466845675) [Y0 Z1 Z2 Z3 Y4 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.0024092763466845675) [Y0 Z1 Z2 Z3 Y4 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.0024092763466845675) [X0 Z1 Z2 Z3 X4 Y7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.0024092763466845675) [X0 Z1 Z2 Z3 X4 X7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.0024092763466845675) [Y1 Z2 Z3 Z4 Y5 Y6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.0024092763466845675) [Y1 Z2 Z3 Z4 Y5 X6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.0024092763466845675) [X1 Z2 Z3 Z4 X5 Y6 Z7 Z8 Z9 Z10 Z11 Y12]
+ (0.0024092763466845675) [X1 Z2 Z3 Z4 X5 X6 Z7 Z8 Z9 Z10 Z11 X12]
+ (0.0024896992351998402) [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11 X12 X13]
+ (0.0024896992351998402) [X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11 Y12 Y13]
+ (0.0038292296458431597) [Y0 X1 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.0038292296458431597) [X0 Y1 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.003937817000684219) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Y8 Y9 Z10 Y11]
+ (0.003937817000684219) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Y8 X9 Z10 X11]
+ (0.003937817000684219) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 X8 Y9 Z10 Y11]
+ (0.003937817000684219) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 X8 X9 Z10 X11]
+ (0.004330861857378194) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Y10 Z12]
+ (0.004330861857378194) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 X10 Z12]
+ (0.004330861857378194) [Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11 Z13]
+ (0.004330861857378194) [X1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11 Z13]
+ (0.008951356602357697) [Y0 X1 X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (0.008951356602357697) [X0 Y1 Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (0.01007941656138001) [Y2 X3 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.01007941656138001) [X2 Y3 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.01906094409083804) [Y2 Z3 Z4 X5 X6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.01906094409083804) [X2 Z3 Z4 Y5 Y6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.05950861542666956) [Z0 Y1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11]
+ (0.05950861542666956) [Z0 X1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11]
+ (-0.003469104323684921) [Y0 Z1 Z2 Y3 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.003469104323684921) [X0 Z1 Z2 X3 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (-0.0030486981425050146) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11 X12 X13]
+ (-0.0030486981425050146) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11 Y12 Y13]
+ (-0.00020630418719142928) [Y0 Z1 Z2 Z3 Z4 Y5 X6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (-0.00020630418719142928) [X0 Z1 Z2 Z3 Z4 X5 Y6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.00020630418719142928) [Y0 Z1 Z2 Z3 Z4 X5 X6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.00020630418719142928) [X0 Z1 Z2 Z3 Z4 Y5 Y6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
+ (0.0030486981425050146) [Y0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 X11 X12 Y13]
+ (0.0030486981425050146) [X0 Z1 Z2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Y11 Y12 X13]
+ (0.003469104323684921) [Y0 Z1 Z2 X3 X4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Y13]
+ (0.003469104323684921) [X0 Z1 Z2 Y3 Y4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 X13]
</pre></div>
</div>
<p>Simply going from two atoms in <span class="math notranslate nohighlight">\(\text{H}_2\)</span> to three in <span class="math notranslate nohighlight">\(\text{H}_2 \text{O}\)</span>
resulted in over triple the number of qubits required and 1086 measurements that must be made!</p>
<p>We can see that as the size of our molecule increases, we run into a problem: larger molecules
result in Hamiltonians that not only require a larger number of qubits <span class="math notranslate nohighlight">\(N\)</span> in their
representation, but the number of terms in the Hamiltonian scales like
<span class="math notranslate nohighlight">\(\mathcal{O}(N^4)\)</span>! 😱😱😱</p>
<p>We can mitigate this somewhat by choosing smaller <a class="reference external" href="https://en.wikipedia.org/wiki/Basis_set_(chemistry)">basis sets</a> to represent the electronic structure
wavefunction, however this would be done at the cost of solution accuracy, and doesn’t reduce the number of
measurements significantly enough to allow us to scale to classically intractable problems.</p>
<div class="figure align-center" id="id13">
<a class="reference internal image-reference" href="../_images/n4.png"><img alt="../_images/n4.png" src="../_images/n4.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The number of qubit Hamiltonian terms required to represent various molecules in the specified
basis sets (adapted from <a class="reference external" href="https://pranavgokhale.com/static/Minimizing_State_Preparations_for_VQE.pdf">Minimizing State Preparations for VQE by Gokhale et al.</a>)</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="simultaneously-measuring-observables">
<h2>Simultaneously measuring observables<a class="headerlink" href="#simultaneously-measuring-observables" title="Permalink to this headline">¶</a></h2>
<p>One of the assumptions we made above was that every term in the Hamiltonian must be measured independently.
However, this might not be the case. From the <a class="reference external" href="https://en.wikipedia.org/wiki/Uncertainty_principle">Heisenberg uncertainty relationship</a> for two
observables <span class="math notranslate nohighlight">\(\hat{A}\)</span> and <span class="math notranslate nohighlight">\(\hat{B}\)</span>, we know that</p>
<div class="math notranslate nohighlight">
\[\sigma_A^2 \sigma_B^2 \geq \frac{1}{2}\left|\left\langle [\hat{A}, \hat{B}] \right\rangle\right|,\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma^2_A\)</span> and <span class="math notranslate nohighlight">\(\sigma^2_B\)</span> are the variances of measuring the expectation value of the
associated observables, and</p>
<div class="math notranslate nohighlight">
\[[\hat{A}, \hat{B}] = \hat{A}\hat{B}-\hat{B}\hat{A}\]</div>
<p>is the commutator. Therefore,</p>
<ul class="simple">
<li><p>If the two observables <span class="math notranslate nohighlight">\(\hat{A}\)</span> and <span class="math notranslate nohighlight">\(\hat{B}\)</span> do not commute (<span class="math notranslate nohighlight">\([\hat{A},
\hat{B}] \neq 0\)</span>), then <span class="math notranslate nohighlight">\(\sigma_A^2
\sigma_B^2 &gt; 0\)</span> and we cannot simultaneously measure the expectation values of the two
observables.</p></li>
</ul>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(\hat{A}\)</span> and <span class="math notranslate nohighlight">\(\hat{B}\)</span> <strong>do</strong> commute (<span class="math notranslate nohighlight">\([\hat{A},
\hat{B}] = 0\)</span>), then <span class="math notranslate nohighlight">\(\sigma_A^2
\sigma_B^2 \geq 0\)</span> and there exists a measurement basis where we can <strong>simultaneously measure</strong> the
expectation value of both observables on the same state.</p></li>
</ul>
<p>To explore why commutativity and simultaneous measurement are related, let’s assume that there
is a complete, orthonormal eigenbasis <span class="math notranslate nohighlight">\(|\phi_n\rangle\)</span> that <em>simultaneously
diagonalizes</em> both <span class="math notranslate nohighlight">\(\hat{A}\)</span> and <span class="math notranslate nohighlight">\(\hat{B}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}① ~~ \hat{A} |\phi_n\rangle &amp;= \lambda_{A,n} |\phi_n\rangle,\\
② ~~ \hat{B} |\phi_n\rangle &amp;= \lambda_{B,n} |\phi_n\rangle.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda_{A,n}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{B,n}\)</span> are the corresponding eigenvalues.
If we pre-multiply the first equation by <span class="math notranslate nohighlight">\(\hat{B}\)</span>, and the second by <span class="math notranslate nohighlight">\(\hat{A}\)</span>
(both denoted in blue):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\color{blue}{\hat{B}}\hat{A} |\phi_n\rangle &amp;= \lambda_{A,n} \color{blue}{\hat{B}}
  |\phi_n\rangle = \lambda_{A,n} \color{blue}{\lambda_{B,n}} |\phi_n\rangle,\\
\color{blue}{\hat{A}}\hat{B} |\phi_n\rangle &amp;= \lambda_{B,n} \color{blue}{\hat{A}}
  |\phi_n\rangle = \lambda_{A,n} \color{blue}{\lambda_{B,n}} |\phi_n\rangle.\end{split}\]</div>
<p>We can see that assuming a simultaneous eigenbasis requires that
<span class="math notranslate nohighlight">\(\hat{A}\hat{B}|\phi_n\rangle = \hat{B}\hat{A}|\phi_n\rangle\)</span>. Or, rearranging,</p>
<div class="math notranslate nohighlight">
\[(\hat{A}\hat{B} - \hat{B}\hat{A}) |\phi_n\rangle = [\hat{A}, \hat{B}]|\phi_n\rangle = 0.\]</div>
<p>Our assumption that <span class="math notranslate nohighlight">\(|\phi_n\rangle\)</span> simultaneously diagonalizes both <span class="math notranslate nohighlight">\(\hat{A}\)</span> and
<span class="math notranslate nohighlight">\(\hat{B}\)</span> only holds true if the two observables commute.</p>
<p>So far, this seems awfully theoretical. What does this mean in practice?</p>
<p>In the realm of variational circuits, we typically want to compute expectation values of an
observable on a given state <span class="math notranslate nohighlight">\(|\psi\rangle\)</span>. If we have two commuting observables, we now know that
they share a simultaneous eigenbasis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{A} &amp;= \sum_n \lambda_{A, n} |\phi_n\rangle\langle \phi_n|,\\
\hat{B} &amp;= \sum_n \lambda_{B, n} |\phi_n\rangle\langle \phi_n|.\end{split}\]</div>
<p>Substituting this into the expression for the expectation values:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\langle\hat{A}\rangle &amp;= \langle \psi | \hat{A} | \psi \rangle = \langle \psi | \left( \sum_n
    \lambda_{A, n} |\phi_n\rangle\langle \phi_n| \right) | \psi \rangle = \sum_n \lambda_{A,n}
    |\langle \phi_n|\psi\rangle|^2,\\
\langle\hat{B}\rangle &amp;= \langle \psi | \hat{B} | \psi \rangle = \langle \psi | \left( \sum_n
    \lambda_{B, n} |\phi_n\rangle\langle \phi_n| \right) | \psi \rangle = \sum_n \lambda_{B,n}
    |\langle \phi_n|\psi\rangle|^2.\end{split}\]</div>
<p>So, assuming we know the eigenvalues of the commuting observables in advance, if we perform a
measurement in their shared eigenbasis (the <span class="math notranslate nohighlight">\(|\phi_n\rangle\)</span>), we only need to perform a <strong>single measurement</strong> of the
probabilities <span class="math notranslate nohighlight">\(|\langle \phi_n|\psi\rangle|^2\)</span> in order to recover both expectation values! 😍</p>
<p>Fantastic! But, can we use this to reduce the number of measurements we need to perform in the VQE algorithm?
To do so, we must find the answer to two questions:</p>
<ol class="arabic simple">
<li><p>How do we determine which terms of the cost Hamiltonian commute?</p></li>
<li><p>How do we rotate the circuit into the shared eigenbasis prior to measurement?</p></li>
</ol>
<p>The answers to these questions aren’t necessarily easy nor straightforward. Thankfully, there are
some recent techniques we can harness to address both.</p>
</div>
<div class="section" id="qubit-wise-commuting-pauli-terms">
<h2>Qubit-wise commuting Pauli terms<a class="headerlink" href="#qubit-wise-commuting-pauli-terms" title="Permalink to this headline">¶</a></h2>
<p>Back when we summarized the VQE algorithm, we saw that each term of the Hamiltonian is generally represented
as a tensor product of Pauli operators:</p>
<div class="math notranslate nohighlight">
\[h_i = \bigotimes_{n=0}^{N-1} P_n.\]</div>
<p>Luckily, this tensor product structure allows us to take a bit of a shortcut. Rather than consider
<strong>full commutativity</strong>, we can consider a more strict condition known as <strong>qubit-wise
commutativity</strong> (QWC).</p>
<p>To start with, let’s consider single-qubit Pauli operators and the identity. We know that the Pauli operators
commute with themselves as well as the identity, but they do <em>not</em> commute with
each other:</p>
<div class="math notranslate nohighlight">
\[[\sigma_i, I] = 0, ~~~ [\sigma_i, \sigma_i] = 0, ~~~ [\sigma_i, \sigma_j] = c \sigma_k \delta_{ij}.\]</div>
<p>Now consider two tensor products of Pauli terms, for example <span class="math notranslate nohighlight">\(X\otimes Y \otimes I\)</span> and
<span class="math notranslate nohighlight">\(X\otimes I \otimes Z\)</span>. We say that these two terms are qubit-wise commuting, since, if
we compare each subsystem in the tensor product, we see that every one commutes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ | *1c | *1c | *1c | *1c | *1c |}
  X &amp;\otimes &amp;Y &amp;\otimes &amp;I\\
  X &amp;\otimes &amp;I &amp;\otimes &amp;Z
\end{array} ~~~~ \Rightarrow ~~~~ [X, X] = 0, ~~~ [Y, I] = 0, ~~~ [I, Z] = 0.\end{split}\]</div>
<p>As a consequence, both terms must commute:</p>
<div class="math notranslate nohighlight">
\[[X\otimes Y \otimes I, X\otimes I \otimes Z] = 0.\]</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Qubit-wise commutativity is a <strong>sufficient</strong> but not <strong>necessary</strong> condition
for full commutativity. For example, the two Pauli terms <span class="math notranslate nohighlight">\(Y\otimes Y\)</span> and
<span class="math notranslate nohighlight">\(X\otimes X\)</span> are not qubit-wise commuting, but do commute (have a go verifying this!).</p>
</div>
<p>Once we have identified a qubit-wise commuting pair of Pauli terms, it is also straightforward to
find the gates to rotate the circuit into the shared eigenbasis. To do so, we simply rotate
each qubit one-by-one depending on the Pauli operator we are measuring on that wire:</p>
<style>
    .docstable {
        max-width: 300px;
    }
    .docstable tr.row-even th, .docstable tr.row-even td {
        text-align: center;
    }
    .docstable tr.row-odd th, .docstable tr.row-odd td {
        text-align: center;
    }
</style>
<div class="d-flex justify-content-center"><table class="docstable docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Observable</p></th>
<th class="head"><p>Rotation gate</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(X\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(RY(-\pi/2) = H\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(Y\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(RX(\pi/2)=HS^{-1}=HSZ\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(Z\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(I\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(I\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(I\)</span></p></td>
</tr>
</tbody>
</table>
</div><p>Therefore, in this particular example:</p>
<ul class="simple">
<li><p>Wire 0: we are measuring both terms in the <span class="math notranslate nohighlight">\(X\)</span> basis, apply the Hadamard gate</p></li>
<li><p>Wire 1: we are measuring both terms in the <span class="math notranslate nohighlight">\(Y\)</span> basis, apply a <span class="math notranslate nohighlight">\(RX(\pi/2)\)</span> gate</p></li>
<li><p>Wire 2: we are measuring both terms in the <span class="math notranslate nohighlight">\(Z\)</span> basis (the computational basis), no gate needs to be applied.</p></li>
</ul>
<p>Let’s use PennyLane to verify this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obs</span> <span class="o">=</span> <span class="p">[</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliY.html#pennylane.PauliY" title="pennylane.PauliY" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliY</span></a><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>First, let’s naively use two separate circuit evaluations to measure
the two QWC terms.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit1</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.StronglyEntanglingLayers.html#pennylane.StronglyEntanglingLayers" title="pennylane.StronglyEntanglingLayers" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">StronglyEntanglingLayers</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit2</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.StronglyEntanglingLayers.html#pennylane.StronglyEntanglingLayers" title="pennylane.StronglyEntanglingLayers" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">StronglyEntanglingLayers</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">param_shape</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">templates</span><span class="o">.</span><span class="n">StronglyEntanglingLayers</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">param_shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expectation value of XYI = &quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit1</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expectation value of XIZ = &quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit2</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Expectation value of XYI =  0.023129409941229695
Expectation value of XIZ =  -0.08337746900567453
</pre></div>
</div>
<p>Now, let’s use our QWC approach to reduce this down to a <em>single</em> measurement
of the probabilities in the shared eigenbasis of both QWC observables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit_qwc</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.StronglyEntanglingLayers.html#pennylane.StronglyEntanglingLayers" title="pennylane.StronglyEntanglingLayers" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">StronglyEntanglingLayers</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="c1"># rotate wire 0 into the shared eigenbasis</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.RY.html#pennylane.RY" title="pennylane.RY" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">RY</span></a><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># rotate wire 1 into the shared eigenbasis</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.RX.html#pennylane.RX" title="pennylane.RX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">RX</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># wire 2 does not require a rotation</span>

    <span class="c1"># measure probabilities in the computational basis</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.probs.html#pennylane.probs" title="pennylane.probs" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">probs</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>


<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rotated_probs</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit_qwc</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rotated_probs</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.23377852 0.0012277  0.22316763 0.00039575 0.26389095 0.00098097
 0.27617434 0.00038414]
</pre></div>
</div>
<p>We’re not quite there yet; we have only calculated the probabilities of the variational circuit
rotated into the shared eigenbasis—the <span class="math notranslate nohighlight">\(|\langle \phi_n |\psi\rangle|^2\)</span>. To recover the
<em>expectation values</em> of the two QWC observables from the probabilities, recall that we need one
final piece of information: their eigenvalues <span class="math notranslate nohighlight">\(\lambda_{A, n}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{B, n}\)</span>.</p>
<p>We know that the single-qubit Pauli operators each have eigenvalues <span class="math notranslate nohighlight">\((1, -1)\)</span>, while the identity
operator has eigenvalues <span class="math notranslate nohighlight">\((1, 1)\)</span>. We can make use of <code class="docutils literal notranslate"><span class="pre">np.kron</span></code> to quickly
generate the eigenvalues of the full Pauli terms, making sure that the order
of the eigenvalues in the Kronecker product corresponds to the tensor product.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eigenvalues_XYI</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eigenvalues_XIZ</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Taking the linear combination of the eigenvalues and the probabilities</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expectation value of XYI = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eigenvalues_XYI</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rotated_probs</span></a><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expectation value of XIZ = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eigenvalues_XIZ</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rotated_probs</span></a><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Expectation value of XYI =  0.023129409941229702
Expectation value of XIZ =  -0.08337746900567436
</pre></div>
</div>
<p>Compare this to the result when we used two circuit evaluations. We have successfully used a
single circuit evaluation to recover both expectation values!</p>
<p>Luckily, PennyLane automatically performs this QWC grouping under the hood. We simply
return the two QWC Pauli terms from the QNode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.StronglyEntanglingLayers.html#pennylane.StronglyEntanglingLayers" title="pennylane.StronglyEntanglingLayers" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">StronglyEntanglingLayers</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliY.html#pennylane.PauliY" title="pennylane.PauliY" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliY</span></a><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[tensor(0.02312941, requires_grad=True), tensor(-0.08337747, requires_grad=True)]
</pre></div>
</div>
<p>Behind the scenes, PennyLane is making use of our built-in
<code class="xref py py-mod docutils literal notranslate"><span class="pre">qml.pauli</span></code> module, which contains functions for diagonalizing QWC
terms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rotations</span><span class="p">,</span> <span class="n">new_obs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.pauli.diagonalize_qwc_pauli_words.html#pennylane.pauli.diagonalize_qwc_pauli_words" title="pennylane.pauli.diagonalize_qwc_pauli_words" class="sphx-glr-backref-module-pennylane-pauli sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">pauli</span><span class="o">.</span><span class="n">diagonalize_qwc_pauli_words</span></a><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rotations</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_obs</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[RY(-1.5707963267948966, wires=[0]), RX(1.5707963267948966, wires=[1])]
[PauliZ(wires=[0]) @ PauliZ(wires=[1]), PauliZ(wires=[0]) @ PauliZ(wires=[2])]
</pre></div>
</div>
<p>Here, the first line corresponds to the basis rotations that were discussed above, written in
terms of <code class="docutils literal notranslate"><span class="pre">RX</span></code> and <code class="docutils literal notranslate"><span class="pre">RY</span></code> rotations. Check out the <code class="xref py py-mod docutils literal notranslate"><span class="pre">qml.pauli</span></code>
documentation for more details on its provided functionality and how it works.</p>
<p>Given a Hamiltonian containing a large number of Pauli terms,
there is a high likelihood of there being a significant number of terms that qubit-wise commute. Can
we somehow partition the terms into <strong>fewest</strong> number of QWC groups to minimize the number of measurements
we need to take?</p>
</div>
<div class="section" id="grouping-qwc-terms">
<h2>Grouping QWC terms<a class="headerlink" href="#grouping-qwc-terms" title="Permalink to this headline">¶</a></h2>
<p>A nice example is provided in <a class="footnote-reference brackets" href="#verteletskyi2020" id="id7">6</a> showing how we might tackle this. Say we have
the following Hamiltonian defined over four qubits:</p>
<div class="math notranslate nohighlight">
\[H = Z_0 + Z_0 Z_1 + Z_0 Z_1 Z_2 + Z_0 Z_1 Z_2 Z_3 + X_2 X_3 + Y_0 X_2 X_3 + Y_0 Y_1 X_2 X_3,\]</div>
<p>where we are using the shorthand <span class="math notranslate nohighlight">\(P_0 P_2 = P\otimes I \otimes P \otimes I\)</span> for brevity.
If we go through and work out which Pauli terms are qubit-wise commuting, we can represent
this in a neat way using a graph:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/graph1.png"><img alt="../_images/graph1.png" src="../_images/graph1.png" style="width: 70%;" /></a>
</div>
<p>In the above graph, every node represents an individual Pauli term of the Hamiltonian, with
edges connecting terms that are qubit-wise commuting. Groups of qubit-wise commuting terms are
represented as <strong>complete subgraphs</strong>. Straight away, we can make an observation:
there is no unique solution for partitioning the Hamiltonian into groups of qubit-wise commuting
terms! In fact, there are several solutions:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/graph2.png"><img alt="../_images/graph2.png" src="../_images/graph2.png" style="width: 90%;" /></a>
</div>
<p>Of course, of the potential solutions above, there is one that is more optimal than the others —
on the bottom left, we have partitioned the graph into <em>two</em> complete subgraphs, as opposed to the
other solutions that require three complete subgraphs. If we were to go with this solution,
we would be able to measure the expectation value of the Hamiltonian using two circuit evaluations.</p>
<p>This problem—finding the minimum number of complete subgraphs of a graph—is actually quite well
known in graph theory, where it is referred to as the <a class="reference external" href="https://en.wikipedia.org/wiki/Clique_cover">minimum clique cover problem</a> (with ‘clique’ being another term for a complete subgraph).</p>
<p>Unfortunately, that’s where our good fortune ends—the minimum clique cover problem is known to
be <a class="reference external" href="https://en.wikipedia.org/wiki/NP-hardness">NP-hard</a>, meaning there is no known (classical)
solution to finding the optimum/minimum clique cover in polynomial time.</p>
<p>Thankfully, there is a silver lining: we know of polynomial-time algorithms for finding
<em>approximate</em> solutions to the minimum clique cover problem. These heuristic approaches, while
not guaranteed to find the optimum solution, scale quadratically with the number of nodes in the
graph/terms in the Hamiltonian <a class="footnote-reference brackets" href="#yen2020" id="id8">2</a>, so work reasonably well in practice.</p>
<p>Many of these heuristic approaches have roots in another graph problem known as <a class="reference external" href="https://en.wikipedia.org/wiki/Graph_coloring">graph
colouring</a>; the assignment of colours to
the graph’s vertices such that no adjacent vertices have the same colour. How is this related
to the minimum clique cover problem, though? If we take our QWC graph above, and generate the
<a class="reference external" href="https://en.wikipedia.org/wiki/Complement_graph">complement graph</a> by drawing edges
between all <em>non</em>-adjacent nodes,</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/graph3.png"><img alt="../_images/graph3.png" src="../_images/graph3.png" style="width: 100%;" /></a>
</div>
<p>we see that solving the minimum clique cover problem on the QWC graph is equivalent to solving the
graph colouring problem on the complement graph using the minimum possible number of colours.
While there are various different heuristic algorithms, a common one is <a class="reference external" href="https://en.wikipedia.org/wiki/Graph_coloring#Greedy_coloring">greedy colouring</a>; in fact, the open-source graph
package <a class="reference external" href="https://networkx.org/documentation/stable//reference/algorithms/generated/networkx.algorithms.coloring.greedy_color.html#networkx.algorithms.coloring.greedy_color">NetworkX even provides a function for greedy colouring</a>,
<code class="docutils literal notranslate"><span class="pre">nx.greedy_color</span></code>.</p>
<p>Let’s give this a go, using NetworkX to solve the minimum clique problem for observable grouping.
First, we’ll need to generate the QWC graph (with each node corresponding to a Hamiltonian
term, and edges indicating two terms that are QWC).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliY.html#pennylane.PauliY" title="pennylane.PauliY" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliY</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliY.html#pennylane.PauliY" title="pennylane.PauliY" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliY</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliY.html#pennylane.PauliY" title="pennylane.PauliY" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliY</span></a><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">def</span> <span class="nf">format_pauli_word</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">term</span></a><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience function that nicely formats a PennyLane</span>
<span class="sd">    tensor observable as a Pauli word&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">term</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">Tensor</span></a><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">format_pauli_word</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">term</span></a><span class="o">.</span><span class="n">obs</span><span class="p">])</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor.name" title="pennylane.operation.Tensor.name" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-attribute"><span class="n">term</span><span class="o">.</span><span class="n">name</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor.wires" title="pennylane.operation.Tensor.wires" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-attribute"><span class="n">term</span><span class="o">.</span><span class="n">wires</span><span class="o">.</span><span class="n">tolist</span></a><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>

<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="c1"># Muting irrelevant warnings</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
        <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
        <span class="n">message</span><span class="o">=</span><span class="s2">&quot;The behaviour of operator &quot;</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># add the terms to the graph</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>

    <span class="c1"># add QWC edges</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>  <span class="c1"># Z0 &lt;--&gt; Z0 Z1</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>  <span class="c1"># Z0 &lt;--&gt; Z0 Z1 Z2</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>  <span class="c1"># Z0 &lt;--&gt; Z0 Z1 Z2 Z3</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>  <span class="c1"># Z0 Z1 &lt;--&gt; Z0 Z1 Z2</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>  <span class="c1"># Z0 Z1 Z2 &lt;--&gt; Z0 Z1 Z2 Z3</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>  <span class="c1"># Z0 Z1 &lt;--&gt; Z0 Z1 Z2 Z3</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>  <span class="c1"># Z0 &lt;--&gt; X2 X3</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>  <span class="c1"># Z0 Z1 &lt;--&gt; X2 X3</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>  <span class="c1"># X2 X3 &lt;--&gt; Y0 X2 X3</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">6</span><span class="p">]],</span>  <span class="c1"># X2 X3 &lt;--&gt; Y0 Y1 X2 X3</span>
        <span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="mi">6</span><span class="p">]],</span>  <span class="c1"># Y0 X2 X3 &lt;--&gt; Y0 Y1 X2 X3</span>
    <span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span>
        <span class="n">G</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">format_pauli_word</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">},</span>
        <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">font_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;#9eded1&quot;</span><span class="p">,</span>
        <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;#c1c1c1&quot;</span>
    <span class="p">)</span>

    <span class="c1">##############################################################################</span>
    <span class="c1"># We can now generate the complement graph (compare this to our handdrawn</span>
    <span class="c1"># version above!):</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span>
        <span class="n">C</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">format_pauli_word</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">},</span>
        <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">font_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;#9eded1&quot;</span><span class="p">,</span>
        <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;#c1c1c1&quot;</span>
    <span class="p">)</span>


    <span class="c1">##############################################################################</span>
    <span class="c1"># Now that we have the complement graph, we can perform a greedy coloring to</span>
    <span class="c1"># determine the minimum number of QWC groups:</span>

    <span class="n">groups</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">coloring</span><span class="o">.</span><span class="n">greedy_color</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;largest_first&quot;</span><span class="p">)</span>

    <span class="c1"># plot the complement graph with the greedy colouring</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span>
        <span class="n">C</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">format_pauli_word</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">},</span>
        <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">font_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">node_color</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;#9eded1&quot;</span><span class="p">,</span> <span class="s2">&quot;#aad4f0&quot;</span><span class="p">)[</span><span class="n">groups</span><span class="p">[</span><span class="n">node</span><span class="p">]]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">C</span><span class="p">],</span>
        <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;#c1c1c1&quot;</span>
    <span class="p">)</span>


<span class="n">num_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">groups</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum number of QWC groupings found:&quot;</span><span class="p">,</span> <span class="n">num_groups</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_groups</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Group </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

    <span class="k">for</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">term</span></a><span class="p">,</span> <span class="n">group_id</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">group_id</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">format_pauli_word</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">term</span></a><span class="p">))</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_measurement_optimize_001.png" srcset="../_images/sphx_glr_tutorial_measurement_optimize_001.png" alt="tutorial measurement optimize" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Minimum number of QWC groupings found: 2

Group 0:
Y0 X2 X3
Y0 Y1 X2 X3
X2 X3

Group 1:
Z0 Z1 Z2
Z0 Z1 Z2 Z3
Z0
Z0 Z1
</pre></div>
</div>
</div>
<div class="section" id="putting-it-all-together">
<h2>Putting it all together<a class="headerlink" href="#putting-it-all-together" title="Permalink to this headline">¶</a></h2>
<p>So, we now have a strategy for minimizing the number of measurements we need to perform
for our VQE problem:</p>
<ol class="arabic simple">
<li><p>Determine which terms of the Hamiltonian are qubit-wise commuting, and use
this to construct a graph representing the QWC relationship.</p></li>
<li><p>Construct the complement QWC graph.</p></li>
<li><p>Use a graph colouring heuristic algorithm to determine a graph colouring for the complement graph
with a minimum number of colours. Each coloured vertex set corresponds to a
qubit-wise commuting group of Hamiltonian terms.</p></li>
<li><p>Generate and evaluate the circuit ansatz (with additional rotations) per
QWC grouping, extracting probability distributions.</p></li>
<li><p>Finally, post-process the probability distributions with the observable eigenvalues
to recover the Hamiltonian expectation value.</p></li>
</ol>
<p>Luckily, the PennyLane <code class="docutils literal notranslate"><span class="pre">pauli</span></code> module makes this relatively easy. Let’s walk through
the entire process using the provided grouping functions.</p>
<p>Steps 1-3 (finding and grouping QWC terms in the Hamiltonian) can be done via the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.pauli.group_observables.html#pennylane.pauli.group_observables" title="(in PennyLane v0.32)"><code class="xref py py-func docutils literal notranslate"><span class="pre">qml.pauli.group_observables</span></code></a> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obs_groupings</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.pauli.group_observables.html#pennylane.pauli.group_observables" title="pennylane.pauli.group_observables" class="sphx-glr-backref-module-pennylane-pauli sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">pauli</span><span class="o">.</span><span class="n">group_observables</span></a><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">grouping_type</span><span class="o">=</span><span class="s1">&#39;qwc&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;rlf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">grouping_type</span></code> argument allows us to choose how the commuting terms
are determined (more on that later!) whereas <code class="docutils literal notranslate"><span class="pre">method</span></code> determines the colouring
heuristic (in this case, <code class="docutils literal notranslate"><span class="pre">&quot;rlf&quot;</span></code> refers to Recursive Largest First, a variant of largest first colouring heuristic).</p>
<p>If we want to see what the required rotations and measurements are, we can use the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.pauli.diagonalize_qwc_groupings.html#pennylane.pauli.diagonalize_qwc_groupings" title="(in PennyLane v0.32)"><code class="xref py py-func docutils literal notranslate"><span class="pre">qml.pauli.diagonalize_qwc_groupings</span></code></a>
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rotations</span><span class="p">,</span> <span class="n">measurements</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.pauli.diagonalize_qwc_groupings.html#pennylane.pauli.diagonalize_qwc_groupings" title="pennylane.pauli.diagonalize_qwc_groupings" class="sphx-glr-backref-module-pennylane-pauli sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">pauli</span><span class="o">.</span><span class="n">diagonalize_qwc_groupings</span></a><span class="p">(</span><span class="n">obs_groupings</span><span class="p">)</span>
</pre></div>
</div>
<p>However, this isn’t strictly necessary—recall previously that the QNode
has the capability to <em>automatically</em> measure qubit-wise commuting observables!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.StronglyEntanglingLayers.html#pennylane.StronglyEntanglingLayers" title="pennylane.StronglyEntanglingLayers" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">StronglyEntanglingLayers</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">group</span><span class="p">]</span>

<span class="n">param_shape</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">templates</span><span class="o">.</span><span class="n">StronglyEntanglingLayers</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">param_shape</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">obs_groupings</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Term expectation values:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">expvals</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2"> expectation values:&quot;</span><span class="p">,</span> <span class="n">expvals</span><span class="p">)</span>

<span class="c1"># Since all the coefficients of the Hamiltonian are unity,</span>
<span class="c1"># we can simply sum the expectation values.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;H&gt; = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">result</span><span class="p">)))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Term expectation values:
Group 0 expectation values: [tensor(-0.13952774, requires_grad=True), tensor(0.00000436, requires_grad=True), tensor(0.08395489, requires_grad=True)]
Group 1 expectation values: [tensor(0.97312406, requires_grad=True), tensor(0.9791506, requires_grad=True), tensor(0.98747744, requires_grad=True), tensor(0.98887804, requires_grad=True)]
&lt;H&gt; =  3.8730616379045375
</pre></div>
</div>
<p>Finally, we don’t need to go through this process manually every time; if our cost function can be
written in the form of an expectation value of a Hamiltonian (as is the case for most VQE and QAOA
problems), we can use the option <code class="docutils literal notranslate"><span class="pre">grouping_type=&quot;qwc&quot;</span></code> in <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="(in PennyLane v0.32)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hamiltonian</span></code></a> to
automatically optimize the measurements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hamiltonian</span></a><span class="p">(</span><span class="n">coeffs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)),</span> <span class="n">observables</span><span class="o">=</span><span class="n">terms</span><span class="p">,</span> <span class="n">grouping_type</span><span class="o">=</span><span class="s2">&quot;qwc&quot;</span><span class="p">)</span>
<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cost_fn</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.StronglyEntanglingLayers.html#pennylane.StronglyEntanglingLayers" title="pennylane.StronglyEntanglingLayers" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">StronglyEntanglingLayers</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cost_fn</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">weights</span></a><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>3.8730616379045375
</pre></div>
</div>
</div>
<div class="section" id="beyond-vqe">
<h2>Beyond VQE<a class="headerlink" href="#beyond-vqe" title="Permalink to this headline">¶</a></h2>
<p>Wait, hang on. We dove so deeply into measurement grouping and optimization, we forgot to check
how this affects the number of measurements required to perform the VQE on <span class="math notranslate nohighlight">\(\text{H}_2 \text{O}\)</span>!
Let’s use our new-found knowledge to see what happens.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.data.Dataset.html#pennylane.data.Dataset" title="pennylane.data.Dataset" class="sphx-glr-backref-module-pennylane-data sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.data.load.html#pennylane.data.load" title="pennylane.data.load" class="sphx-glr-backref-module-pennylane-data sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span></a><span class="p">(</span><span class="s1">&#39;qchem&#39;</span><span class="p">,</span> <span class="n">molname</span><span class="o">=</span><span class="s2">&quot;H2O&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">,</span> <span class="n">num_qubits</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span><span class="o">.</span><span class="n">hamiltonian</span></a><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">dataset</span><span class="o">.</span><span class="n">hamiltonian</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of Hamiltonian terms/required measurements:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.ops" title="pennylane.Hamiltonian.ops" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">ops</span></a><span class="p">))</span>

<span class="c1"># grouping</span>
<span class="n">groups</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.pauli.group_observables.html#pennylane.pauli.group_observables" title="pennylane.pauli.group_observables" class="sphx-glr-backref-module-pennylane-pauli sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">pauli</span><span class="o">.</span><span class="n">group_observables</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.ops" title="pennylane.Hamiltonian.ops" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">ops</span></a><span class="p">,</span> <span class="n">grouping_type</span><span class="o">=</span><span class="s1">&#39;qwc&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;rlf&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of required measurements after optimization:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of Hamiltonian terms/required measurements: 1086
Number of required measurements after optimization: 320
</pre></div>
</div>
<p>We went from 1086 required measurements/circuit evaluations to 320 (just over <em>one thousand</em>
down to <em>three hundred</em> 😱😱😱).</p>
<p>As impressive as this is, however, this is just the beginning of the optimization.</p>
<p>While finding qubit-wise commutating terms is relatively straightforward, with a little
extra computation we can push this number down even further. Recent work has explored
the savings that can be made by considering <em>full</em> commutativity <a class="footnote-reference brackets" href="#yen2020" id="id9">2</a>, unitary
partitioning <a class="footnote-reference brackets" href="#izmaylov2019" id="id10">3</a>, and Fermionic basis rotation grouping <a class="footnote-reference brackets" href="#huggins2019" id="id11">4</a>.
Work has also been performed to reduce the classical overhead associated with measurement
optimization, allowing the classical measurement grouping to be performed in linear time
<a class="footnote-reference brackets" href="#gokhale2020" id="id12">5</a>. For example, recall that qubit-wise commutativity is only a subset of
full commutativity; if we consider full commutativity instead, we can further reduce the
number of groups required.</p>
<p>Finally, it is worth pointing out that, as the field of variational quantum algorithms grows, this
problem of measurement optimization no longer just applies to the VQE algorithm (the algorithm it
was born from). Instead, there are a multitude of algorithms that could benefit from these
measurement optimization techniques (QAOA being a prime example).</p>
<p>So the next time you are working on a variational quantum algorithm and the number
of measurements required begins to explode—stop, take a deep breath 😤, and consider grouping
and optimizing your measurements.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Qubit-wise commuting group information for a wide variety of molecules has been
pre-computed, and is available for download in
in the <a class="reference external" href="https://pennylane.ai/datasets">PennyLane Datasets library</a>.</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="peruzzo2014"><span class="brackets"><a class="fn-backref" href="#id6">1</a></span></dt>
<dd><p>Alberto Peruzzo, Jarrod McClean <em>et al.</em>, “A variational eigenvalue solver on a photonic
quantum processor”. <a class="reference external" href="https://www.nature.com/articles/ncomms5213?origin=ppub">Nature Communications 5, 4213 (2014).</a></p>
</dd>
<dt class="label" id="yen2020"><span class="brackets">2</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id8">2</a>,<a href="#id9">3</a>)</span></dt>
<dd><p>Tzu-Ching Yen, Vladyslav Verteletskyi, and Artur F. Izmaylov. “Measuring all compatible
operators in one series of single-qubit measurements using unitary transformations.” <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.0c00008">Journal of
Chemical Theory and Computation 16.4 (2020): 2400-2409.</a></p>
</dd>
<dt class="label" id="izmaylov2019"><span class="brackets">3</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id10">2</a>)</span></dt>
<dd><p>Artur F. Izmaylov, <em>et al.</em> “Unitary partitioning approach to the measurement problem in the
variational quantum eigensolver method.” <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.9b00791">Journal of Chemical Theory and Computation 16.1 (2019):
190-195.</a></p>
</dd>
<dt class="label" id="huggins2019"><span class="brackets">4</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id11">2</a>)</span></dt>
<dd><p>William J. Huggins, <em>et al.</em> “Efficient and noise resilient measurements for quantum chemistry
on near-term quantum computers.” <a class="reference external" href="https://arxiv.org/abs/1907.13117">arXiv preprint arXiv:1907.13117 (2019).</a></p>
</dd>
<dt class="label" id="gokhale2020"><span class="brackets">5</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id12">2</a>)</span></dt>
<dd><p>Pranav Gokhale, <em>et al.</em> “Minimizing state preparations in variational quantum eigensolver by
partitioning into commuting families.” <a class="reference external" href="https://arxiv.org/abs/1907.13623">arXiv preprint arXiv:1907.13623 (2019).</a></p>
</dd>
<dt class="label" id="verteletskyi2020"><span class="brackets">6</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id7">2</a>)</span></dt>
<dd><p>Vladyslav Verteletskyi, Tzu-Ching Yen, and Artur F. Izmaylov. “Measurement optimization in the
variational quantum eigensolver using a minimum clique cover.” <a class="reference external" href="https://aip.scitation.org/doi/10.1063/1.5141458">The Journal of Chemical Physics
152.12 (2020): 124114.</a></p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/josh_izaac.png" alt="Josh Izaac" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Josh Izaac</h4>
        <p class="bio-text__author-description">Josh is a theoretical physicist, software tinkerer, and occasional baker. At Xanadu, he contributes to the development and growth of Xanadu’s open-source quantum software products.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  34.874 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-measurement-optimize-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/529bf450ed84c07f824766c698ef04ac/tutorial_measurement_optimize.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_measurement_optimize.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/855d1dc3e6e0eaa0a08c3e1d4cab1f4b/tutorial_measurement_optimize.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_measurement_optimize.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_measurement_optimize</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Measurement optimization</a><ul class='current'>
<li class='current'><a class="reference internal" href="#revisiting-vqe">Revisiting VQE</a></li>
<li class='current'><a class="reference internal" href="#the-measurement-problem">The measurement problem</a></li>
<li class='current'><a class="reference internal" href="#simultaneously-measuring-observables">Simultaneously measuring observables</a></li>
<li class='current'><a class="reference internal" href="#qubit-wise-commuting-pauli-terms">Qubit-wise commuting Pauli terms</a></li>
<li class='current'><a class="reference internal" href="#grouping-qwc-terms">Grouping QWC terms</a></li>
<li class='current'><a class="reference internal" href="#putting-it-all-together">Putting it all together</a></li>
<li class='current'><a class="reference internal" href="#beyond-vqe">Beyond VQE</a></li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_measurement_optimize</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_quantum-chemistry.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="vqe_parallel.html" title="VQE with parallel QPUs with Rigetti"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_vqe_spin_sectors.html" title="VQE in different spin sectors"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demos_quantum-chemistry.html" >Quantum Chemistry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Measurement optimization</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>