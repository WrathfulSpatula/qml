
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Learn how to taper off qubits" property="og:description" />
<meta content="https://pennylane.ai/qml/_images/qubit_tapering.png" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Qubit tapering &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_qubit_tapering.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Learn how to taper off qubits" property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Qubit tapering &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_qubit_tapering.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Classically-Boosted Variational Quantum Eigensolver" href="tutorial_classically_boosted_vqe.html" />
    <link rel="prev" title="VQE with parallel QPUs with Rigetti" href="vqe_parallel.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial_classically_boosted_vqe.html" title="Classically-Boosted Variational Quantum Eigensolver"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="vqe_parallel.html" title="VQE with parallel QPUs with Rigetti"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-chemistry.html" accesskey="U">Quantum Chemistry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Qubit tapering</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-demos-tutorial-qubit-tapering-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="qubit-tapering">
<span id="sphx-glr-demos-tutorial-qubit-tapering-py"></span><h1>Qubit tapering<a class="headerlink" href="#qubit-tapering" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = ["tutorial_quantum_chemistry.html", "tutorial_vqe.html", "tutorial_givens_rotations.html", "tutorial_adaptive_circuits.html", "tutorial_differentiable_HF.html"];
    var related_tutorials_titles = ['Building molecular Hamiltonians', 'A brief overview of VQE', 'Givens rotations for quantum chemistry', 'Adaptive circuits for quantum chemistry', 'Differentiable Hartree-Fock'];
</script></p>
<p><em>Authors: Utkarsh Azad and Soran Jahangiri. Posted: 16 May 2022. Last updated: 08 Nov 2022</em></p>
<p>The performance of variational quantum algorithms is considerably limited by the number of qubits
required to represent wave functions. In the context of quantum chemistry, this
limitation hinders the treatment of large molecules with algorithms such as the <a class="reference internal" href="tutorial_vqe.html"><span class="doc">variational quantum
eigensolver (VQE)</span></a>. Several approaches have been developed to reduce the qubit requirements for
quantum chemistry calculations. In this tutorial, we demonstrate the symmetry-based qubit
tapering approach which allows reducing the number of qubits required to perform molecular quantum
simulations based on the <span class="math notranslate nohighlight">\(\mathbb{Z}_2\)</span> symmetries present in molecular Hamiltonians
<a class="footnote-reference brackets" href="#bravyi2017" id="id1">1</a> <a class="footnote-reference brackets" href="#setia2019" id="id2">2</a>.</p>
<p>A molecular Hamiltonian in the qubit basis can be expressed as a linear combination of Pauli words
as</p>
<div class="math notranslate nohighlight">
\[H = \sum_{i=1}^r h_i P_i,\]</div>
<p>where <span class="math notranslate nohighlight">\(h_i\)</span> is a real coefficient and <span class="math notranslate nohighlight">\(P_i\)</span> is a tensor product of Pauli and
identity operators acting on <span class="math notranslate nohighlight">\(M\)</span> qubits</p>
<div class="math notranslate nohighlight">
\[P_i \in \pm \left \{ I, X, Y, Z \right \} ^ {\bigotimes M}.\]</div>
<p>The main idea in the symmetry-based qubit tapering approach is to find a unitary operator <span class="math notranslate nohighlight">\(U\)</span>
that transforms <span class="math notranslate nohighlight">\(H\)</span> to a new Hamiltonian <span class="math notranslate nohighlight">\(H'\)</span> which has the same eigenvalues as
<span class="math notranslate nohighlight">\(H\)</span></p>
<div class="math notranslate nohighlight">
\[H' = U^{\dagger} H U = \sum_{i=1}^r c_i \mu_i,\]</div>
<p>such that each <span class="math notranslate nohighlight">\(\mu_i\)</span> term in the new Hamiltonian always acts trivially, e.g., with an
identity or a Pauli operator, on a set of qubits. This allows tapering-off those qubits from the
Hamiltonian.</p>
<p>For instance, consider the following Hamiltonian</p>
<div class="math notranslate nohighlight">
\[H' = Z_0 X_1 - X_1 + Y_0 X_1,\]</div>
<p>where all terms in the Hamiltonian act on the second qubit with the <span class="math notranslate nohighlight">\(X\)</span> operator. It is
straightforward to show that each term in the Hamiltonian commutes with <span class="math notranslate nohighlight">\(I_0 X_1\)</span> and the
ground-state eigenvector of <span class="math notranslate nohighlight">\(H'\)</span> is also an eigenvector of <span class="math notranslate nohighlight">\(I_0 X_1\)</span> with eigenvalues
<span class="math notranslate nohighlight">\(\pm 1\)</span>. We can also rewrite the Hamiltonian as</p>
<div class="math notranslate nohighlight">
\[H' = (Z_0 I_1 - I_0 I_1 + Y_0 I_1) I_0 X_1,\]</div>
<p>which gives us</p>
<div class="math notranslate nohighlight">
\[H'|\psi \rangle = \pm1 (Z_0 I_1 - I_0 I_1 + Y_0 I_1)|\psi \rangle,\]</div>
<p>where <span class="math notranslate nohighlight">\(|\psi \rangle\)</span> is an eigenvector of <span class="math notranslate nohighlight">\(H'\)</span>. This means that the Hamiltonian
<span class="math notranslate nohighlight">\(H\)</span> can be simplified as</p>
<div class="math notranslate nohighlight">
\[H_{tapered} = \pm1 (Z_0 - I_0 + Y_0).\]</div>
<p>The tapered Hamiltonian <span class="math notranslate nohighlight">\(H_{tapered}\)</span> has the eigenvalues</p>
<div class="math notranslate nohighlight">
\[[-2.41421, 0.41421],\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[[2.41421, -0.41421],\]</div>
<p>depending on the value of the <span class="math notranslate nohighlight">\(\pm 1\)</span> prefactor. The eigenvalues of the original Hamiltonian
<span class="math notranslate nohighlight">\(H\)</span> are</p>
<div class="math notranslate nohighlight">
\[[2.41421, -2.41421,  0.41421, -0.41421],\]</div>
<p>which are thus reproduced by the tapered Hamiltonian.</p>
<p>More generally, we can construct the unitary <span class="math notranslate nohighlight">\(U\)</span> such that each <span class="math notranslate nohighlight">\(\mu_i\)</span> term acts with a
Pauli-X operator on a set of qubits
<span class="math notranslate nohighlight">\(\left \{ j \right \}, j \in \left \{ l, ..., k \right \}\)</span> where <span class="math notranslate nohighlight">\(j\)</span> is the qubit label.
This guarantees that each term of the transformed Hamiltonian commutes with each of the Pauli-X
operators applied to the <span class="math notranslate nohighlight">\(j\)</span>-th qubit:</p>
<div class="math notranslate nohighlight">
\[[H', X^j] = 0,\]</div>
<p>and the eigenvectors of the transformed Hamiltonian <span class="math notranslate nohighlight">\(H'\)</span> are also eigenvectors of each of the
<span class="math notranslate nohighlight">\(X^{j}\)</span> operators. Then we can factor out all of the <span class="math notranslate nohighlight">\(X^{j}\)</span> operators from the
transformed Hamiltonian and replace them with their eigenvalues <span class="math notranslate nohighlight">\(\pm 1\)</span>. This gives us a
set of tapered Hamiltonians depending on which eigenvalue <span class="math notranslate nohighlight">\(\pm 1\)</span> we chose for each of the
<span class="math notranslate nohighlight">\(X^{j}\)</span> operators. For  instance, in the case of two tapered qubits, we have four eigenvalue
sectors: <span class="math notranslate nohighlight">\([+1, +1]\)</span>, <span class="math notranslate nohighlight">\([-1, +1]\)</span>, <span class="math notranslate nohighlight">\([+1, -1]\)</span>, <span class="math notranslate nohighlight">\([-1, -1]\)</span>. In these tapered
Hamiltonians, the set of <span class="math notranslate nohighlight">\(\left \{ j \right \}, j \in \left \{ l, ..., k \right \}\)</span> qubits
are eliminated. For tapered molecular Hamiltonians, it is possible to determine the optimal sector
of the eigenvalues that corresponds to the ground state. This is explained in more detail in the
following sections.</p>
<p>The unitary operator <span class="math notranslate nohighlight">\(U\)</span> can be constructed as a
<a class="reference external" href="https://en.wikipedia.org/wiki/Clifford_gates">Clifford</a> operator <a class="footnote-reference brackets" href="#bravyi2017" id="id3">1</a></p>
<div class="math notranslate nohighlight">
\[U = \Pi_j \left [\frac{1}{\sqrt{2}} \left (X^{q(j)} + \tau_j \right) \right],\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> denotes the generators of the symmetry group of <span class="math notranslate nohighlight">\(H\)</span> and
<span class="math notranslate nohighlight">\(X^{q}\)</span> operators act on those qubits that will be ultimately tapered off from
the Hamiltonian. The symmetry group of the Hamiltonian is defined as an Abelian group of Pauli words that commute
with each term in the Hamiltonian (excluding <span class="math notranslate nohighlight">\(−I\)</span>). The
<a class="reference external" href="https://en.wikipedia.org/wiki/Generating_set_of_a_group">generators</a> of the symmetry group are
those elements of the group that can be combined, along with their inverses, to create any other
member of the group.</p>
<p>Let’s use the qubit tapering method and obtain the ground state energy of the <a class="reference external" href="https://en.wikipedia.org/wiki/Helium_hydride_ion">Helium hydride
cation</a> <span class="math notranslate nohighlight">\(\textrm{HeH}^+\)</span>.</p>
<div class="section" id="tapering-the-molecular-hamiltonian">
<h2>Tapering the molecular Hamiltonian<a class="headerlink" href="#tapering-the-molecular-hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>In PennyLane, a <a class="reference internal" href="tutorial_quantum_chemistry.html"><span class="doc">molecular Hamiltonian</span></a> can be created by specifying the atomic symbols and
coordinates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">from</span> <span class="nn">pennylane</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.00000000</span><span class="p">,</span> <span class="mf">0.00000000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.87818361</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">0.00000000</span><span class="p">,</span> <span class="mf">0.00000000</span><span class="p">,</span>  <span class="mf">0.87818362</span><span class="p">]])</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">,</span> <span class="n">qubits</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.molecular_hamiltonian.html#pennylane.qchem.molecular_hamiltonian" title="pennylane.qchem.molecular_hamiltonian" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">molecular_hamiltonian</span></a><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  (-1.7101641607058446) [I0]
+ (0.2145954888959014) [Z2]
+ (0.2145954888959014) [Z3]
+ (0.7306880119481013) [Z0]
+ (0.7306880119481014) [Z1]
+ (-0.014203509377549517) [Y1 Y3]
+ (-0.014203509377549517) [X1 X3]
+ (0.04383965196887748) [Y0 Y2]
+ (0.04383965196887748) [X0 X2]
+ (0.1179375533255472) [Z0 Z2]
+ (0.1179375533255472) [Z1 Z3]
+ (0.14964510367730144) [Z0 Z3]
+ (0.14964510367730144) [Z1 Z2]
+ (0.18678942625805953) [Z2 Z3]
+ (0.23635644497740252) [Z0 Z1]
+ (0.058043160912773686) [Y0 Z1 Y2]
+ (0.058043160912773686) [X0 Z1 X2]
+ (0.058043160912773686) [Y1 Z2 Y3]
+ (0.058043160912773686) [X1 Z2 X3]
+ (-0.03170755035175426) [Y0 Y1 X2 X3]
+ (-0.03170755035175426) [X0 X1 Y2 Y3]
+ (-0.014203509377549517) [Y0 Z1 Y2 Z3]
+ (-0.014203509377549517) [X0 Z1 X2 Z3]
+ (0.03170755035175426) [Y0 X1 X2 Y3]
+ (0.03170755035175426) [X0 Y1 Y2 X3]
+ (0.04383965196887748) [Z0 Y1 Z2 Y3]
+ (0.04383965196887748) [Z0 X1 Z2 X3]
</pre></div>
</div>
<p>This Hamiltonian contains 27 terms where each term acts on up to four qubits.</p>
<p>We can now obtain the symmetry generators and the <span class="math notranslate nohighlight">\(X^{j}\)</span> operators that are
used to construct the unitary <span class="math notranslate nohighlight">\(U\)</span> operator that transforms the <span class="math notranslate nohighlight">\(\textrm{HeH}^+\)</span>
Hamiltonian. In PennyLane, these are constructed by using the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.symmetry_generators.html#pennylane.symmetry_generators" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">symmetry_generators()</span></code></a> and <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.paulix_ops.html#pennylane.paulix_ops" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">paulix_ops()</span></code></a> functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">generators</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.symmetry_generators.html#pennylane.symmetry_generators" title="pennylane.symmetry_generators" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">symmetry_generators</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">)</span>
<span class="n">paulixops</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.paulix_ops.html#pennylane.paulix_ops" title="pennylane.paulix_ops" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">paulix_ops</span></a><span class="p">(</span><span class="n">generators</span><span class="p">,</span> <span class="n">qubits</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">generator</span></a> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">generators</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;generator </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">generator</span></a><span class="si">}</span><span class="s2">, paulix_op: </span><span class="si">{</span><span class="n">paulixops</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/qml/qml/venv/lib/python3.9/site-packages/pennylane/operation.py:1921: UserWarning: Tensor object acts on overlapping wires; in some PennyLane functions this will lead to undefined behaviour
  warnings.warn(
/home/runner/work/qml/qml/venv/lib/python3.9/site-packages/pennylane/operation.py:2111: UserWarning: Tensor object acts on overlapping wires; in some PennyLane functions this will lead to undefined behaviour
  warnings.warn(
generator 1:   (1.0) [Z0 Z2], paulix_op: PauliX(wires=[2])
generator 2:   (1.0) [Z1 Z3], paulix_op: PauliX(wires=[3])
</pre></div>
</div>
<p>Once the operator <span class="math notranslate nohighlight">\(U\)</span> is applied, each of the Hamiltonian terms will act on the qubits
<span class="math notranslate nohighlight">\(q_2, q_3\)</span> either with the identity or with a Pauli-X operator. For each of these qubits,
we can simply replace the Pauli-X operator with one of its eigenvalues <span class="math notranslate nohighlight">\(+1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span>.
This results in a total number of <span class="math notranslate nohighlight">\(2^k\)</span> Hamiltonians, where <span class="math notranslate nohighlight">\(k\)</span> is the number of
tapered-off qubits and each Hamiltonian corresponds to one eigenvalue sector. The optimal sector
corresponding to the ground-state energy of the molecule can be obtained by using the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.optimal_sector.html#pennylane.qchem.optimal_sector" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimal_sector()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_electrons</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">paulix_sector</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.optimal_sector.html#pennylane.qchem.optimal_sector" title="pennylane.qchem.optimal_sector" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">optimal_sector</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">,</span> <span class="n">generators</span><span class="p">,</span> <span class="n">n_electrons</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">paulix_sector</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-1, -1]
</pre></div>
</div>
<p>The optimal eigenvalues are <span class="math notranslate nohighlight">\(-1, -1\)</span> for qubits <span class="math notranslate nohighlight">\(q_2, q_3\)</span>, respectively. We can now
build the tapered Hamiltonian with the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.taper.html#pennylane.taper" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">taper()</span></code></a> function which
constructs the operator <span class="math notranslate nohighlight">\(U\)</span>, applies it to the Hamiltonian and finally tapers off the
qubits <span class="math notranslate nohighlight">\(q_2, q_3\)</span> by replacing the Pauli-X operators acting on those qubits with the optimal
eigenvalues.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H_tapered</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.taper.html#pennylane.taper" title="pennylane.taper" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">taper</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a><span class="p">,</span> <span class="n">generators</span><span class="p">,</span> <span class="n">paulixops</span><span class="p">,</span> <span class="n">paulix_sector</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H_tapered</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  ((-1.946039267356938+0j)) [I0]
+ ((-0.11608632269285395+0j)) [X0]
+ ((0.11608632269285395+0j)) [X1]
+ ((0.5160925230521998+0j)) [Z0]
+ ((0.5160925230521999+0j)) [Z1]
+ ((-0.12683020140701698+0j)) [Y0 Y1]
+ ((-0.11608632182554732+0j)) [X0 Z1]
+ ((0.11608632182554732+0j)) [Z0 X1]
+ ((0.12385566388085911+0j)) [Z0 Z1]
</pre></div>
</div>
<p>The new Hamiltonian has only 9 non-zero terms acting on only 2 qubits! We can verify that the
original and the tapered Hamiltonian both give the correct ground state energy of the
<span class="math notranslate nohighlight">\(\textrm{HeH}^+\)</span> cation, which is <span class="math notranslate nohighlight">\(-2.862595242378\)</span> Ha computed with the full
configuration interaction (FCI) method. In PennyLane, it’s possible to build a sparse matrix
representation of Hamiltonians. This allows us to directly diagonalize them to obtain exact values
of the ground-state energies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.SparseHamiltonian.html#pennylane.SparseHamiltonian" title="pennylane.SparseHamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H_sparse</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.SparseHamiltonian.html#pennylane.SparseHamiltonian" title="pennylane.SparseHamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">SparseHamiltonian</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.sparse_matrix" title="pennylane.Hamiltonian.sparse_matrix" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-method"><span class="n">H</span><span class="o">.</span><span class="n">sparse_matrix</span></a><span class="p">(),</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.SparseHamiltonian.html#pennylane.SparseHamiltonian" title="pennylane.SparseHamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H_tapered_sparse</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.SparseHamiltonian.html#pennylane.SparseHamiltonian" title="pennylane.SparseHamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">SparseHamiltonian</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.sparse_matrix" title="pennylane.Hamiltonian.sparse_matrix" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-method"><span class="n">H_tapered</span><span class="o">.</span><span class="n">sparse_matrix</span></a><span class="p">(),</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H_tapered</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eigenvalues of H:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.op_transform.html#pennylane.op_transform" title="pennylane.op_transform" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qml</span><span class="o">.</span><span class="n">eigvals</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.SparseHamiltonian.html#pennylane.SparseHamiltonian" title="pennylane.SparseHamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H_sparse</span></a><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">16</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Eigenvalues of H_tapered:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.op_transform.html#pennylane.op_transform" title="pennylane.op_transform" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qml</span><span class="o">.</span><span class="n">eigvals</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.SparseHamiltonian.html#pennylane.SparseHamiltonian" title="pennylane.SparseHamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H_tapered_sparse</span></a><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Eigenvalues of H:
 [-3.12541987 -3.12541987 -2.86259524 -2.64241998 -2.19672513 -2.19672513
 -2.19672513 -2.18547545 -2.18547545 -2.02874709 -1.35709798 -1.35709798
 -0.69608961 -0.17266334 -0.17266334  1.13871403]

Eigenvalues of H_tapered:
 [-2.86259524 -2.19672513 -2.02874709 -0.69608961]
</pre></div>
</div>
</div>
<div class="section" id="tapering-the-reference-state">
<h2>Tapering the reference state<a class="headerlink" href="#tapering-the-reference-state" title="Permalink to this headline">¶</a></h2>
<p>The ground state Hartree-Fock energy of <span class="math notranslate nohighlight">\(\textrm{HeH}^+\)</span> can be computed by directly
applying the Hamiltonians to the Hartree-Fock state. For the tapered Hamiltonian, this requires
transforming the Hartree-Fock state with the same symmetries obtained for the original
Hamiltonian. This reduces the number of qubits in the Hartree-Fock state to match that of the
tapered Hamiltonian. It can be done with the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.taper_hf.html#pennylane.qchem.taper_hf" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">taper_hf()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">state_tapered</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.taper_hf.html#pennylane.qchem.taper_hf" title="pennylane.qchem.taper_hf" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">taper_hf</span></a><span class="p">(</span><span class="n">generators</span><span class="p">,</span> <span class="n">paulixops</span><span class="p">,</span> <span class="n">paulix_sector</span><span class="p">,</span>
                                   <span class="n">num_electrons</span><span class="o">=</span><span class="n">n_electrons</span><span class="p">,</span> <span class="n">num_wires</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">wires</span></a><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">state_tapered</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[1 1]
</pre></div>
</div>
<p>Recall that the original Hartree-Fock state for the <span class="math notranslate nohighlight">\(\textrm{HeH}^+\)</span> cation is
<span class="math notranslate nohighlight">\([1 1 0 0]\)</span>. We can now generate the qubit representation of these states and compute the
Hartree-Fock energies for each Hamiltonian.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit</span><span class="p">():</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisState.html#pennylane.BasisState" title="pennylane.BasisState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisState</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.state.html#pennylane.state" title="pennylane.state" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">state</span></a><span class="p">()</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qubit_state</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit</span></a><span class="p">()</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">HF_energy</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qubit_state</span><span class="o">.</span><span class="n">T</span></a> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.sparse_matrix" title="pennylane.Hamiltonian.sparse_matrix" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-method"><span class="n">H</span><span class="o">.</span><span class="n">sparse_matrix</span></a><span class="p">()</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qubit_state</span></a>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HF energy: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">HF_energy</span></a><span class="p">)</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2"> Ha&quot;</span><span class="p">)</span>

<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H_tapered</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit</span><span class="p">():</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisState.html#pennylane.BasisState" title="pennylane.BasisState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisState</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H_tapered</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.state.html#pennylane.state" title="pennylane.state" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">state</span></a><span class="p">()</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qubit_state</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit</span></a><span class="p">()</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">HF_energy</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qubit_state</span><span class="o">.</span><span class="n">T</span></a> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.sparse_matrix" title="pennylane.Hamiltonian.sparse_matrix" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-method"><span class="n">H_tapered</span><span class="o">.</span><span class="n">sparse_matrix</span></a><span class="p">()</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span> <span class="o">@</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qubit_state</span></a>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HF energy (tapered): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">HF_energy</span></a><span class="p">)</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2"> Ha&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>HF energy: -2.85436865 Ha
HF energy (tapered): -2.85436865 Ha
</pre></div>
</div>
<p>These values are identical to the reference Hartree-Fock energy <span class="math notranslate nohighlight">\(-2.8543686493\)</span> Ha.</p>
</div>
<div class="section" id="vqe-simulation">
<h2>VQE simulation<a class="headerlink" href="#vqe-simulation" title="Permalink to this headline">¶</a></h2>
<p>Finally, we can use the tapered Hamiltonian and the tapered reference state to perform a VQE
simulation and compute the ground-state energy of the <span class="math notranslate nohighlight">\(\textrm{HeH}^+\)</span> cation. We build a
tapered variational ansatz <a class="reference external" href="https://pennylane.ai/qml/demos/tutorial_givens_rotations.html">[3]</a>
that prepares an entangled state by evolving the tapered Hartree-Fock state using the tapered
particle-conserving gates, i.e., the <code class="xref py py-func docutils literal notranslate"><span class="pre">SingleExcitation()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">DoubleExcitation()</span></code> operations tapered using
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.taper_operation.html#pennylane.qchem.taper_operation" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">taper_operation()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">singles</span><span class="p">,</span> <span class="n">doubles</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.excitations.html#pennylane.qchem.excitations" title="pennylane.qchem.excitations" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">excitations</span></a><span class="p">(</span><span class="n">n_electrons</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">wires</span></a><span class="p">))</span>
<span class="n">tapered_doubles</span> <span class="o">=</span> <span class="p">[</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.taper_operation.html#pennylane.taper_operation" title="pennylane.taper_operation" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">taper_operation</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.DoubleExcitation.html#pennylane.DoubleExcitation" title="pennylane.DoubleExcitation" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">DoubleExcitation</span></a><span class="p">,</span> <span class="n">generators</span><span class="p">,</span> <span class="n">paulixops</span><span class="p">,</span> <span class="n">paulix_sector</span><span class="p">,</span>
                        <span class="n">wire_order</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">wires</span></a><span class="p">,</span> <span class="n">op_wires</span><span class="o">=</span><span class="n">double</span><span class="p">)</span> <span class="k">for</span> <span class="n">double</span> <span class="ow">in</span> <span class="n">doubles</span>
<span class="p">]</span>
<span class="n">tapered_singles</span> <span class="o">=</span> <span class="p">[</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.taper_operation.html#pennylane.taper_operation" title="pennylane.taper_operation" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">taper_operation</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.SingleExcitation.html#pennylane.SingleExcitation" title="pennylane.SingleExcitation" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">SingleExcitation</span></a><span class="p">,</span> <span class="n">generators</span><span class="p">,</span> <span class="n">paulixops</span><span class="p">,</span> <span class="n">paulix_sector</span><span class="p">,</span>
                        <span class="n">wire_order</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">wires</span></a><span class="p">,</span> <span class="n">op_wires</span><span class="o">=</span><span class="n">single</span><span class="p">)</span> <span class="k">for</span> <span class="n">single</span> <span class="ow">in</span> <span class="n">singles</span>
<span class="p">]</span>

<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H_tapered</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">tapered_circuit</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisState.html#pennylane.BasisState" title="pennylane.BasisState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisState</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">state_tapered</span></a><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.wires" title="pennylane.Hamiltonian.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H_tapered</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tapered_op</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tapered_doubles</span> <span class="o">+</span> <span class="n">tapered_singles</span><span class="p">):</span>
        <span class="n">tapered_op</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H_tapered</span></a><span class="p">)</span>
</pre></div>
</div>
<p>We define an optimizer and the initial values of the circuit parameters and optimize the circuit
parameters with respect to the ground state energy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.GradientDescentOptimizer.html#pennylane.GradientDescentOptimizer" title="pennylane.GradientDescentOptimizer" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">optimizer</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.GradientDescentOptimizer.html#pennylane.GradientDescentOptimizer" title="pennylane.GradientDescentOptimizer" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span></a><span class="p">(</span><span class="n">stepsize</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doubles</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">singles</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">,</span> <span class="n">energy</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.GradientDescentOptimizer.html#pennylane.GradientDescentOptimizer.step_and_cost" title="pennylane.GradientDescentOptimizer.step_and_cost" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-method"><span class="n">optimizer</span><span class="o">.</span><span class="n">step_and_cost</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tapered_circuit</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, E: </span><span class="si">{</span><span class="n">energy</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2"> Ha, Params: </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">params</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>n: 5, E: -2.86236975 Ha, Params: [ 0.12087368  0.01627666 -0.01627666]
n: 10, E: -2.86256772 Ha, Params: [ 0.12687479  0.02808328 -0.02808328]
n: 15, E: -2.86259160 Ha, Params: [ 0.12820847  0.03248734 -0.03248734]
n: 20, E: -2.86259476 Ha, Params: [ 0.12867238  0.03409235 -0.03409235]
n: 25, E: -2.86259518 Ha, Params: [ 0.12884045  0.03467702 -0.03467702]
n: 30, E: -2.86259523 Ha, Params: [ 0.12890162  0.03489005 -0.03489005]
n: 35, E: -2.86259524 Ha, Params: [ 0.1289239   0.03496769 -0.03496769]
n: 40, E: -2.86259524 Ha, Params: [ 0.12893201  0.03499598 -0.03499598]
</pre></div>
</div>
<p>The computed energy matches the FCI energy, <span class="math notranslate nohighlight">\(-2.862595242378\)</span> Ha, while the number of qubits
and the number of Hamiltonian terms are significantly reduced with respect to their original
values.</p>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<p>Molecular Hamiltonians possess symmetries that can be leveraged to reduce the number of qubits
required in quantum computing simulations. This tutorial introduces a PennyLane functionality that
can be used for qubit tapering based on <span class="math notranslate nohighlight">\(\mathbb{Z}_2\)</span> symmetries. The procedure includes
obtaining tapered Hamiltonians and tapered reference states that can be used in variational
quantum algorithms such as VQE.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="bravyi2017"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Sergey Bravyi, Jay M. Gambetta, Antonio Mezzacapo, Kristan Temme, “Tapering off qubits to
simulate fermionic Hamiltonians”. <a class="reference external" href="https://arxiv.org/abs/1701.08213">arXiv:1701.08213</a></p>
</dd>
<dt class="label" id="setia2019"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Kanav Setia, Richard Chen, Julia E. Rice, Antonio Mezzacapo, Marco Pistoia, James Whitfield,
“Reducing qubit requirements for quantum simulation using molecular point group symmetries”.
<a class="reference external" href="https://arxiv.org/abs/1910.14644">arXiv:1910.14644</a></p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/utkarsh_azad.png" alt="Utkarsh Azad" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Utkarsh Azad</h4>
        <p class="bio-text__author-description">Utkarsh is a quantum software researcher at Xanadu, working on making quantum computing more useful and accessible, with a focus on exploring its applications in natural sciences. Whenever he's not tinkering with code, he will be walking miles searching either for fractals in nature or a cup of filter coffee.</p>
    </div>
</div><div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/soran_jahangiri.png" alt="Soran Jahangiri" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Soran Jahangiri</h4>
        <p class="bio-text__author-description">Soran Jahangiri is a quantum chemist working at Xanadu. His work is focused on developing and implementing quantum algorithms for chemistry applications.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.742 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-qubit-tapering-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/e0f94e17902e21b08dd0528554c5e41e/tutorial_qubit_tapering.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_qubit_tapering.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/2f9cd70e4a7d86da42904a77ec881c1b/tutorial_qubit_tapering.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_qubit_tapering.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_qubit_tapering</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Qubit tapering</a><ul class='current'>
<li class='current'><a class="reference internal" href="#tapering-the-molecular-hamiltonian">Tapering the molecular Hamiltonian</a></li>
<li class='current'><a class="reference internal" href="#tapering-the-reference-state">Tapering the reference state</a></li>
<li class='current'><a class="reference internal" href="#vqe-simulation">VQE simulation</a></li>
<li class='current'><a class="reference internal" href="#conclusions">Conclusions</a></li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_qubit_tapering</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_quantum-chemistry.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial_classically_boosted_vqe.html" title="Classically-Boosted Variational Quantum Eigensolver"
             >next</a> |</li>
        <li class="right" >
          <a href="vqe_parallel.html" title="VQE with parallel QPUs with Rigetti"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-chemistry.html" >Quantum Chemistry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Qubit tapering</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>