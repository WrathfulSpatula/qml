
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Learn how to estimate the number of qubits and gates needed to implement quantum algorithms" property="og:description" />
<meta content="https://pennylane.ai/qml/_images/resource_estimation.jpeg" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Resource estimation for quantum chemistry &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_resource_estimation.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Learn how to estimate the number of qubits and gates needed to implement quantum algorithms" property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Resource estimation for quantum chemistry &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_resource_estimation.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Optimization" href="../demos_optimization.html" />
    <link rel="prev" title="Using PennyLane with PySCF and OpenFermion" href="tutorial_qchem_external.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../demos_optimization.html" title="Optimization"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_qchem_external.html" title="Using PennyLane with PySCF and OpenFermion"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demos_quantum-chemistry.html" accesskey="U">Quantum Chemistry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Resource estimation for quantum chemistry</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-demos-tutorial-resource-estimation-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="resource-estimation-for-quantum-chemistry">
<span id="sphx-glr-demos-tutorial-resource-estimation-py"></span><h1>Resource estimation for quantum chemistry<a class="headerlink" href="#resource-estimation-for-quantum-chemistry" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = ["tutorial_quantum_chemistry.html", "tutorial_vqe.html"];
    var related_tutorials_titles = ['Quantum chemistry with PennyLane', 'A brief overview of VQE'];
</script></p>
<p><em>Author: Soran Jahangiri — Posted: 21 November 2022.</em></p>
<p>Quantum algorithms such as
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QuantumPhaseEstimation.html">quantum phase estimation</a>
(QPE) and the <a class="reference external" href="https://pennylane.ai/qml/demos/tutorial_vqe.html">variational quantum eigensolver</a> (VQE)
are widely studied in quantum chemistry as potential avenues to tackle problems that are intractable
for conventional computers. However, we currently do not have quantum computers or simulators
capable of implementing large-scale
versions of these algorithms. This makes it difficult to properly explore their accuracy and
efficiency for problem sizes where the actual advantage of quantum algorithms can potentially occur.
Despite these difficulties, it is still possible to perform <strong>resource estimation</strong>
to assess what we need to implement such quantum algorithms.</p>
<p>In this demo, we describe how to use PennyLane’s resource estimation functionality to estimate the total number of logical qubits and gates required to
implement the QPE algorithm for simulating molecular Hamiltonians represented in first and second
quantization. We focus on <a class="reference external" href="https://en.wikipedia.org/wiki/Clifford_gates">non-Clifford gates</a>, which
are the most expensive to implement in a fault-tolerant setting. We also explain how to estimate the
total number of measurements needed to compute expectation values using algorithms such as VQE.</p>
<div class="section" id="id1">
<h2>Quantum Phase Estimation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The QPE algorithm can be used to compute the phase associated with an eigenstate of a unitary
operator. For the purpose of quantum simulation, the unitary operator <span class="math notranslate nohighlight">\(U\)</span> can be chosen to
share eigenvectors with a molecular Hamiltonian <span class="math notranslate nohighlight">\(H\)</span>, for example by setting
<span class="math notranslate nohighlight">\(U = e^{-iH}\)</span>. Estimating the phase of such a unitary then permits recovering the
corresponding eigenvalue of the Hamiltonian. A conceptual QPE circuit diagram is shown below.</p>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="../_images/qpe.png"><img alt="../_images/qpe.png" src="../_images/qpe.png" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text">Circuit representing the quantum phase estimation algorithm.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>For most cases of interest, this algorithm requires more qubits and longer circuit depths than what
can be implemented on existing hardware. The PennyLane functionality in the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/qml_resource.html#module-pennylane.resource" title="(in PennyLane v0.31)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qml.resource</span></code></a> module allows us to estimate the number of logical qubits
and the number of non-Clifford gates that are needed to implement the algorithm. We can estimate
these resources by simply defining system specifications and a target error for estimation. Let’s
see how!</p>
<div class="section" id="qpe-cost-for-simulating-molecules">
<h3>QPE cost for simulating molecules<a class="headerlink" href="#qpe-cost-for-simulating-molecules" title="Permalink to this headline">¶</a></h3>
<p>We study the double low-rank Hamiltonian factorization algorithm of <a class="footnote-reference brackets" href="#vonburg2021" id="id2">1</a> and use its cost
equations as provided in APPENDIX C of <a class="footnote-reference brackets" href="#lee2021" id="id3">2</a>.
This algorithm requires the one- and two-electron
<a class="reference external" href="https://pennylane.ai/qml/demos/tutorial_differentiable_HF.html#the-hartree-fock-method">integrals</a>
as input. These integrals can be obtained in different ways and here we use PennyLane to compute
them. We first need to define the atomic symbols and coordinates for the given molecule. Let’s use
the water molecule at its equilibrium geometry with the
<a class="reference external" href="https://en.wikipedia.org/wiki/Basis_set_(chemistry)">6-31g basis set</a> as an example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">from</span> <span class="nn">pennylane</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.00000000</span><span class="p">,</span>  <span class="mf">0.00000000</span><span class="p">,</span>  <span class="mf">0.28377432</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">0.00000000</span><span class="p">,</span>  <span class="mf">1.45278171</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.00662237</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">0.00000000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.45278171</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.00662237</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we construct a molecule object and compute the one- and two-electron
integrals in the molecular orbital basis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">Molecule</span></a><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">,</span> <span class="n">basis_name</span><span class="o">=</span><span class="s1">&#39;6-31g&#39;</span><span class="p">)</span>
<span class="n">core</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">two</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.electron_integrals.html#pennylane.qchem.electron_integrals" title="pennylane.qchem.electron_integrals" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">electron_integrals</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">)()</span>
</pre></div>
</div>
<p>We now create an instance of the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.DoubleFactorization.html#pennylane.resource.DoubleFactorization" title="(in PennyLane v0.31)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DoubleFactorization</span></code></a> class</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.DoubleFactorization.html#pennylane.resource.DoubleFactorization" title="pennylane.resource.DoubleFactorization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">DoubleFactorization</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">two</span></a><span class="p">)</span>
</pre></div>
</div>
<p>and obtain the estimated number of non-Clifford gates and logical qubits.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimated gates : </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a><span class="o">.</span><span class="n">gates</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">Estimated qubits: </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a><span class="o">.</span><span class="n">qubits</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Estimated gates : 3.06e+08
Estimated qubits: 693
</pre></div>
</div>
<p>This estimation is for a target error that is set to the chemical accuracy, 0.0016
<span class="math notranslate nohighlight">\(\text{Ha}\)</span>, by default. We can change the target error to a larger value which leads to a
smaller number of non-Clifford gates and logical qubits.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chemical_accuracy</span> <span class="o">=</span> <span class="mf">0.0016</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a> <span class="o">=</span> <span class="n">chemical_accuracy</span> <span class="o">*</span> <span class="mi">10</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.DoubleFactorization.html#pennylane.resource.DoubleFactorization" title="pennylane.resource.DoubleFactorization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">DoubleFactorization</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">two</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimated gates : </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a><span class="o">.</span><span class="n">gates</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">Estimated qubits: </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a><span class="o">.</span><span class="n">qubits</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Estimated gates : 3.06e+07
Estimated qubits: 685
</pre></div>
</div>
<p>We can also estimate the number of non-Clifford gates with respect to the threshold error values
for discarding the negligible factors in the factorized Hamiltonian <a class="footnote-reference brackets" href="#vonburg2021" id="id4">1</a> and plot the
estimated numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="o">**-</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">n_gates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n_qubits</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">tol</span> <span class="ow">in</span> <span class="n">threshold</span><span class="p">:</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo_</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.DoubleFactorization.html#pennylane.resource.DoubleFactorization" title="pennylane.resource.DoubleFactorization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">DoubleFactorization</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">one</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">two</span></a><span class="p">,</span> <span class="n">tol_factor</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">tol_eigval</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
    <span class="n">n_gates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo_</span></a><span class="o">.</span><span class="n">gates</span><span class="p">)</span>
    <span class="n">n_qubits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo_</span></a><span class="o">.</span><span class="n">qubits</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="n">n_gates</span><span class="p">,</span> <span class="s1">&#39;:o&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;n gates&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_resource_estimation_001.png" srcset="../_images/sphx_glr_tutorial_resource_estimation_001.png" alt="tutorial resource estimation" class = "sphx-glr-single-img"/></div>
<div class="section" id="qpe-cost-for-simulating-periodic-materials">
<h3>QPE cost for simulating periodic materials<a class="headerlink" href="#qpe-cost-for-simulating-periodic-materials" title="Permalink to this headline">¶</a></h3>
<p>For periodic materials, we estimate the cost of implementing the QPE algorithm of <a class="footnote-reference brackets" href="#zini2023" id="id5">3</a>
using Hamiltonians represented in first quantization and in a plane wave basis. We first need to
define the number of plane waves, the number of electrons, and the lattice vectors that construct
the unit cell of the periodic material. Let’s use dilithium iron silicate
<span class="math notranslate nohighlight">\(\text{Li}_2\text{FeSiO}_4\)</span> as an example taken from <a class="footnote-reference brackets" href="#delgado2022" id="id6">4</a>. For this material, the
unit cell contains 156 electrons and has dimensions <span class="math notranslate nohighlight">\(9.49 \times 10.20 \times 11.83\)</span> in
<a class="reference external" href="https://en.wikipedia.org/wiki/Bohr_radius">atomic units</a>. We also use <span class="math notranslate nohighlight">\(10^5\)</span> plane waves.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">planewaves</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">electrons</span> <span class="o">=</span> <span class="mi">156</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vectors</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">9.49</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">10.20</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span>  <span class="mf">0.00</span><span class="p">,</span> <span class="mf">11.83</span><span class="p">]])</span>
</pre></div>
</div>
<p>We now create an instance of the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="(in PennyLane v0.31)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FirstQuantization</span></code></a> class</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">FirstQuantization</span></a><span class="p">(</span><span class="n">planewaves</span><span class="p">,</span> <span class="n">electrons</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vectors</span></a><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vectors</span></a><span class="p">)</span>
</pre></div>
</div>
<p>and obtain the estimated number of non-Clifford gates and logical qubits.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimated gates : </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a><span class="o">.</span><span class="n">gates</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">Estimated qubits: </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span></a><span class="o">.</span><span class="n">qubits</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Estimated gates : 1.42e+14
Estimated qubits: 3331
</pre></div>
</div>
<p>We can also plot the estimated numbers as a function of the number of plane waves for different
target errors</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">]</span>  <span class="c1"># in atomic units</span>
<span class="n">planewaves</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span> <span class="o">**</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
<span class="n">n_gates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n_qubits</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">er</span> <span class="ow">in</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">:</span>
    <span class="n">n_gates_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_qubits_</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pw</span> <span class="ow">in</span> <span class="n">planewaves</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo_</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">FirstQuantization</span></a><span class="p">(</span><span class="n">pw</span><span class="p">,</span> <span class="n">electrons</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vectors</span></a><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vectors</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="o">=</span><span class="n">er</span><span class="p">)</span>
        <span class="n">n_gates_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo_</span></a><span class="o">.</span><span class="n">gates</span><span class="p">)</span>
        <span class="n">n_qubits_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="pennylane.resource.FirstQuantization" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo_</span></a><span class="o">.</span><span class="n">qubits</span><span class="p">)</span>
    <span class="n">n_gates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_gates_</span><span class="p">)</span>
    <span class="n">n_qubits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_qubits_</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_gates</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">planewaves</span><span class="p">,</span> <span class="n">n_gates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;:o&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">planewaves</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;:o&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;n gates&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;n qubits&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n planewaves&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;error [Ha]&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_resource_estimation_002.png" srcset="../_images/sphx_glr_tutorial_resource_estimation_002.png" alt="tutorial resource estimation" class = "sphx-glr-single-img"/><p>The algorithm uses a decomposition of the Hamiltonian as a linear combination of unitaries,</p>
<div class="math notranslate nohighlight">
\[H=\sum_{i} c_i U_i.\]</div>
<p>The parameter <span class="math notranslate nohighlight">\(\lambda=\sum_i c_i\)</span>, which can be interpreted as the 1-norm of the
Hamiltonian, plays an important role in determining the cost of implementing the QPE
algorithm <a class="footnote-reference brackets" href="#delgado2022" id="id7">4</a>. In PennyLane, the 1-norm of the Hamiltonian can be obtained with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;1-norm of the Hamiltonian: </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">algo</span><span class="o">.</span><span class="n">lamb</span></a><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1-norm of the Hamiltonian: 764382.7344833747
</pre></div>
</div>
<p>PennyLane allows you to get more detailed information about the cost of the algorithms as
explained in the documentation of <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.FirstQuantization.html#pennylane.resource.FirstQuantization" title="(in PennyLane v0.31)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FirstQuantization</span></code></a>
and <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.DoubleFactorization.html#pennylane.resource.DoubleFactorization" title="(in PennyLane v0.31)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DoubleFactorization</span></code></a> classes.</p>
</div>
</div>
<div class="section" id="id8">
<h2>Variational quantum eigensolver<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>In variational quantum algorithms such as VQE, the expectation value of an observable is
typically computed by decomposing the observable into a linear combination of Pauli words,
which are tensor products of Pauli and Identity operators. The expectation values are calculated
through linearity by measuring the expectation value for each of these terms and combining the
results. The number of qubits required for the measurement is trivially determined by
the number of qubits the observable acts on. The number of gates required to implement the
variational algorithm is determined by a circuit ansatz that is also known a priori. However,
estimating the number of circuit evaluations, i.e. the number of shots, required to achieve a
certain error in computing the expectation value is not as straightforward. Let’s now use
PennyLane to estimate the number of shots needed to compute the expectation value of the water
Hamiltonian.</p>
<p>First, we construct the molecular Hamiltonian.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">H</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.molecular_hamiltonian.html#pennylane.qchem.molecular_hamiltonian" title="pennylane.qchem.molecular_hamiltonian" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">molecular_hamiltonian</span></a><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>The number of measurements needed to compute <span class="math notranslate nohighlight">\(\left \langle H \right \rangle\)</span> can be
obtained with the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.estimate_shots.html#pennylane.resource.estimate_shots" title="(in PennyLane v0.31)"><code class="xref py py-func docutils literal notranslate"><span class="pre">estimate_shots()</span></code></a> function, which requires the
Hamiltonian coefficients as input. The number of measurements required to compute
<span class="math notranslate nohighlight">\(\left \langle H \right \rangle\)</span> with a target error set to the chemical accuracy, 0.0016
<span class="math notranslate nohighlight">\(\text{Ha}\)</span>, is obtained as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.estimate_shots.html#pennylane.resource.estimate_shots" title="pennylane.resource.estimate_shots" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">estimate_shots</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.coeffs" title="pennylane.Hamiltonian.coeffs" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">coeffs</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shots : </span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Shots : 5.49e+09
</pre></div>
</div>
<p>This number corresponds to the measurement process where each term in the Hamiltonian is measured
independently. The number can be reduced by using
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.pauli.group_observables.html#pennylane.pauli.group_observables" title="(in PennyLane v0.31)"><code class="xref py py-func docutils literal notranslate"><span class="pre">group_observables()</span></code></a>, which partitions the Pauli words into
groups of commuting terms that can be measured simultaneously.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ops</span><span class="p">,</span> <span class="n">coeffs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.pauli.group_observables.html#pennylane.pauli.group_observables" title="pennylane.pauli.group_observables" class="sphx-glr-backref-module-pennylane-pauli sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">pauli</span><span class="o">.</span><span class="n">group_observables</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.ops" title="pennylane.Hamiltonian.ops" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">ops</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.coeffs" title="pennylane.Hamiltonian.coeffs" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">coeffs</span></a><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.estimate_shots.html#pennylane.resource.estimate_shots" title="pennylane.resource.estimate_shots" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">estimate_shots</span></a><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shots : </span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Shots : 2.37e+09
</pre></div>
</div>
<p>It is also interesting to illustrate how the number of shots depends on the target error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">])</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">[</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.resource.estimate_shots.html#pennylane.resource.estimate_shots" title="pennylane.resource.estimate_shots" class="sphx-glr-backref-module-pennylane-resource sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">estimate_shots</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian.coeffs" title="pennylane.Hamiltonian.coeffs" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">H</span><span class="o">.</span><span class="n">coeffs</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="o">=</span><span class="n">er</span><span class="p">)</span> <span class="k">for</span> <span class="n">er</span> <span class="ow">in</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">]</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">e_</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m_</span></a> <span class="o">=</span> <span class="mf">1.4e4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">error</span></a><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;estimated&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">e_</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m_</span></a><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$ 1.4e4 * 1/\epsilon^2 $&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;shots&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;error [Ha]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_resource_estimation_003.png" srcset="../_images/sphx_glr_tutorial_resource_estimation_003.png" alt="tutorial resource estimation" class = "sphx-glr-single-img"/><p>We have added a line showing the dependency of the shots to the error, as
<span class="math notranslate nohighlight">\(\text{shots} = 1.4\text{e}4 \times 1/\epsilon^2\)</span>, for comparison. Can you draw any
interesting information form the plot?</p>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<p>This tutorial shows how to use the resource estimation functionality in PennyLane to compute the
total number of non-Clifford gates and logical qubits required to simulate a Hamiltonian with
quantum phase estimation algorithms. The estimation can be performed for second-quantized
molecular Hamiltonians obtained with a double low-rank factorization algorithm,
and first-quantized Hamiltonians of periodic materials in the plane wave basis. We also discussed
the estimation of the total number of shots required to obtain the expectation value of an
observable using the variational quantum eigensolver algorithm. The functionality allows one to
obtain interesting results about the cost of implementing important quantum algorithms. For
instance, we estimated the costs with respect to factors such as the target error in obtaining
energies and the number of basis functions used to simulate a system. Can you think of other
interesting information that can be obtained using this PennyLane functionality?</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="vonburg2021"><span class="brackets">1</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id4">2</a>)</span></dt>
<dd><p>Vera von Burg, Guang Hao Low, Thomas Haner, Damian S. Steiger, <em>et al.</em>,
“Quantum computing enhanced computational catalysis”.
<a class="reference external" href="https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.3.033055">Phys. Rev. Research 3, 033055 (2021)</a></p>
</dd>
<dt class="label" id="lee2021"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>Joonho Lee, Dominic W. Berry, Craig Gidney, William J. Huggins, <em>et al.</em>,
“Even More Efficient Quantum Computations of Chemistry Through Tensor Hypercontraction”.
<a class="reference external" href="https://journals.aps.org/prxquantum/abstract/10.1103/PRXQuantum.2.030305">PRX Quantum 2, 030305 (2021)</a></p>
</dd>
<dt class="label" id="zini2023"><span class="brackets"><a class="fn-backref" href="#id5">3</a></span></dt>
<dd><p>Modjtaba Shokrian Zini, Alain Delgado, Roberto dos Reis, Pablo A. M. Casares,
Jonathan E. Mueller, Arne-Christian Voigt, Juan Miguel Arrazola,
“Quantum simulation of battery materials using ionic pseudopotentials”.
`   arXiv:2302.07981 (2023)
&lt;https://arxiv.org/abs/2302.07981&gt;`__</p>
</dd>
<dt class="label" id="delgado2022"><span class="brackets">4</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id7">2</a>)</span></dt>
<dd><p>Alain Delgado, Pablo A. M. Casares, Roberto dos Reis, Modjtaba Shokrian Zini, <em>et al.</em>,
“Simulating key properties of lithium-ion batteries with a fault-tolerant quantum computer”.
<a class="reference external" href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.106.032428">Phys. Rev. A 106, 032428 (2022)</a></p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/soran_jahangiri.png" alt="Soran Jahangiri" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Soran Jahangiri</h4>
        <p class="bio-text__author-description">Soran Jahangiri is a quantum chemist working at Xanadu. His work is focused on developing and implementing quantum algorithms for chemistry applications.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  11.899 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-resource-estimation-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/79f6327d26780ea35ea0d3e681eb25c0/tutorial_resource_estimation.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_resource_estimation.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/97605b0d3747076ea0eea0fddb3610c9/tutorial_resource_estimation.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_resource_estimation.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_resource_estimation</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Resource estimation for quantum chemistry</a><ul class='current'>
<li class='current'><a class="reference internal" href="#id1">Quantum Phase Estimation</a><ul class='current'>
<li class='current'><a class="reference internal" href="#qpe-cost-for-simulating-molecules">QPE cost for simulating molecules</a></li>
<li class='current'><a class="reference internal" href="#qpe-cost-for-simulating-periodic-materials">QPE cost for simulating periodic materials</a></li>
</ul>
</li>
<li class='current'><a class="reference internal" href="#id8">Variational quantum eigensolver</a></li>
<li class='current'><a class="reference internal" href="#conclusions">Conclusions</a></li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_resource_estimation</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_quantum-chemistry.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../demos_optimization.html" title="Optimization"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_qchem_external.html" title="Using PennyLane with PySCF and OpenFermion"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demos_quantum-chemistry.html" >Quantum Chemistry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Resource estimation for quantum chemistry</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>