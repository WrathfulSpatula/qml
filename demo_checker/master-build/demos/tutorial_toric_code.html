
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Investigation of the toric code degenerate ground state and anyon excitations" property="og:description" />
<meta content="https://pennylane.ai/qml/_images/types_of_loops.png" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Modeling the toric code on a quantum computer &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_toric_code.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Investigation of the toric code degenerate ground state and anyon excitations" property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Modeling the toric code on a quantum computer &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_toric_code.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Circuit Cutting" href="tutorial_quantum_circuit_cutting.html" />
    <link rel="prev" title="Photonic quantum computers" href="tutorial_photonics.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial_quantum_circuit_cutting.html" title="Quantum Circuit Cutting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_photonics.html" title="Photonic quantum computers"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demos_quantum-computing.html" accesskey="U">Quantum Computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Modeling the toric code on a quantum computer</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-demos-tutorial-toric-code-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="modeling-the-toric-code-on-a-quantum-computer">
<h1>Modeling the toric code on a quantum computer<a class="headerlink" href="#modeling-the-toric-code-on-a-quantum-computer" title="Permalink to this headline">¶</a></h1>
<p><em>Author: Christina Lee. Posted: 08 August 2022.</em></p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <em>toric code model</em> <a class="footnote-reference brackets" href="#kitaev2003" id="id1">1</a> is a treasure trove of interesting physics and
mathematics. The model sparked the development of the error-correcting surface codes <a class="footnote-reference brackets" href="#surface-codes" id="id2">2</a>,
an essential category of error correction models. But why is the
model so useful for error correction?</p>
<p>We delve into mathematics and condensed matter physics to answer that very question.
Viewing the model as a description of spins in an exotic magnet allows us to start
analyzing the model as a material. What kind of material is it? The toric code is an
example of a topological state of matter.</p>
<p>A state of matter, or phase, cannot become a different phase without some discontinuity
in the physical properties as coefficients in the Hamiltonian change. This discontinuity
may exist in an arbitrary order derivative or non-local observable. For example, ice cannot
become water without a discontinuity in density as the temperature changes. The ground state
of a <strong>topological</strong> state of matter cannot smoothly deform to a non-entangled state
without a phase transition. Entanglement, and more critically <em>long-range</em> entanglement,
is a key hallmark of a topological state of matter.</p>
<p>Local measurements cannot detect topological states of matter. We have to consider the
entire system to determine a topological phase.
To better consider this type of property, consider the parity of the number of
dancers on a dance floor. Does everyone have a partner, or is there an odd person out? To
measure that, we have to look at the entire system.</p>
<p>Topology is the study of global properties that are preserved under continuous
deformations. For example, a coffee cup is equivalent to a donut because they
both have a single hole. More technically, they both have an
<a class="reference external" href="https://en.wikipedia.org/wiki/Euler_characteristic">Euler characteristic</a> of zero.
When we zoom to a local patch, both a sphere and a torus look the same. Only by considering
the object as a whole can you detect the single hole.</p>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="../_images/torus_to_cup.png"><img alt="../_images/torus_to_cup.png" src="../_images/torus_to_cup.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">A donut can be smoothly deformed into a mug.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>In this demo, we will look at the degenerate ground state and the
excitations of the toric code model. The toric code was initially
proposed in “Fault-tolerant quantum computation by anyons” by Kitaev <a class="footnote-reference brackets" href="#kitaev2003" id="id3">1</a>.
This demo was inspired by “Realizing topologically ordered states on
a quantum processor” by K. J. Satzinger et al <a class="footnote-reference brackets" href="#google-paper" id="id4">3</a>. For further reading, I
recommend “Quantum Spin Liquids” by Lucile Savary and Leon Balents <a class="footnote-reference brackets" href="#savary-balents" id="id5">4</a> and
“A Pedagogical Overview on 2D and 3D Toric Codes and the Origin of their Topological Orders” <a class="footnote-reference brackets" href="#resende" id="id6">5</a>.</p>
</div>
<div class="section" id="the-model">
<h2>The Model<a class="headerlink" href="#the-model" title="Permalink to this headline">¶</a></h2>
<p>What is the source of all this fascinating physics? The Hamiltonian is:</p>
<div class="math notranslate nohighlight">
\[\mathcal{H} = -\sum_s S_s - \sum_p P_p,\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[S_s = \prod_{i \in s} Z_i \quad P_p = \prod_{j \in p} X_j.\]</div>
<p>In the literature, the <span class="math notranslate nohighlight">\(S_s\)</span> terms are called the “star”
operators, and the <span class="math notranslate nohighlight">\(P_p\)</span> terms are called the “plaquette”
operators. Each star <span class="math notranslate nohighlight">\(s\)</span> and plaquette <span class="math notranslate nohighlight">\(p\)</span> is a group of 4 sites on a square lattice.
You can compare this model to something like the <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_Heisenberg_model">Heisenberg model</a>
used to describe spins interacting magnetically in a material.</p>
<p>In the most common formulation of the model, sites live on
the edges of a square lattice. In this formulation, the “plaquette” operators are products of Pauli X operators on all the sites
in a square, and the “star” operators are products of Pauli Z operators on all the sites bordering a vertex.</p>
<p>Instead, we can view the model as a checkerboard of alternating square
types. In this formulation, all sites <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> are the vertices
of a square lattice.
Each square is a group of four sites, and adjacent squares
alternate between the two types of groups. Since the groups on
this checkerboard no longer look like stars and plaquettes, we will call
them the “Z Group” and “X Group” operators in this tutorial.</p>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="../_images/stars_plaquettes2.png"><img alt="../_images/stars_plaquettes2.png" src="../_images/stars_plaquettes2.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">On the left, sites are grouped into stars around vertices and plaquettes
on the faces. On the right, we view the lattice as a checkerboard of
alternating types of groups.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>We will be embedding the lattice on a torus via periodic boundary
conditions. Periodic boundary conditions basically “glue” the bottom of
the lattice to the top of the lattice and the left to the right.</p>
<p>Modular arithmetic accomplishes this matching. Any site at <code class="docutils literal notranslate"><span class="pre">(x,y)</span></code> is
the same as a site at <code class="docutils literal notranslate"><span class="pre">(x+width,</span> <span class="pre">y+height)</span></code>.</p>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="../_images/converting_to_torus.png"><img alt="../_images/converting_to_torus.png" src="../_images/converting_to_torus.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">By matching up the edges with periodic boundary conditions, we turn a square grid into
a torus.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>On to some practical coding! First, let’s define the sites on a <span class="math notranslate nohighlight">\(4\times 6\)</span> lattice.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">Patch</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">height</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">all_sites</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">))]</span>
</pre></div>
</div>
<p>We would like for our wire labels to match the sites. To do this, we will be using an <a class="reference external" href="https://realpython.com/python-data-classes/#immutable-data-classes">Immutable Data Class</a> .
PennyLane allows wire labels to be any <strong>hashable</strong> object, but iterable wire labels are currently not supported.
Therefore we use a frozen dataclass to represent individual wires by a row and column position.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Wire</span><span class="p">:</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">j</span><span class="p">:</span> <span class="nb">int</span>

<span class="n">example_wire</span> <span class="o">=</span> <span class="n">Wire</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example wire: &quot;</span><span class="p">,</span> <span class="n">example_wire</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At coordinates: &quot;</span><span class="p">,</span> <span class="n">example_wire</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">example_wire</span><span class="o">.</span><span class="n">j</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Example wire:  Wire(i=0, j=0)
At coordinates:  0 0
</pre></div>
</div>
</div>
<div class="section" id="setting-up-operators">
<h2>Setting up Operators<a class="headerlink" href="#setting-up-operators" title="Permalink to this headline">¶</a></h2>
<p>For each type of group operator (X and Z), we will have two different
lists: the “sites” and the “ops”. The “sites” are tuples and will include virtual
sites off the edge of the lattice that match up with locations on the
other side. For example, the site <code class="docutils literal notranslate"><span class="pre">(6,</span> <span class="pre">1)</span></code> denotes the real location
<code class="docutils literal notranslate"><span class="pre">(0,1)</span></code>. We will use the <code class="docutils literal notranslate"><span class="pre">zgroup_sites</span></code> and <code class="docutils literal notranslate"><span class="pre">xgroup_sites</span></code> lists
to help us view the measurements of the corresponding operators.</p>
<p>The “ops” list will contain the tensor observables. We will later
take the expectation value of each tensor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">Wire</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">width</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span> <span class="n">height</span><span class="p">)</span>

<span class="n">zgroup_sites</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of sites in each group</span>
<span class="n">zgroup_ops</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of operators for each group</span>

<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)):</span>

    <span class="n">x0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="c1"># x starting coordinate</span>

    <span class="n">sites</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">Tensor</span></a><span class="p">(</span><span class="o">*</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">))</span>

    <span class="n">zgroup_sites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sites</span><span class="p">)</span>
    <span class="n">zgroup_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First set of sites: &quot;</span><span class="p">,</span> <span class="n">zgroup_sites</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First operator: &quot;</span><span class="p">,</span> <span class="n">zgroup_ops</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>First set of sites:  [(1, 0), (2, 0), (2, 1), (1, 1)]
First operator:  PauliZ(wires=[Wire(i=1, j=0)]) @ PauliZ(wires=[Wire(i=2, j=0)]) @ PauliZ(wires=[Wire(i=2, j=1)]) @ PauliZ(wires=[Wire(i=1, j=1)])
</pre></div>
</div>
<p>We will later use the X Group operator sites to prepare the ground
state, so the order here is important. One group needs a slightly
different order due to interference with the periodic boundary
condition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xgroup_sites</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">xgroup_ops</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)):</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">%</span> <span class="mi">2</span> <span class="c1"># lower x coordinate</span>

    <span class="n">sites</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># change order for state prep later</span>
        <span class="n">sites</span> <span class="o">=</span> <span class="n">sites</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">sites</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>

    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">operation</span><span class="o">.</span><span class="n">Tensor</span></a><span class="p">(</span><span class="o">*</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">))</span>

    <span class="n">xgroup_sites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sites</span><span class="p">)</span>
    <span class="n">xgroup_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a><span class="p">)</span>
</pre></div>
</div>
<p>How can we best visualize these groups of four sites?</p>
<p>We use <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to show each group of four sites as a Polygon patch,
coloured according to the type of group. The <code class="docutils literal notranslate"><span class="pre">misc_plot_formatting</span></code> function
performs some minor styling improvements
repeated throughout this demo. The dotted horizontal lines and
dashed vertical lines denote where we glue our boundaries together.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">misc_plot_formatting</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">width</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">height</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>

    <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">misc_plot_formatting</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">xgroup_sites</span><span class="p">:</span>
    <span class="n">x_patch</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Polygon</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lavender&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">zgroup_sites</span><span class="p">:</span>
    <span class="n">z_patch</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Polygon</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mistyrose&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="n">plt_sites</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">all_sites</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">x_patch</span><span class="p">,</span> <span class="n">z_patch</span><span class="p">,</span> <span class="n">plt_sites</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;XGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;ZGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;Site&quot;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_001.png" srcset="../_images/sphx_glr_tutorial_toric_code_001.png" alt="tutorial toric code" class = "sphx-glr-single-img"/></div>
<div class="section" id="the-ground-state">
<h2>The Ground State<a class="headerlink" href="#the-ground-state" title="Permalink to this headline">¶</a></h2>
<p>While individual X and Z operators do not commute with each other, the X Group and Z Group operators
do:</p>
<div class="math notranslate nohighlight">
\[[S_s, P_p] = 0.\]</div>
<p>Since they commute, the wavefunction can be an eigenstate of each group operator independently. To minimize
the energy of the Hamiltonian on the system as a whole, we can minimize the contribution of each group operator.
Due to the negative coefficients in the Hamiltonian, we need to maximize the
expectation value of each operator.
The maximum possible expectation value for each operator is <span class="math notranslate nohighlight">\(+1\)</span>. We can turn this
into a constraint on our ground state:</p>
<div class="math notranslate nohighlight">
\[S_s |G \rangle = +1 |G \rangle \qquad \qquad P_p | G \rangle = +1 |G\rangle.\]</div>
<p>The wavefunction</p>
<div class="math notranslate nohighlight">
\[| G \rangle =  \prod_{p} \frac{\mathbb{I} + P_p}{\sqrt{2}} |00\dots 0\rangle = \prod_{p} U_p |00\dots 0 \rangle,\]</div>
<p>where <span class="math notranslate nohighlight">\(P_p\)</span> (plaquette) denotes an X Group operator, is such a state.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To check your understanding, confirm that this ground state obeys the constraints using pen and paper.</p>
</div>
<p><span class="math notranslate nohighlight">\(|G \rangle\)</span> contains a product of unitaries <span class="math notranslate nohighlight">\(U_p\)</span>. If we can figure out how to apply a single
<span class="math notranslate nohighlight">\(U_p\)</span> using a quantum computer’s operations, we can apply that decomposition
for every <span class="math notranslate nohighlight">\(p\)</span> in the product.</p>
<p>To better understand how to decompose <span class="math notranslate nohighlight">\(U_p\)</span>, let’s write
it concretely for a single group of four qubits:</p>
<div class="math notranslate nohighlight">
\[U |0000 \rangle =
\frac{\left(\mathbb{I} + X_1 X_2 X_3 X_4 \right)}{\sqrt{2}} |0000 \rangle
= \frac{1}{\sqrt{2}} \left( |0000\rangle + |1111\rangle \right).\]</div>
<p>This <a class="reference external" href="https://en.wikipedia.org/wiki/Greenberger–Horne–Zeilinger_state">generalized GHZ state</a>
can be prepared with a Hadamard and 3 CNOT
gates:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/generalized_ghz_draw.png"><img alt="../_images/generalized_ghz_draw.png" src="../_images/generalized_ghz_draw.png" style="width: 50%;" /></a>
</div>
<p>This decomposition for <span class="math notranslate nohighlight">\(U_p\)</span> holds only when the initial Hadamard
qubit begins in the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state, so we need to be careful in
the choice of the Hadamard’s qubit. This restriction is
why we rotated the order for a single X Group on the right border
earlier.</p>
<p>We will also not need to prepare the final X Group that contains the
four edges of the lattice.</p>
<p>Now let’s actually put these together into a circuit!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;lightning.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">all_sites</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">state_prep</span><span class="p">():</span>
    <span class="k">for</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a> <span class="ow">in</span> <span class="n">xgroup_ops</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor.wires" title="pennylane.operation.Tensor.wires" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-attribute"><span class="n">op</span><span class="o">.</span><span class="n">wires</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor.wires" title="pennylane.operation.Tensor.wires" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-attribute"><span class="n">op</span><span class="o">.</span><span class="n">wires</span></a><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor.wires" title="pennylane.operation.Tensor.wires" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-attribute"><span class="n">op</span><span class="o">.</span><span class="n">wires</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w</span><span class="p">])</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">diff_method</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit</span><span class="p">():</span>
    <span class="n">state_prep</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a><span class="p">)</span> <span class="k">for</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a> <span class="ow">in</span> <span class="n">xgroup_ops</span> <span class="o">+</span> <span class="n">zgroup_ops</span><span class="p">]</span>
</pre></div>
</div>
<p>From this QNode, we can calculate the group operators’ expectation
values and the system’s total energy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_xgroups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xgroup_ops</span><span class="p">)</span>
<span class="n">separate_expvals</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">expvals</span><span class="p">:</span> <span class="p">(</span><span class="n">expvals</span><span class="p">[:</span><span class="n">n_xgroups</span><span class="p">],</span> <span class="n">expvals</span><span class="p">[</span><span class="n">n_xgroups</span><span class="p">:])</span>

<span class="n">xgroup_expvals</span><span class="p">,</span> <span class="n">zgroup_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">circuit</span></a><span class="p">())</span>

<span class="n">E0</span> <span class="o">=</span> <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">xgroup_expvals</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">zgroup_expvals</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X Group expectation values&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">xgroup_expvals</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z Group expectation values&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">zgroup_expvals</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total energy: &quot;</span><span class="p">,</span> <span class="n">E0</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>X Group expectation values [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
Z Group expectation values [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
Total energy:  -23.999999999999996
</pre></div>
</div>
</div>
<div class="section" id="excitations">
<h2>Excitations<a class="headerlink" href="#excitations" title="Permalink to this headline">¶</a></h2>
<p>Quasiparticles allow physicists to describe complex
systems as interacting particles in a vacuum. Examples of
quasiparticles include electrons and holes in semiconductors, phonons,
and magnons.</p>
<p>Imagine trying to describe the traffic on the road. We could either explicitly
enumerate the location of each vehicle or list the positions and severities of traffic jams.</p>
<p>The first option provides complete information about the system but
is much more challenging to analyze. For most purposes, we can work
with information about how the traffic deviates from a baseline. In
semiconductors, we don’t write out the wave function for every single
electron. We instead use electrons and holes. Neither quasiparticle
electrons nor holes are fundamental particles like an electron or
positron in a vacuum. Instead, they are useful descriptions of how the
wave function differs from its ground state.</p>
<p>While the electrons and holes of a metal behave just like electrons and
positrons in a vacuum, some condensed matter systems contain
quasiparticles that cannot or do not exist as fundamental particles.
The excitations of the toric code are one such example. To find these quasiparticles,
we look at states that are <em>almost</em> the ground state, such as the ground state
with a single operator applied to it.</p>
<p>Suppose we apply a perturbation to the ground state in the form of a single
X gate at location <span class="math notranslate nohighlight">\(i\)</span> :</p>
<div class="math notranslate nohighlight">
\[| \phi \rangle = X_i | G \rangle.\]</div>
<p>Two Z group operators <span class="math notranslate nohighlight">\(S_s\)</span> contain individual Z operators at that
same site <span class="math notranslate nohighlight">\(i\)</span>. The noise term <span class="math notranslate nohighlight">\(X_i\)</span> will anti-commute with both
of these group operators:</p>
<div class="math notranslate nohighlight">
\[S_s X_i = \left( Z_i Z_a Z_b Z_c \right) X_i = - X_i S_s.\]</div>
<p>Using this relation, we can determine the expectation value of the Z group
operators with the altered state:</p>
<div class="math notranslate nohighlight">
\[S_s |\phi\rangle = S_s X_i |G\rangle = - X_i S_s |G\rangle = - X_i |G\rangle = - |\phi\rangle.\]</div>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[\langle \phi | S_s | \phi \rangle = -1.\]</div>
<p><span class="math notranslate nohighlight">\(S_s\)</span> now has an expectation value of <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<p>Applying a single X operator noise term changes the expectation value of <em>two</em> Z group operators.</p>
<p>This analysis repeats for the effect of a Z operator on the X Group
measurement. A single Z operator noise term changes the expectation values of <em>two</em>
X group operators.</p>
<p>Each group with a negative expectation value is considered an excitation. In the
literature, you will often see a Z Group excitation
<span class="math notranslate nohighlight">\(\langle S_s \rangle = -1\)</span> called an “electric” <span class="math notranslate nohighlight">\(e\)</span> excitation and
an X Group excitation <span class="math notranslate nohighlight">\(\langle P_p \rangle = -1\)</span> called a
“magnetic” <span class="math notranslate nohighlight">\(m\)</span> excitation. You may also see the inclusion of an identity
<span class="math notranslate nohighlight">\(\mathbb{I}\)</span> particle for the ground state and the combination
particle <span class="math notranslate nohighlight">\(\Psi\)</span> consisting of a single <span class="math notranslate nohighlight">\(e\)</span> and a single <span class="math notranslate nohighlight">\(m\)</span>
excitation.</p>
<p>Let’s create a QNode where we can apply these perturbations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">diff_method</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">excitations</span><span class="p">(</span><span class="n">x_sites</span><span class="p">,</span> <span class="n">z_sites</span><span class="p">):</span>
    <span class="n">state_prep</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">x_sites</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">z_sites</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">[</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a><span class="p">)</span> <span class="k">for</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.operation.Tensor.html#pennylane.operation.Tensor" title="pennylane.operation.Tensor" class="sphx-glr-backref-module-pennylane-operation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">op</span></a> <span class="ow">in</span> <span class="n">xgroup_ops</span> <span class="o">+</span> <span class="n">zgroup_ops</span><span class="p">]</span>
</pre></div>
</div>
<p>What are the expectation values when we apply a single X operation?
Two Z group measurements have indeed changed signs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">single_x</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">(</span><span class="n">single_x</span><span class="p">,</span> <span class="p">[]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;XGroup: &quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">x_expvals</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ZGroup: &quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">z_expvals</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>XGroup:  [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
ZGroup:  [1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
</pre></div>
</div>
<p>Instead of interpreting the state via the expectation values of the operators,
we can view the state as occupation numbers of the corresponding
quasiparticles. A group with an expectation value of <span class="math notranslate nohighlight">\(+1\)</span> is in the
ground state and thus has an occupation number of <span class="math notranslate nohighlight">\(0\)</span>. If the
expectation value is <span class="math notranslate nohighlight">\(-1\)</span>, then a quasiparticle exists in that location.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">occupation_numbers</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">expvals</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">expvals</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">print_info</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">):</span>
    <span class="n">E</span> <span class="o">=</span> <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">z_expvals</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total energy: &quot;</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Energy above the ground state: &quot;</span><span class="p">,</span> <span class="n">E</span> <span class="o">-</span> <span class="n">E0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X Group occupation numbers: &quot;</span><span class="p">,</span> <span class="n">occupation_numbers</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z Group occupation numbers: &quot;</span><span class="p">,</span> <span class="n">occupation_numbers</span><span class="p">(</span><span class="n">z_expvals</span><span class="p">))</span>

<span class="n">print_info</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Total energy:  -19.999999999999996
Energy above the ground state:  4.0
X Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Z Group occupation numbers:  [0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
<p>Since we will plot the same thing many times, we group the following
code into a function to easily call later.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">excitation_plot</span><span class="p">(</span><span class="n">x_excite</span><span class="p">,</span> <span class="n">z_excite</span><span class="p">):</span>
    <span class="n">x_color</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">expval</span><span class="p">:</span> <span class="s2">&quot;navy&quot;</span> <span class="k">if</span> <span class="n">expval</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;lavender&quot;</span>
    <span class="n">z_color</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">expval</span><span class="p">:</span> <span class="s2">&quot;maroon&quot;</span> <span class="k">if</span> <span class="n">expval</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;mistyrose&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">misc_plot_formatting</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">expval</span><span class="p">,</span> <span class="n">sites</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_excite</span><span class="p">,</span> <span class="n">xgroup_sites</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Polygon</span><span class="p">(</span><span class="n">sites</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">x_color</span><span class="p">(</span><span class="n">expval</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">expval</span><span class="p">,</span> <span class="n">sites</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">z_excite</span><span class="p">,</span> <span class="n">zgroup_sites</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Polygon</span><span class="p">(</span><span class="n">sites</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">z_color</span><span class="p">(</span><span class="n">expval</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

    <span class="n">handles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;X Group -1&quot;</span><span class="p">),</span>
        <span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;lavender&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;X Group +1&quot;</span><span class="p">),</span>
        <span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;maroon&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Z Group -1&quot;</span><span class="p">),</span>
        <span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;mistyrose&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Z Group +1&quot;</span><span class="p">),</span>
        <span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Z op&quot;</span><span class="p">),</span>
        <span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;maroon&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;X op&quot;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>
</div>
<p>With this function, we can quickly view the expectation values and the location of
the additional X operation. The operation changes the expectation values for the
adjacent Z groups.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">excitation_plot</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">single_x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;maroon&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_002.png" srcset="../_images/sphx_glr_tutorial_toric_code_002.png" alt="tutorial toric code" class = "sphx-glr-single-img"/><p>What if we apply a Z operation instead at the same site? We instead
get two X Group excitations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">single_z</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="n">expvals</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">([],</span> <span class="n">single_z</span><span class="p">)</span>
<span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>
<span class="n">print_info</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Total energy:  -19.999999999999996
Energy above the ground state:  4.0
X Group occupation numbers:  [0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Z Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">excitation_plot</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">single_z</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_003.png" srcset="../_images/sphx_glr_tutorial_toric_code_003.png" alt="tutorial toric code" class = "sphx-glr-single-img"/><p>What happens if we apply the same perturbation twice at one
location? We regain the ground state.</p>
<p>The excitations of the toric code are
Majorana particles: particles that are their own antiparticles. While
postulated to exist in standard particle physics, Majorana particles
have only been experimentally seen as quasiparticle excitations in
materials.</p>
<p>We can think of the second operation as creating another set of
excitations at the same location. This second pair then
annihilates the existing particles.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">single_z</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="n">expvals</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">([],</span> <span class="n">single_z</span> <span class="o">+</span> <span class="n">single_z</span><span class="p">)</span>
<span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>

<span class="n">print_info</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Total energy:  -23.999999999999996
Energy above the ground state:  0.0
X Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Z Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
<div class="section" id="moving-excitations-and-string-operators">
<h3>Moving Excitations and String Operators<a class="headerlink" href="#moving-excitations-and-string-operators" title="Permalink to this headline">¶</a></h3>
<p>What if we create a second set of particles such that one of the new particles
overlaps with an existing particle? One old and one new particle annihilate
each other. One old and one new particle remain. We still have two particles
in total.</p>
<p>Alternatively, we can view the second operation as moving a single excitation.</p>
<p>Let’s see what that looks like in code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">two_z</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="n">expvals</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">([],</span> <span class="n">two_z</span><span class="p">)</span>
<span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>

<span class="n">print_info</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Total energy:  -19.999999999999996
Energy above the ground state:  4.0
X Group occupation numbers:  [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Z Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">excitation_plot</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">two_z</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_004.png" srcset="../_images/sphx_glr_tutorial_toric_code_004.png" alt="tutorial toric code" class = "sphx-glr-single-img"/><p>In that example, we just moved an excitation a little. How about we try
moving it even further?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">long_string</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">expvals</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">([],</span> <span class="n">long_string</span><span class="p">)</span>
<span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>

<span class="n">print_info</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Total energy:  -19.999999999999996
Energy above the ground state:  4.0
X Group occupation numbers:  [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
Z Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">excitation_plot</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">long_string</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_005.png" srcset="../_images/sphx_glr_tutorial_toric_code_005.png" alt="tutorial toric code" class = "sphx-glr-single-img"/><p>We end up with strings of operations that connect pairs of quasiparticles.</p>
<p>We can use a branch of topology called <a class="reference external" href="https://en.wikipedia.org/wiki/Homotopy">Homotopy</a>
to describe the relationship between these strings and the wave function.
Two paths <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span> are
<strong>homotopy equivalent</strong> or <strong>homotopic</strong> if they can be continuously deformed into each
other:</p>
<div class="math notranslate nohighlight">
\[s_1 \sim s_2\]</div>
<p>In the following picture, assume the red “X” is a defect
in space, like a tear in a sheet. The two blue
paths are equivalent because you can smoothly move one
into the other. You cannot move the blue path into the green path
without going through the defect, so they are not equivalent to each
other.</p>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="../_images/homotopy.png"><img alt="../_images/homotopy.png" src="../_images/homotopy.png" style="width: 40%;" /></a>
<p class="caption"><span class="caption-text">Paths are homotopy equivalent if they can be smoothly deformed into each other.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<p>We can divide the set of all possible paths into <strong>homotopy classes</strong>. A homotopy class
is an <a class="reference external" href="https://en.wikipedia.org/wiki/Equivalence_class">equivalence class</a> under
homotopy. Every member of the same homotopy class can be deformed into every other member of the
same class, and
members of different homotopy classes cannot be deformed into each other. All the
homotopy classes for a given space <span class="math notranslate nohighlight">\(S\)</span> form its
<a class="reference external" href="https://en.wikipedia.org/wiki/Homotopy_group">first homotopy group</a>, denoted by <span class="math notranslate nohighlight">\(\pi_1(S)\)</span>.
The first homotopy group of a space is also called its <em>fundamental group</em>.</p>
<p>How do these mathematical concepts apply to the toric code model?
To find out, let’s look at a string of Z operations homotopic to the one above.</p>
<p>This next string creates the same final state.
Only the homotopy class of the path used to create the excitations influences
the occupation numbers and total energy.
If the endpoints are the same and the path doesn’t
wrap around the torus or other particles, the details do not
impact any observables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">equivalent_string</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">expvals</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">([],</span> <span class="n">equivalent_string</span><span class="p">)</span>
<span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>

<span class="n">print_info</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Total energy:  -19.999999999999996
Energy above the ground state:  4.0
X Group occupation numbers:  [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]
Z Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">excitation_plot</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">equivalent_string</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_006.png" srcset="../_images/sphx_glr_tutorial_toric_code_006.png" alt="tutorial toric code" class = "sphx-glr-single-img"/></div>
<div class="section" id="contractible-loops">
<h3>Contractible loops<a class="headerlink" href="#contractible-loops" title="Permalink to this headline">¶</a></h3>
<p>We can also have a loop of operations that doesn’t create any new
excitations. The loop forms a pair, moves one around in a circle, and
then annihilates the two particles again.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">contractible_loop</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="n">expvals</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">(</span><span class="n">contractible_loop</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>
<span class="n">print_info</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Total energy:  -23.999999999999996
Energy above the ground state:  0.0
X Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
Z Group occupation numbers:  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">excitation_plot</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">contractible_loop</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;maroon&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_007.png" srcset="../_images/sphx_glr_tutorial_toric_code_007.png" alt="tutorial toric code" class = "sphx-glr-single-img"/><p>The loop doesn’t affect the positions of any excitations, but does it
affect the state at all?</p>
<p>We will look at the probabilities instead of the expectation values
to answer that question.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">diff_method</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="n">x_sites</span><span class="p">,</span> <span class="n">z_sites</span><span class="p">):</span>
    <span class="n">state_prep</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">x_sites</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">z_sites</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">))</span>

    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.probs.html#pennylane.probs" title="pennylane.probs" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">probs</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">all_sites</span><span class="p">])</span>


<span class="n">null_probs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">probs</span></a><span class="p">([],</span> <span class="p">[])</span>
<span class="n">contractible_probs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">probs</span></a><span class="p">(</span><span class="n">contractible_loop</span><span class="p">,</span> <span class="p">[])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Are the probabilities equal? &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">null_probs</span><span class="p">,</span> <span class="n">contractible_probs</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Are the probabilities equal?  True
</pre></div>
</div>
<p>The toric code’s dependence on the homotopy of the path explains
this result. All paths we can smoothly deform into each other will give
the same result. The contractible loop can be smoothly deformed to nothing,
so the state with the contractible loop is the same as the state with no loop, our initial <span class="math notranslate nohighlight">\(|G\rangle\)</span>.</p>
</div>
<div class="section" id="looping-the-torus">
<h3>Looping the torus<a class="headerlink" href="#looping-the-torus" title="Permalink to this headline">¶</a></h3>
<p>On the torus, we have four types of unique paths:</p>
<ul class="simple">
<li><p>The trivial path that contracts to nothing</p></li>
<li><p>A horizontal loop around the boundaries</p></li>
<li><p>A vertical loop around the boundaries</p></li>
<li><p>A loop around both the horizontal and vertical boundaries</p></li>
</ul>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="../_images/types_of_loops.png"><img alt="../_images/types_of_loops.png" src="../_images/types_of_loops.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-text">The homotopy group of a torus can be generated by a horizontal loop
and a vertical loop around the boundaries.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p>Each of these paths represents a member of the first homotopy group
of the torus: <span class="math notranslate nohighlight">\(\pi_1(T) = \mathbb{Z}^2\)</span> modulo 2.</p>
<p>None of these loops of X operations create net excitations, so the wave function
remains in the ground state.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">horizontal_loop</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">)]</span>
<span class="n">vertical_loop</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)]</span>

<span class="n">expvals</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">(</span><span class="n">horizontal_loop</span> <span class="o">+</span> <span class="n">vertical_loop</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">excitation_plot</span><span class="p">(</span><span class="o">*</span><span class="n">separate_expvals</span><span class="p">(</span><span class="n">expvals</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">horizontal_loop</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;maroon&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">vertical_loop</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;maroon&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_008.png" srcset="../_images/sphx_glr_tutorial_toric_code_008.png" alt="tutorial toric code" class = "sphx-glr-single-img"/><p>We can compute the probabilities for each of these four types of loops:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">null_probs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">probs</span></a><span class="p">([],</span> <span class="p">[])</span>
<span class="n">horizontal_probs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">probs</span></a><span class="p">(</span><span class="n">horizontal_loop</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">vertical_probs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">probs</span></a><span class="p">(</span><span class="n">vertical_loop</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">combo_probs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">probs</span></a><span class="p">(</span><span class="n">horizontal_loop</span> <span class="o">+</span> <span class="n">vertical_loop</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>
</div>
<p>While X and Z operations can change the group operator expectation values
and create quasiparticles, only X operators can change the probability
distribution. Applying a Z operator would only rotate the phase of the
state and not change any amplitudes. Hence we only use loops of X
operators in this section. I encourage you to try this analysis with
loops of Z operators to confirm that they do not change the probability
distribution.</p>
<p>We can compare the original state and one with a horizontal loop to see
if the probability distributions are different:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Are the probabilities equal? &quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.math.allclose.html#pennylane.math.allclose" title="pennylane.math.allclose" class="sphx-glr-backref-module-pennylane-math sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">allclose</span></a><span class="p">(</span><span class="n">null_probs</span><span class="p">,</span> <span class="n">horizontal_probs</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Is this significant?&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum difference in probabilities: &quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">null_probs</span> <span class="o">-</span> <span class="n">horizontal_probs</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum probability: &quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">null_probs</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Are the probabilities equal?  False
Is this significant?
Maximum difference in probabilities:  0.00048828124999999913
Maximum probability:  0.00048828124999999913
</pre></div>
</div>
<p>These numbers seem small, but remember we have 24 qubits, and thus
<span class="math notranslate nohighlight">\(2^{24}=16777216\)</span> probability components. Since the maximum difference
in probabilities is the same size as the maximum probability, we know
this isn’t just random fluctuations and errors. The states are different, but the energies are the same,
so they are <em>degenerate</em>.</p>
<p>That compared a horizontal “x” loop with the initial ground
state. How about the other two types of loops? Let’s iterate over all
combinations of two probability distributions to see if any match.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">probs_type_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;combo&quot;</span><span class="p">]</span>
<span class="n">all_probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">null_probs</span><span class="p">,</span> <span class="n">horizontal_probs</span><span class="p">,</span> <span class="n">vertical_probs</span><span class="p">,</span> <span class="n">combo_probs</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">probs_type_labels</span><span class="p">))</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">probs1</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">probs_type_labels</span><span class="p">,</span> <span class="n">all_probs</span><span class="p">):</span>
    <span class="n">comparisons</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">probs1</span><span class="p">,</span> <span class="n">probs2</span><span class="p">))</span> <span class="k">for</span> <span class="n">probs2</span> <span class="ow">in</span> <span class="n">all_probs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">comparisons</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>        null    x       y       combo
null     True   False   False   False
x        False  True    False   False
y        False  False   True    False
combo    False  False   False   True
</pre></div>
</div>
<p>This table shows the model has four distinct ground states. More importantly,
these ground states are separated from each other by long-range
operations. We must perform a loop of operations across the entire
lattice to switch between degenerate ground states.</p>
<p>This four-way degeneracy is the source of the error correction in the
toric code. Instead of 24 qubits, we work with two logical qubits (4 states)
that are well separated from each other by topological operations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I encourage dedicated readers to explore what happens when a path
loops the same boundaries twice.</p>
</div>
<p>In this section, we’ve seen that the space of ground states is directly
related to the first homotopy group of the lattice. The first homotopy group
of a torus is <span class="math notranslate nohighlight">\(\pi_1(T) = \mathbb{Z}^2\)</span>, and the space of ground states is
that group modulo two, <span class="math notranslate nohighlight">\(\mathbb{Z}_2^2\)</span>.</p>
<p>What if we defined the model on a differently shaped lattice? Then the space of the
ground state would change to reflect the first homotopy group of that space.
For example, if the model was defined on a sphere, then only a single unique ground state would exist.
Adding defects like missing sites to the lattice also changes the topology. Error correction
with the toric code often uses missing sites to add additional logical qubits.</p>
</div>
</div>
<div class="section" id="mutual-and-exchange-statistics">
<h2>Mutual and Exchange Statistics<a class="headerlink" href="#mutual-and-exchange-statistics" title="Permalink to this headline">¶</a></h2>
<p>The hole in the center of the donut isn’t the only thing that prevents
paths from smoothly deforming into each other. We don’t yet know if we
can distort paths past other particles.</p>
<p>When one indistinguishable fermion of spin 1/2 orbits another fermion of
the same type, the combined wave function picks up a relative phase of negative
one. When fermions of different types orbit each other, the state is
unchanged. For example, if an electron goes around a proton and returns
to the same spot, the wave function is unchanged. If a boson orbits
around a different type of boson, again, the wave function is unchanged.</p>
<p>What if a particle went around a different type of particle and
everything picked up a phase? Would it be a boson or a fermion?</p>
<p>It would be something else entirely: an anyon. An anyon is anything that
doesn’t cleanly fall into the boson/fermion categorization of particles.</p>
<p>While the toric code is just an extremely useful mathematical
model, anyons exist in physical materials. For example,
fractional quantum Hall systems have anyonic particles with spin
<span class="math notranslate nohighlight">\(1/q\)</span> for different integers <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>The <strong>statistics</strong> are described by the phase accumulated by moving one particle
around another. For example, if the particle picks up phases like a fermion, then it
obeys <a class="reference external" href="https://en.wikipedia.org/wiki/Fermi–Dirac_statistics">Fermi-Dirac statistics</a>.
<strong>Exchange statistics</strong> are described by the phases that accumulate from exchanging
the <em>same</em> type of particles.  <strong>Mutual</strong> statistics are characterized by the phase acquired
by moving one particle around a particle of a <em>different</em> type.</p>
<p>To measure the mutual statistics of a Z Group excitation and an X group
excitation, we need to prepare at least one of each type of particle and then
orbit one around the other.</p>
<p>The following code rotates an X Group excitation around a Z Group excitation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prep1</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">prep2</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="n">loop1</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>

<span class="n">expvals</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">excitations</span></a><span class="p">(</span><span class="n">prep1</span><span class="p">,</span> <span class="n">prep2</span> <span class="o">+</span> <span class="n">loop1</span><span class="p">)</span>
<span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span> <span class="o">=</span> <span class="n">separate_expvals</span><span class="p">(</span><span class="n">expvals</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">excitation_plot</span><span class="p">(</span><span class="n">x_expvals</span><span class="p">,</span> <span class="n">z_expvals</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">prep1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;maroon&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">prep2</span> <span class="o">+</span> <span class="n">loop1</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_toric_code_009.png" srcset="../_images/sphx_glr_tutorial_toric_code_009.png" alt="tutorial toric code" class = "sphx-glr-single-img"/><p>While we managed to loop one particle around the other, we did not
extract the relative phase applied to the wave function.  To procure
this information, we will need the <em>Hadamard test</em>.</p>
<div class="section" id="hadamard-test">
<h3>Hadamard test<a class="headerlink" href="#hadamard-test" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Hadamard_test_(quantum_computation)">Hadamard test</a>
extracts the real component of a unitary operation
<span class="math notranslate nohighlight">\(\text{Re}\left(\langle \psi | U | \psi \rangle \right)\)</span>. If the unitary operation just applies a phase
<span class="math notranslate nohighlight">\(U |\psi\rangle = e^{i \phi} |\psi \rangle\)</span>, the measured quantity reduces to <span class="math notranslate nohighlight">\(\cos (\phi)\)</span>.</p>
<p>The steps in the Hadamard test are:</p>
<ol class="arabic simple">
<li><p>Prepare the auxiliary qubit into a superposition with a Hadamard
gate</p></li>
<li><p>Apply a controlled version of the operation with the auxiliary
qubit as the control</p></li>
<li><p>Apply another Hadamard gate to the auxiliary qubit</p></li>
<li><p>Measure the auxiliary qubit in the Z-basis</p></li>
</ol>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Hadamard_test.png"><img alt="../_images/Hadamard_test.png" src="../_images/Hadamard_test.png" style="width: 50%;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For extra understanding, validate the Hadamard test algorithm using pen and paper.</p>
</div>
<p>Below we implement this algorithm in PennyLane and measure the mutual exchange statistics
of an X Group excitation and a Z Group excitation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev_aux</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;lightning.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">all_sites</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;aux&quot;</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="n">x_loop</span><span class="p">,</span> <span class="n">z_loop</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">x_loop</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">z_loop</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">))</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev_aux</span><span class="p">,</span> <span class="n">diff_method</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hadamard_test</span><span class="p">(</span><span class="n">x_prep</span><span class="p">,</span> <span class="n">z_prep</span><span class="p">,</span> <span class="n">x_loop</span><span class="p">,</span> <span class="n">z_loop</span><span class="p">):</span>
    <span class="n">state_prep</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">x_prep</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">z_prep</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="n">Wire</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">))</span>

    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><span class="s2">&quot;aux&quot;</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.ctrl.html#pennylane.ctrl" title="pennylane.ctrl" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">ctrl</span></a><span class="p">(</span><span class="n">loop</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="s2">&quot;aux&quot;</span><span class="p">)(</span><span class="n">x_loop</span><span class="p">,</span> <span class="n">z_loop</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><span class="s2">&quot;aux&quot;</span><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><span class="s2">&quot;aux&quot;</span><span class="p">))</span>

<span class="n">x_around_z</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hadamard_test</span></a><span class="p">(</span><span class="n">prep1</span><span class="p">,</span> <span class="n">prep2</span><span class="p">,</span> <span class="p">[],</span> <span class="n">loop1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Move x excitation around z excitation: &quot;</span><span class="p">,</span> <span class="n">x_around_z</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Move x excitation around z excitation:  -0.9999999999999991
</pre></div>
</div>
<p>We just moved two different types of particles around each other and
picked up a phase. As neither bosons nor fermions behave like this, this
result demonstrates that the excitations of a toric code are anyons.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I encourage dedicated readers to calculate the phase accumulated by exchanging:</p>
<ul class="simple">
<li><p>A Z Group excitation and a Z Group Excitation</p></li>
<li><p>An X Group excitation and an X Group Excitation</p></li>
<li><p>A combination <span class="math notranslate nohighlight">\(\Psi\)</span> particle and an X Group excitation</p></li>
<li><p>A combination <span class="math notranslate nohighlight">\(\Psi\)</span> particle and a Z Group excitation</p></li>
<li><p>A combination <span class="math notranslate nohighlight">\(\Psi\)</span> particle with another <span class="math notranslate nohighlight">\(\Psi\)</span> particle</p></li>
</ul>
<p>The combination particle should behave like a standard fermion. You can create and move combination
particles by applying <code class="docutils literal notranslate"><span class="pre">PauliY</span></code> operations.</p>
</div>
<p>In this demo, we have demonstrated:</p>
<ol class="arabic simple">
<li><p>How to prepare the ground state of the toric code model on a lattice
of qubits</p></li>
<li><p>How to create and move excitations</p></li>
<li><p>The ground state degeneracy of the model on a toric lattice, arising
from homotopically distinct loops of operations</p></li>
<li><p>The excitations are anyons due to non-trivial mutual statistics
Make sure to go and modify the code as suggested if you wish to gain more intuition.</p></li>
</ol>
<p>Do check the references below if you want to learn more!</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="kitaev2003"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Kitaev, A. Yu. “Fault-tolerant quantum computation by anyons.”
<a class="reference external" href="https://doi.org/10.1016/S0003-4916(02)00018-0">Annals of Physics 303.1 (2003): 2-30.</a>.
(<a class="reference external" href="https://arxiv.org/pdf/quant-ph/9707021">arXiv</a>)</p>
</dd>
<dt class="label" id="surface-codes"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Fowler, Austin G., et al. “Surface codes: Towards practical large-scale quantum computation.”
<a class="reference external" href="https://doi.org/10.1103/PhysRevA.86.032324">Physical Review A 86.3 (2012): 032324.</a>.
(<a class="reference external" href="https://arxiv.org/pdf/1208.0928">arXiv</a>)</p>
</dd>
<dt class="label" id="google-paper"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>Satzinger, K. J., et al. “Realizing topologically ordered states on a quantum processor.”
<a class="reference external" href="https://www.science.org/doi/abs/10.1126/science.abi8378">Science 374.6572 (2021): 1237-1241.</a>.
(<a class="reference external" href="https://arxiv.org/pdf/2104.01180">arXiv</a>)</p>
</dd>
<dt class="label" id="savary-balents"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>Savary, Lucile, and Leon Balents. “Quantum spin liquids: a review.”
<a class="reference external" href="https://iopscience.iop.org/article/10.1088/0034-4885/80/1/016502/meta">Reports on Progress in Physics 80.1 (2016): 016502.</a>.
(<a class="reference external" href="https://arxiv.org/abs/1601.03742">arXiv</a>)</p>
</dd>
<dt class="label" id="resende"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Araujo de Resende, M. F. “A pedagogical overview on 2D and 3D Toric Codes and the origin of their topological orders.”
<a class="reference external" href="https://doi.org/10.1142/S0129055X20300022">Reviews in Mathematical Physics 32.02 (2020): 2030002.</a>
(<a class="reference external" href="https://arxiv.org/pdf/1712.01258.pdf">arXiv</a>)</p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/christina_lee.JPG" alt="Christina Lee" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Christina Lee</h4>
        <p class="bio-text__author-description">Christina is currently a quantum software developer at Xanadu working on PennyLane. Outside of coding, she enjoys running, yoga, and piano.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  53.545 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-toric-code-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/f1f11da7d192a515debf493d76aee827/tutorial_toric_code.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_toric_code.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/2b6c8d750872e59b3629a07911aa03c2/tutorial_toric_code.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_toric_code.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_toric_code</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Modeling the toric code on a quantum computer</a><ul class='current'>
<li class='current'><a class="reference internal" href="#introduction">Introduction</a></li>
<li class='current'><a class="reference internal" href="#the-model">The Model</a></li>
<li class='current'><a class="reference internal" href="#setting-up-operators">Setting up Operators</a></li>
<li class='current'><a class="reference internal" href="#the-ground-state">The Ground State</a></li>
<li class='current'><a class="reference internal" href="#excitations">Excitations</a><ul class='current'>
<li class='current'><a class="reference internal" href="#moving-excitations-and-string-operators">Moving Excitations and String Operators</a></li>
<li class='current'><a class="reference internal" href="#contractible-loops">Contractible loops</a></li>
<li class='current'><a class="reference internal" href="#looping-the-torus">Looping the torus</a></li>
</ul>
</li>
<li class='current'><a class="reference internal" href="#mutual-and-exchange-statistics">Mutual and Exchange Statistics</a><ul class='current'>
<li class='current'><a class="reference internal" href="#hadamard-test">Hadamard test</a></li>
</ul>
</li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_toric_code</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_quantum-computing.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial_quantum_circuit_cutting.html" title="Quantum Circuit Cutting"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_photonics.html" title="Photonic quantum computers"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demos_quantum-computing.html" >Quantum Computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Modeling the toric code on a quantum computer</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>