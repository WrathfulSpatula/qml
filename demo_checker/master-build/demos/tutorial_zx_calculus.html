
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Investigation of the ZX-calculus and its applications to quantum computing" property="og:description" />
<meta content="https://pennylane.ai/qml/_images/thumbnail_tutorial_zx_calculus.png" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Introduction to the ZX-calculus &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_zx_calculus.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Investigation of the ZX-calculus and its applications to quantum computing" property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Introduction to the ZX-calculus &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_zx_calculus.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Differentiable pulse programming with qubits in PennyLane" href="tutorial_pulse_programming101.html" />
    <link rel="prev" title="Measurement-based quantum computation" href="tutorial_mbqc.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial_pulse_programming101.html" title="Differentiable pulse programming with qubits in PennyLane"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_mbqc.html" title="Measurement-based quantum computation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-computing.html" accesskey="U">Quantum Computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Introduction to the ZX-calculus</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-demos-tutorial-zx-calculus-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="introduction-to-the-zx-calculus">
<span id="sphx-glr-demos-tutorial-zx-calculus-py"></span><h1>Introduction to the ZX-calculus<a class="headerlink" href="#introduction-to-the-zx-calculus" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = ["tutorial_backprop.html", "tutorial_mbqc.html"];
    var related_tutorials_titles = ['Quantum gradients with backpropagation', 'Measurement-based quantum computation'];
</script></p>
<p><em>Author: Romain Moyard. Posted: 6 June, 2023.</em></p>
<p>The ZX-calculus is a graphical language for reasoning about quantum computations and circuits. Introduced by Coecke
and Duncan <a class="footnote-reference brackets" href="#coecke" id="id1">1</a>, it can represent any linear map, and can be considered a diagrammatically complete
generalization of the usual circuit representation. The ZX-calculus is based on category theory, an approach to
mathematics which studies objects in terms of their relations rather than in isolation. Thus, the ZX-calculus
provides a rigorous way to understand the structure underlying quantum problems, using the link between quantum
operations rather than the quantum operations themselves.</p>
<div class="figure align-center" id="id24">
<a class="reference internal image-reference" href="../_images/ZX_Calculus_animation.gif"><img alt="../_images/ZX_Calculus_animation.gif" src="../_images/ZX_Calculus_animation.gif" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">After this tutorial you will understand how to represent quantum teleportation and simplify it in the ZX-calculus!</span><a class="headerlink" href="#id24" title="Permalink to this image">¶</a></p>
</div>
<p>In this tutorial, we first give an overview of the building blocks of the ZX-calculus, called <em>ZX-diagrams</em>,
and the rules for transforming them, called <em>rewriting rules</em>. We also show how the ZX-calculus can be extended to ZXH
calculus. The ZX-calculus is also promising for quantum machine learning, thus we present how the parameter-shift rule
can be derived using ZX-diagrams. We will then jump to the coding part of the tutorial and show how PennyLane is
integrated with PyZX <a class="footnote-reference brackets" href="#pyzx" id="id2">2</a>, a Python library for ZX-calculus, and how you can transform your circuit to a
ZX-diagram. We then apply what we’ve learned in order to optimize the number of T-gates of a known benchmark circuit.
We also show that simplifying a ZX-diagram does not always end up with a diagram-like graph, and that circuit
extraction is a main pain point of the ZX framework. This tutorial will give a broad overview of what ZX-calculus can
offer when you want to analyze quantum problems.</p>
<div class="section" id="zx-diagrams">
<h2>ZX-diagrams<a class="headerlink" href="#zx-diagrams" title="Permalink to this headline">¶</a></h2>
<p>This introduction follows the works of the East et al. <a class="footnote-reference brackets" href="#east2021" id="id3">3</a> and van de Wetering <a class="footnote-reference brackets" href="#jvdw2020" id="id4">4</a>. Our goal is to
introduce a complete language for quantum information, for which we need two elements: ZX-diagrams and their
rewriting rules. We start by introducing ZX-diagrams, a graphical depiction of a tensor network representing an
arbitrary linear map. Later, we will introduce ZX rewriting rules, which together with diagrams defines the
ZX-calculus. We follow the scalar convention of East et al. <a class="footnote-reference brackets" href="#east2021" id="id5">3</a> (it is more suitable to the multi-H box
situations, see the ZXH section).</p>
<p>A ZX-diagram is an undirected multi-graph; you can move vertices without affecting the underlying
linear map. The vertices are called Z- and X-spiders, which represent two kinds of linear maps. The edges are called
wires, and represent the dimensions on which the linear maps are acting. Therefore, the edges represent qubits in
quantum computing. The diagram’s wires on the left and right are called inputs and outputs, respectively.</p>
<p>The first building block of the ZX-diagram is the Z-spider. In most of the literature, it is depicted as a green vertex.
The Z-spider takes a real phase <span class="math notranslate nohighlight">\(\alpha \in \mathbb{R}\)</span> and represents the following linear map (it accepts any
number of inputs and outputs, and the number of inputs does not need to match the number of outputs):</p>
<div class="figure align-center" id="id25">
<a class="reference internal image-reference" href="../_images/z_spider.jpeg"><img alt="../_images/z_spider.jpeg" src="../_images/z_spider.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The Z-spider.</span><a class="headerlink" href="#id25" title="Permalink to this image">¶</a></p>
</div>
<p>It is easy to see that the usual Z-gate can be represented with a single-wire Z-gate:</p>
<div class="figure align-center" id="id26">
<a class="reference internal image-reference" href="../_images/z_gate.jpeg"><img alt="../_images/z_gate.jpeg" src="../_images/z_gate.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The Z-gate.</span><a class="headerlink" href="#id26" title="Permalink to this image">¶</a></p>
</div>
<p>As you’ve probably already guessed, the second building block of the ZX-diagram is the X-spider. It is usually depicted
as a red vertex. The X-spider also takes a real phase <span class="math notranslate nohighlight">\(\alpha \in \mathbb{R}\)</span> and it represents the following
linear map (it accepts any number of inputs and outputs):</p>
<div class="figure align-center" id="id27">
<a class="reference internal image-reference" href="../_images/x_spider.jpeg"><img alt="../_images/x_spider.jpeg" src="../_images/x_spider.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The X-spider.</span><a class="headerlink" href="#id27" title="Permalink to this image">¶</a></p>
</div>
<p>It is easy to see that the usual X-gate can be represented with a single-wire X-spider:</p>
<div class="figure align-center" id="id28">
<a class="reference internal image-reference" href="../_images/x_gate.jpeg"><img alt="../_images/x_gate.jpeg" src="../_images/x_gate.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The X-gate.</span><a class="headerlink" href="#id28" title="Permalink to this image">¶</a></p>
</div>
<p>From ordinary quantum theory, we know that the Hadamard gate can be decomposed into X and Z rotations, and can therefore
be represented in ZX-calculus. In order to make the diagram easier to read, we introduce the Hadamard gate as a yellow
box:</p>
<div class="figure align-center" id="id29">
<a class="reference internal image-reference" href="../_images/hadamard_gate.png"><img alt="../_images/hadamard_gate.png" src="../_images/hadamard_gate.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The Hadamard gate as a yellow box and its ZX decomposition.</span><a class="headerlink" href="#id29" title="Permalink to this image">¶</a></p>
</div>
<p>This yellow box is also often represented as a blue edge in order to further simplify the display of the diagram.
Below, we will discuss a generalization of the yellow box to a third spider, forming the ZXH-calculus. It is important
to note that the yellow box is by itself a rewrite rule for the decomposition of the Hadamard gate. The yellow box
allows us to write the relationship between the X- and Z-spider as follows.</p>
<div class="figure align-center" id="id30">
<a class="reference internal image-reference" href="../_images/hxhz.jpg"><img alt="../_images/hxhz.jpg" src="../_images/hxhz.jpg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">How to transform an X-spider to a Z-spider with the Hadamard gate.</span><a class="headerlink" href="#id30" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id31">
<a class="reference internal image-reference" href="../_images/hzhx.jpg"><img alt="../_images/hzhx.jpg" src="../_images/hzhx.jpg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">How to transform an Z-spider to a X-spider with the Hadamard gate.</span><a class="headerlink" href="#id31" title="Permalink to this image">¶</a></p>
</div>
<p>A special case of the Z- and X-spiders are diagrams with no inputs (or outputs). They are used to represent states that
are unnormalized. If a spider has no inputs and outputs, it simply represents a complex scalar. You can find the usual
representation of quantum states below:</p>
<div class="figure align-center" id="id32">
<a class="reference internal image-reference" href="../_images/zero_state_plus_state.jpeg"><img alt="../_images/zero_state_plus_state.jpeg" src="../_images/zero_state_plus_state.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The zero state and plus state as a ZX-diagram.</span><a class="headerlink" href="#id32" title="Permalink to this image">¶</a></p>
</div>
<p>Similarly, you get the <span class="math notranslate nohighlight">\(\vert 1\rangle\)</span> state and <span class="math notranslate nohighlight">\(\vert -\rangle\)</span> state by replacing the zero phase with
<span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>The phases are <span class="math notranslate nohighlight">\(2\pi\)</span> periodic, and when a phase is equal to <span class="math notranslate nohighlight">\(0\)</span> we omit the zero symbol from the spider.
A simple green vertex is a Z-spider with zero phase and a simple red vertex is an X-spider with zero phase.</p>
<p>Now that we have these two basic building blocks, we can start composing them and stacking them on top of each other.
Composition consists of joining the outputs of a diagram to the inputs of another diagram. Stacking two
ZX-diagrams on top of each other represents the tensor product of the corresponding tensors.</p>
<p>We illustrate the rules of stacking and composition by building an equivalent CNOT gate (up to a global phase). We
start by stacking a single wire with a phaseless Z-spider with one input wire and two output wires. We show the
ZX-diagram and corresponding matrix below:</p>
<div class="figure align-center" id="id33">
<a class="reference internal image-reference" href="../_images/stack_z_w.jpg"><img alt="../_images/stack_z_w.jpg" src="../_images/stack_z_w.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Phaseless Z-spider with one input wire and two output wires (see the definition of the Z-spider) stacked with a
single wire.</span><a class="headerlink" href="#id33" title="Permalink to this image">¶</a></p>
</div>
<p>Next, we stack a single wire with a phaseless X-spider with two input wires and single output wire. Again, we provide
the matrix:</p>
<div class="figure align-center" id="id34">
<a class="reference internal image-reference" href="../_images/stack_w_x.jpg"><img alt="../_images/stack_w_x.jpg" src="../_images/stack_w_x.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Single wire stacked with a phaseless X-spider with two inputs wires and one output wire.</span><a class="headerlink" href="#id34" title="Permalink to this image">¶</a></p>
</div>
<p>Finally, we compose the two diagrams, meaning that we join the two outputs of the first diagram with the two inputs of
the second diagram. By doing this we obtain a CNOT gate — you can convince yourself by doing the matrix multiplication
between the two diagrams.</p>
<div class="figure align-center" id="id35">
<a class="reference internal image-reference" href="../_images/compose_zw_wx.jpg"><img alt="../_images/compose_zw_wx.jpg" src="../_images/compose_zw_wx.jpg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The composition of the two diagrams is a CNOT gate.</span><a class="headerlink" href="#id35" title="Permalink to this image">¶</a></p>
</div>
<p>We’ve already mentioned that a ZX-diagram is an undirected multi-graph; the position of the vertices does not matter,
nor does the trajectory of the wires. We can move vertices around, bend and unbend, and cross and uncross wires
as long as the connectivity and the order of the inputs and outputs is maintained. In particular, bending a line so
that it changes direction from left to right, or vice-versa, is not allowed. None of these deformations affect the
underlying linear map, meaning that ZX-diagrams have all sorts of <em>topological</em> symmetries. For instance,
the two diagrams below both represent the CNOT gate:</p>
<div class="figure align-center" id="id36">
<a class="reference internal image-reference" href="../_images/cnot_moved.jpeg"><img alt="../_images/cnot_moved.jpeg" src="../_images/cnot_moved.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">Both diagrams represent the same CNOT gate.</span><a class="headerlink" href="#id36" title="Permalink to this image">¶</a></p>
</div>
<p>This means that we can draw a vertical line without ambiguity, which is the usual way of representing the CNOT gate:</p>
<div class="figure align-center" id="id37">
<a class="reference internal image-reference" href="../_images/cnot.jpeg"><img alt="../_images/cnot.jpeg" src="../_images/cnot.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">Usual representation of the CNOT gate as a ZX-diagram.</span><a class="headerlink" href="#id37" title="Permalink to this image">¶</a></p>
</div>
<p>We’ve just shown that we can express any Z rotation and X rotation with Z- and X-spiders. Therefore, it is sufficient
to create any one-qubit rotation on the Bloch sphere. By composing and stacking,
we can also create the CNOT gate. Therefore, we have a universal gate set! We can also create the <span class="math notranslate nohighlight">\(0\)</span> state and
<span class="math notranslate nohighlight">\(+\)</span> state on any number of qubits. Therefore, we can represent any quantum state. Normalization might be needed
(e.g., for the CNOT gate) and we perform this by adding complex scalar vertices.</p>
<p>It turns out that the ability to represent an arbitrary state implies the ability to represent an arbitrary linear
map. Using a mathematical result called the Choi-Jamiolkowski isomorphism <a class="footnote-reference brackets" href="#jvdw2020" id="id6">4</a>, for any linear map <span class="math notranslate nohighlight">\(L\)</span>
from <span class="math notranslate nohighlight">\(n\)</span> to <span class="math notranslate nohighlight">\(m\)</span> wires, we can bend the incoming wires to the right and find an equivalent state on
<span class="math notranslate nohighlight">\(n + m\)</span> wires. Thus, any linear map is equivalent to some state, and since we can create any state,
we can create any map! This shows that ZX-diagrams are a universal tool for reasoning about linear maps. But this
doesn’t mean the representation is simple!</p>
<p>For a more in-depth introduction, see <a class="footnote-reference brackets" href="#coecke" id="id7">1</a> and <a class="footnote-reference brackets" href="#jvdw2020" id="id8">4</a>.</p>
</div>
<div class="section" id="zx-calculus-rewriting-rules">
<h2>ZX-calculus: rewriting rules<a class="headerlink" href="#zx-calculus-rewriting-rules" title="Permalink to this headline">¶</a></h2>
<p>ZX-diagrams coupled with rewriting rules form the ZX-calculus. Previously, we presented the rules for composing and
stacking diagrams and talked about the topological symmetries corresponding to deformations. In this section,
we provide rewriting rules that can be used to simplify diagrams without changing the underlying linear map. This can
be very useful for quantum circuit optimization and for showing that some computations have a very simple form in the
ZX framework (e.g., teleportation).</p>
<p>In the following rules, the colours are interchangeable.</p>
<ol class="arabic">
<li><p>Since the X-gate and Z-gate do not commute, non-phaseless vertices of different color do not commute.</p></li>
<li><p>The <strong>fuse</strong> rule applies when two spiders of the same type are connected by one or more wires. We can fuse
spiders by simply adding the two spiders’ phases and removing the connecting wires.</p>
<div class="figure align-center" id="id38">
<a class="reference internal image-reference" href="../_images/f_rule.jpeg"><img alt="../_images/f_rule.jpeg" src="../_images/f_rule.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The (f)use rule.</span><a class="headerlink" href="#id38" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><p>The <span class="math notranslate nohighlight">\(\pi\)</span> <strong>-copy</strong> rule describes how to pull an X-gate through a Z-spider (or a Z-gate through an X-spider).
Since X and Z anticommute, pulling the X-gate through a Z-spider introduces a minus sign into the Z phase.</p>
<div class="figure align-center" id="id39">
<a class="reference internal image-reference" href="../_images/pi_rule.jpeg"><img alt="../_images/pi_rule.jpeg" src="../_images/pi_rule.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The (<span class="math notranslate nohighlight">\(\pi\)</span>)-copy rule.</span><a class="headerlink" href="#id39" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><p>The <strong>state-copy</strong> rule captures how simple one-qubit states interact with a spider of the opposite colour. It
is only valid for states that are multiples of <span class="math notranslate nohighlight">\(\pi\)</span> (therefore <span class="math notranslate nohighlight">\(a\)</span> is an integer), so we have
computational basis states (in the X or Z basis). Basically, if you pull a basis state through a spider of the
opposite color, it copies it onto each outgoing wire.</p>
<div class="figure align-center" id="id40">
<a class="reference internal image-reference" href="../_images/c_rule.jpg"><img alt="../_images/c_rule.jpg" src="../_images/c_rule.jpg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The state (c)opy rule, where <span class="math notranslate nohighlight">\(a\)</span> is an integer.</span><a class="headerlink" href="#id40" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><p>The <strong>identity</strong> rule states that phaseless spiders with one input and one output are equivalent to the identity
and can therefore be removed. This is similar to the rule that Z and X rotation gates, which are phaseless,
are equivalent to the identity. This rule provides a way to get rid of self-loops.</p>
<div class="figure align-center" id="id41">
<a class="reference internal image-reference" href="../_images/id_rule.jpeg"><img alt="../_images/id_rule.jpeg" src="../_images/id_rule.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The (id)entity removal rule.</span><a class="headerlink" href="#id41" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><p>A <strong>bialgebra</strong> is a mathematical structure with a product (combining two wires into one) and a coproduct (
splitting a wire into two wires) where, roughly speaking, we can pull a product through a coproduct at the cost of
doubling. This is similar to the relation enjoyed by the XOR algebra and the COPY coalgebra. This rule is not
straightforward to verify and details can be found in <a class="footnote-reference brackets" href="#jvdw2020" id="id9">4</a> .</p>
<div class="figure align-center" id="id42">
<a class="reference internal image-reference" href="../_images/b_rule.jpg"><img alt="../_images/b_rule.jpg" src="../_images/b_rule.jpg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The (b)ialgebra rule.</span><a class="headerlink" href="#id42" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><p>The <strong>Hopf</strong> rule is a bit like the bialgebra rule, telling us what happens when we try to pull a coproduct
through a product. Instead of doubling, however, they decouple, leaving us with an unconnected projector and a state.
Again, this relation is satisfied by XOR and COPY, and the corresponding algebraic structure is called a Hopf
algebra. This turns out to follow from the bialgebra and the state-copy rule <a class="footnote-reference brackets" href="#jvdw2020" id="id10">4</a>, but it’s useful to record
it as a separate rule.</p>
<div class="figure align-center" id="id43">
<a class="reference internal image-reference" href="../_images/hopf_rule.jpeg"><img alt="../_images/hopf_rule.jpeg" src="../_images/hopf_rule.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The (ho)pf rule.</span><a class="headerlink" href="#id43" title="Permalink to this image">¶</a></p>
</div>
</li>
</ol>
</div>
<div class="section" id="teleportation">
<h2>Teleportation<a class="headerlink" href="#teleportation" title="Permalink to this headline">¶</a></h2>
<p>Now that we have all the necessary tools, let’s see how to describe teleportation as a ZX-diagram and simplify it
with our rewriting rules. The results are surprisingly elegant! We follow the explanation from <a class="footnote-reference brackets" href="#jvdw2020" id="id11">4</a>. You can
find an introduction to teleportation in
<a class="reference external" href="https://pennylane.ai/qml/demos/tutorial_mbqc.html">the MBQC demo</a>.</p>
<p>Teleportation is a protocol for transferring quantum information (a state) from Alice (the sender) to Bob (the
receiver). To perform this, Alice and Bob first need to share a maximally entangled state. The protocol for Alice to send
her quantum state to Bob is as follows:</p>
<ol class="arabic simple">
<li><p>Alice applies the CNOT gate followed by the Hadamard gate.</p></li>
<li><p>Alice measures the two qubits that she has.</p></li>
<li><p>Alice sends the two measurement results to Bob.</p></li>
<li><p>Given the results, Bob conditionally applies the Z- and X-gate to his qubit.</p></li>
<li><p>Bob ends up with the same state as Alice previously had. Teleportation is complete!</p></li>
</ol>
<p>In the ordinary quantum circuit notation, we can summarize the procedure as follows:</p>
<div class="figure align-center" id="id44">
<a class="reference internal image-reference" href="../_images/teleportation_circuit.jpeg"><img alt="../_images/teleportation_circuit.jpeg" src="../_images/teleportation_circuit.jpeg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The teleportation circuit.</span><a class="headerlink" href="#id44" title="Permalink to this image">¶</a></p>
</div>
<p>Let us convert this quantum circuit into a ZX-diagram. The measurements are represented by the state X-spider
parameterized with boolean parameters <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>. The cup represents the maximally entangled
state shared between Alice and Bob. As you might expect from earlier comments about bending wires, their shared state
is Choi-Jamiolkowski-equivalent to the identity linear map.</p>
<p>Let’s simplify the diagram by applying some rewriting rules. The first step is to fuse the <span class="math notranslate nohighlight">\(a\)</span> state with the
X-spider of the CNOT. We also merge the Hadamard gate with the <span class="math notranslate nohighlight">\(\beta\)</span> state, because together it represents a
Z-spider. Then we can fuse the three Z-spiders by simply adding their phases. After that, we see that the Z-spider
phase vanishes (modulo <span class="math notranslate nohighlight">\(2\pi\)</span>) and can therefore be simplified using the identity rule. Then we can fuse the
two X-spiders by adding their phases. We notice that the phase again vanishes modulo <span class="math notranslate nohighlight">\(2\pi\)</span> and we can get rid
of the last X-spider. Teleportation is a simple wire connecting Alice and Bob!</p>
<div class="figure align-center" id="id45">
<a class="reference internal image-reference" href="../_images/teleportation.png"><img alt="../_images/teleportation.png" src="../_images/teleportation.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">The teleportation ZX-diagram simplified from <a class="footnote-reference brackets" href="#jvdw2020" id="id12">4</a> but there is a scalar factor because of a different
scalar convention. You are now able to understand, step by step, the teleportation gif from the beginning of this
tutorial!</span><a class="headerlink" href="#id45" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="the-zxh-calculus">
<h2>The ZXH-calculus<a class="headerlink" href="#the-zxh-calculus" title="Permalink to this headline">¶</a></h2>
<p>The universality of the ZX-calculus does not guarantee the existence of a simple representation, even for simple
linear maps. For example, the Toffoli gate (the quantum AND gate) requires around 25 spiders (Z and X)! We previously
introduced the Hadamard gate as a yellow box, which motivates the introduction of a new generator: the multi-leg H-box,
defined as follows:</p>
<div class="figure align-center" id="id46">
<a class="reference internal image-reference" href="../_images/h_box.jpg"><img alt="../_images/h_box.jpg" src="../_images/h_box.jpg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The H-box, a third generator.</span><a class="headerlink" href="#id46" title="Permalink to this image">¶</a></p>
</div>
<p>The parameter <span class="math notranslate nohighlight">\(a\)</span> can be any complex number, and the sum  is over all <span class="math notranslate nohighlight">\(i_1, ... , i_m, j_1, ... ,
j_n \in \{0, 1\}\)</span>. Therefore, an H-box represents a matrix where its entries are equal to <span class="math notranslate nohighlight">\(1\)</span> except for the
bottom right element, which is <span class="math notranslate nohighlight">\(a\)</span>. This will allow us to concisely express the Toffoli gate, as we will see
shortly.</p>
<p>An H-box with one input wire and one output wire, with <span class="math notranslate nohighlight">\(a=-1\)</span>, is a Hadamard gate up to global phase. Thus,
we omit the parameter when it is equal to <span class="math notranslate nohighlight">\(-1\)</span>. The Hadamard gate is sometimes represented by a blue edge
rather than a box.</p>
<p>Thanks to the introduction of the multi-leg H-box, the Toffoli gate can be represented with three Z-spiders and three
H-boxes — two simple Hadamard gates and one three-ary H-box — as shown below:</p>
<div class="figure align-center" id="id47">
<a class="reference internal image-reference" href="../_images/toffoli.jpg"><img alt="../_images/toffoli.jpg" src="../_images/toffoli.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Toffoli</span><a class="headerlink" href="#id47" title="Permalink to this image">¶</a></p>
</div>
<p>The addition of the multi-leg H-box together with an additional set of rewriting rules forms the ZXH-calculus. You can
find more details and the rewriting rules in the literature <a class="footnote-reference brackets" href="#east2021" id="id13">3</a>.</p>
<p>Let’s show that this ZXH-diagram is indeed a Toffoli-gate. This operation is defined by conditionally applying an
X-gate on the target wire, it means that only the state <span class="math notranslate nohighlight">\(|110\rangle\)</span> and <span class="math notranslate nohighlight">\(|111\rangle\)</span> will not map to
themselves (<span class="math notranslate nohighlight">\(|110\rangle\)</span> to <span class="math notranslate nohighlight">\(|111\rangle\)</span> and <span class="math notranslate nohighlight">\(|111\rangle\)</span> to <span class="math notranslate nohighlight">\(|110\rangle\)</span>). We will show that if
one provides the state <span class="math notranslate nohighlight">\(|11\rangle\)</span> on the two first wires, it results to a bit flip on the third wire (X-gate).
For that purpose, we need to add a new rewriting rule that is part of the ZXH-calculus: the <strong>absorb</strong> rule.</p>
<div class="figure align-center" id="id48">
<a class="reference internal image-reference" href="../_images/absorb.jpg"><img alt="../_images/absorb.jpg" src="../_images/absorb.jpg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The (ab)sorb rule.</span><a class="headerlink" href="#id48" title="Permalink to this image">¶</a></p>
</div>
<p>We start by applying our Toffoli diagram on a <span class="math notranslate nohighlight">\(|11\rangle\)</span> state, which corresponds to two X-spiders with a phase
of <span class="math notranslate nohighlight">\(\pi\)</span> stacked with our diagram. We apply the copy rule on the two groups of X-spiders and Z-spiders on the
wires 0 and 1. After that we can apply the newly introduced absorb rule on one of the X-spiders connected to the
H-Box. Then we recognize the Fourier relation and can replace the X-spider and H-Box by a Z-spider. Then it is easy
to apply the fuse rule on the two Z-spiders. Again, we recognize the Fourier relation and obtain a single X-spider on
the target wire. We just proved that by providing the <span class="math notranslate nohighlight">\(|11\rangle\)</span> state on the two control wires,
it always applies an X-spider on the target. It means that we have a bit flip on the target.</p>
<div class="figure align-center" id="id49">
<a class="reference internal image-reference" href="../_images/11ccnot.jpg"><img alt="../_images/11ccnot.jpg" src="../_images/11ccnot.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Toffoli-diagram applied on the <span class="math notranslate nohighlight">\(|11\rangle\)</span> state.</span><a class="headerlink" href="#id49" title="Permalink to this image">¶</a></p>
</div>
<p>If you do the same procedure with the others states on the two controls (<span class="math notranslate nohighlight">\(|00\rangle\)</span>, <span class="math notranslate nohighlight">\(|11\rangle\)</span>,
<span class="math notranslate nohighlight">\(|10\rangle\)</span>, <span class="math notranslate nohighlight">\(|01\rangle\)</span>) with slightly different rules (the explosion rule), you will always end up with
an empty target and identical states for the controls. We then have proved that our ZXH-diagram is indeed the Toffoli
gate!</p>
</div>
<div class="section" id="the-zx-calculus-for-quantum-machine-learning">
<h2>The ZX-calculus for quantum machine learning<a class="headerlink" href="#the-zx-calculus-for-quantum-machine-learning" title="Permalink to this headline">¶</a></h2>
<p>We now move away from the standard use of the ZX-calculus in order to show its utility for calculus and,
more specifically, for quantum derivatives (<a class="reference external" href="https://pennylane.ai/qml/glossary/parameter_shift.html">the parameter-shift rule</a>). What follows is not implemented in PennyLane or PyZX.
By adding derivatives to the framework, it shows that the ZX-calculus has a role to play in analyzing quantum machine
learning problems. After reading this section, you should be convinced that the ZX-calculus can be used to study any
kind of quantum-related problem.</p>
<p>Indeed, not only is the ZX-calculus useful for representing and simplifying quantum circuits, but it was shown that we
can use it to represent gradients and integrals of parameterized quantum circuits <a class="footnote-reference brackets" href="#zhao2021" id="id14">5</a> . In this section,
we will follow the proof of the theorem that shows how the derivative of the expectation value of a Hamiltonian
given a parameterized state can be derived as a ZX-diagram (theorem 2 of Zhao et al. <a class="footnote-reference brackets" href="#zhao2021" id="id15">5</a>). We will also show
that the theorem can be used to prove the parameter-shift rule!</p>
<div class="section" id="partial-derivative-as-a-zx-diagram">
<h3>Partial derivative as a ZX-diagram<a class="headerlink" href="#partial-derivative-as-a-zx-diagram" title="Permalink to this headline">¶</a></h3>
<p>Let’s first describe the problem. Without loss of generalization, let’s suppose that we begin with the pure state
<span class="math notranslate nohighlight">\(|0\rangle\)</span> on all <span class="math notranslate nohighlight">\(n\)</span> qubits. Then we apply a parameterized unitary <span class="math notranslate nohighlight">\(U\)</span> that depends on <span class="math notranslate nohighlight">\(\vec{
\theta}=(\theta_1, ..., \theta_m)\)</span>, where <span class="math notranslate nohighlight">\(\theta_i \in [0, 2\pi]\)</span>.</p>
<p>Consequently, the expectation value of a Hamiltonian <span class="math notranslate nohighlight">\(H\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\langle H \rangle = \langle 0 | U(\vec{\theta}) H U(\vec{\theta})^{\dagger} |0 \rangle.\]</div>
<p>We have seen that any circuit can be represented by a ZX diagram, but once again, we want to use the graph-like form
(see the Graph optimization and circuit extraction section). There are multiple rules that ensure the transformation
to a graph-like diagram. We replace the 0 state by red phaseless spiders, and we transform the parameterized circuit
to its graph-like ZX diagram. We call the obtained diagram <span class="math notranslate nohighlight">\(G_U(\vec{\theta})\)</span>, this diagram is equal to
the unitary up to a constant <span class="math notranslate nohighlight">\(c\)</span>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/hamiltonian_diagram.jpg"><img alt="../_images/hamiltonian_diagram.jpg" src="../_images/hamiltonian_diagram.jpg" style="width: 100%;" /></a>
</div>
<p>Now we will investigate the partial derivative of the diagram representing the expectation value. The theorem is
the following:</p>
<div class="figure align-center" id="id50">
<a class="reference internal image-reference" href="../_images/theorem2.jpg"><img alt="../_images/theorem2.jpg" src="../_images/theorem2.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Theorem 2: The derivative of the expectation value of a Hamiltonian given a parameterized as a ZX-diagram.</span><a class="headerlink" href="#id50" title="Permalink to this image">¶</a></p>
</div>
<p>Let’s prove theorem 2, and first we consider a partial derivative on the spider with respect to <span class="math notranslate nohighlight">\(\theta_j\)</span>. The
spider necessarily appears on both sides, but they have phases of opposite signs and inverse inputs/outputs. By simply
writing their definitions and expanding the formula, we obtain:</p>
<div class="figure align-center" id="id51">
<a class="reference internal image-reference" href="../_images/symmetric_spiders.jpg"><img alt="../_images/symmetric_spiders.jpg" src="../_images/symmetric_spiders.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Two Z-spiders depending on the <span class="math notranslate nohighlight">\(j\)</span>-th angle.</span><a class="headerlink" href="#id51" title="Permalink to this image">¶</a></p>
</div>
<p>Now we have a simple formula where we can easily take the derivative:</p>
<div class="figure align-center" id="id52">
<a class="reference internal image-reference" href="../_images/derivative_symmetric_spiders.jpg"><img alt="../_images/derivative_symmetric_spiders.jpg" src="../_images/derivative_symmetric_spiders.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">The derivative of two spiders depending on the <span class="math notranslate nohighlight">\(j\)</span>-th angle.</span><a class="headerlink" href="#id52" title="Permalink to this image">¶</a></p>
</div>
<p>The theorem 2 is proved — we just expressed the partial derivative as a ZX-diagram!</p>
</div>
<div class="section" id="parameter-shift-rule-as-a-zx-diagram">
<h3>Parameter-shift rule as a ZX-diagram<a class="headerlink" href="#parameter-shift-rule-as-a-zx-diagram" title="Permalink to this headline">¶</a></h3>
<p>This theorem can be used to prove the parameter-shift rule. Let’s consider the following ansatz that we transform to
its graph-like diagram.</p>
<div class="figure align-center" id="id53">
<a class="reference internal image-reference" href="../_images/param_shift_1_0.jpg"><img alt="../_images/param_shift_1_0.jpg" src="../_images/param_shift_1_0.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">The circuit (on the left) is translated to a ZX-diagram.</span><a class="headerlink" href="#id53" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id54">
<a class="reference internal image-reference" href="../_images/param_shift_1_1.jpg"><img alt="../_images/param_shift_1_1.jpg" src="../_images/param_shift_1_1.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">The whole circuit is translated to a graph-like ZX-diagram.</span><a class="headerlink" href="#id54" title="Permalink to this image">¶</a></p>
</div>
<p>We then apply the previous theorem to get the partial derivative relative to <span class="math notranslate nohighlight">\(\theta_1\)</span>.</p>
<div class="figure align-center" id="id55">
<a class="reference internal image-reference" href="../_images/param_shift_1_2.jpg"><img alt="../_images/param_shift_1_2.jpg" src="../_images/param_shift_1_2.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">The derivative is applied on the ZX-diagram</span><a class="headerlink" href="#id55" title="Permalink to this image">¶</a></p>
</div>
<p>The second step is to take the X-spider with phase <span class="math notranslate nohighlight">\(\pi\)</span> and explicitly write the formula <span class="math notranslate nohighlight">\(|+\rangle\langle +|
- |-\rangle \langle -|\)</span>. We can then separate the diagram into two parts by recalling the definition of the <span class="math notranslate nohighlight">\(|+\rangle\)</span>
(phaseless Z-spider) and <span class="math notranslate nohighlight">\(|- \rangle\)</span> (<span class="math notranslate nohighlight">\(2\pi\)</span> Z-spider) states and using the fusion rule for the Z-spider.
We obtain the parameter-shift rule!</p>
<div class="figure align-center" id="id56">
<a class="reference internal image-reference" href="../_images/param_shift_2.jpg"><img alt="../_images/param_shift_2.jpg" src="../_images/param_shift_2.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">By using theorem 2, we can add an X-spider and shift the phases in the Z-spiders. Then, by explicitly decomposing
the spider with the <span class="math notranslate nohighlight">\(|+\rangle\)</span> and <span class="math notranslate nohighlight">\(|-\rangle\)</span>  states, we prove the parameter-shift rule!</span><a class="headerlink" href="#id56" title="Permalink to this image">¶</a></p>
</div>
<p>You can find more information about the differentiation and integration of ZX-diagrams with QML applications in the
following paper <a class="footnote-reference brackets" href="#wang2022" id="id16">6</a>.</p>
</div>
</div>
<div class="section" id="zx-diagrams-with-pennylane">
<h2>ZX-diagrams with PennyLane<a class="headerlink" href="#zx-diagrams-with-pennylane" title="Permalink to this headline">¶</a></h2>
<p>Now that we have introduced the formalism of the ZX-calculus, let’s dive into some code and show what you can do with
PennyLane! PennyLane v0.28 added ZX-calculus functionality to the fold. You can use the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.transforms.to_zx.html#pennylane.transforms.to_zx" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_zx()</span></code></a> transform decorator to get a ZX-diagram from a PennyLane
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QNode</span></code></a>, while <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.transforms.from_zx.html#pennylane.transforms.from_zx" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_zx()</span></code></a> transforms a ZX-diagram into a PennyLane
tape. We are using the PyZX library <a class="footnote-reference brackets" href="#pyzx" id="id17">2</a> under the hood to represent the ZX diagram. Once your circuit is a PyZX
graph, you can draw it, apply some optimization, extract the underlying circuit, and go back to PennyLane.</p>
<p>Let’s start with a very simple circuit consisting of three gates and show that you can represent the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QNode</span></code></a> as a PyZX diagram:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">import</span> <span class="nn">pyzx</span>

<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">to_zx</span>
<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">circuit</span><span class="p">():</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliY.html#pennylane.PauliY" title="pennylane.PauliY" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliY</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">0</span><span class="p">))</span>


<span class="n">g</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">()</span>
</pre></div>
</div>
<p>Now that you have a ZX-diagram as a PyZx object, you can use all the tools from the PyZX library to transform the
graph. You can simplify the circuit, draw it, and get a new understanding of your quantum computation.</p>
<p>For example, you can use the matplotlib drawer to get a visualization of the diagram. The drawer returns a
<code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> figure, and therefore you can save it locally with <code class="docutils literal notranslate"><span class="pre">savefig</span></code> function, or simply show it locally.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pyzx</span><span class="o">.</span><span class="n">draw_matplotlib</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="c1"># The following lines are added because the figure is automatically closed by PyZX.</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span>
<span class="n">manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="n">manager</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_zx_calculus_001.png" srcset="../_images/sphx_glr_tutorial_zx_calculus_001.png" alt="tutorial zx calculus" class = "sphx-glr-single-img"/><p>You can also take a ZX-diagram in PyZX, convert it into a PennyLane tape and use it in your
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QNode</span></code></a>. Invoking the PyZX circuit generator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">random_circuit</span> <span class="o">=</span> <span class="n">pyzx</span><span class="o">.</span><span class="n">generate</span><span class="o">.</span><span class="n">CNOT_HAD_PHASE_circuit</span><span class="p">(</span><span class="n">qubits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_circuit</span><span class="o">.</span><span class="n">stats</span><span class="p">())</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">random_circuit</span><span class="o">.</span><span class="n">to_graph</span><span class="p">()</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.tape.QuantumScript.html#pennylane.tape.QuantumScript" title="pennylane.tape.QuantumScript" class="sphx-glr-backref-module-pennylane-tape sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tape</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.transforms.from_zx.html#pennylane.transforms.from_zx" title="pennylane.transforms.from_zx" class="sphx-glr-backref-module-pennylane-transforms sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">from_zx</span></a><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.tape.QuantumScript.html#pennylane.tape.QuantumScript.operations" title="pennylane.tape.QuantumScript.operations" class="sphx-glr-backref-module-pennylane-tape sphx-glr-backref-type-py-attribute"><span class="n">tape</span><span class="o">.</span><span class="n">operations</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Circuit  on 3 qubits with 10 gates.
        4 is the T-count
        6 Cliffords among which
        5 2-qubit gates (5 CNOT, 0 other) and
        1 Hadamard gates.
[T(wires=[0]), T(wires=[0]), CNOT(wires=[2, 0]), T(wires=[2]), CNOT(wires=[1, 0]), CNOT(wires=[0, 2]), T(wires=[2]), Hadamard(wires=[0]), CNOT(wires=[2, 1]), CNOT(wires=[2, 1])]
</pre></div>
</div>
<p>We get a tape corresponding to the randomly generated circuit that we can use in any <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QNode</span></code></a>. This
functionality will be very useful for our next topic: circuit optimization.</p>
</div>
<div class="section" id="diagram-optimization-and-circuit-extraction">
<h2>Diagram optimization and circuit extraction<a class="headerlink" href="#diagram-optimization-and-circuit-extraction" title="Permalink to this headline">¶</a></h2>
<p>The ZX-calculus is more general and more flexible than the usual circuit representation. We can therefore represent
circuits with ZX-diagrams and apply rewriting rules to simplify them — like we did for teleportation. But, not every
ZX-diagram has a corresponding circuit. To get back to circuits, a method for circuit extraction is needed. For
a rigorous introduction to this active and promising field of application, see <a class="footnote-reference brackets" href="#duncan2020" id="id18">7</a>. The basic idea is
captured below:</p>
<div class="figure align-center" id="id57">
<a class="reference internal image-reference" href="../_images/circuit_opt.jpg"><img alt="../_images/circuit_opt.jpg" src="../_images/circuit_opt.jpg" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">The simplification and extraction of ZX-diagrams, content from page 2 of <a class="footnote-reference brackets" href="#duncan2020" id="id19">7</a>.</span><a class="headerlink" href="#id57" title="Permalink to this image">¶</a></p>
</div>
<p>To simplify ZX-diagrams, not only can we use the rewriting rules defined previously, but we can also use graph-theoretic
transformations called local complementation and pivoting. These are special transformations that can only be
applied to “graph-like” ZX-diagrams. As defined in <a class="footnote-reference brackets" href="#duncan2020" id="id20">7</a>, a ZX-diagram is graph-like if</p>
<ol class="arabic simple">
<li><p>All spiders are Z-spiders.</p></li>
<li><p>Z-spiders are only connected via Hadamard edges.</p></li>
<li><p>There are no parallel Hadamard edges or self-loops.</p></li>
<li><p>Every input or output is connected to a Z-spider and every Z-spider is connected to at most one input or output.</p></li>
</ol>
<p>A ZX-diagram is called a graph state if it is graph-like: every spider is connected to an output and there are no
phaseless spiders. Furthermore, it was proved that every ZX-diagram is equal to a graph-like ZX-diagram. Thus,
after conversion into graph-like form, we can use graph-theoretic tools on all ZX-diagrams.</p>
<p>The basic idea is to use the graph-theoretic transformations to get rid of as many interior spiders as possible.
Interior spiders are the one without inputs or outputs connected to them. We introduce some names for the spiders
depending on their phases:</p>
<ol class="arabic simple">
<li><p>A Pauli spider has a phase that is a multiple of <span class="math notranslate nohighlight">\(\pi\)</span>.</p></li>
<li><p>A Clifford spider has a phase that is a multiple of <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span>.</p></li>
<li><p>A proper Clifford spider is a Clifford spider with a phase which is an odd multiple of <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span>.</p></li>
</ol>
<p>Theorem 5.4 in <a class="footnote-reference brackets" href="#duncan2020" id="id21">7</a> provides an algorithm which takes a graph-like diagram and performs the following:</p>
<ol class="arabic simple">
<li><p>Remove all interior proper Clifford spiders,</p></li>
<li><p>Remove adjacent pairs of interior Pauli spiders,</p></li>
<li><p>Remove interior Pauli spiders adjacent to a boundary spider.</p></li>
</ol>
<p>This procedure is implemented in PyZX as the <code class="xref py py-func docutils literal notranslate"><span class="pre">full_reduce()</span></code> function. The complexity of the procedure is
<span class="math notranslate nohighlight">\(\mathcal{O}(n^3)\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is the number of spiders. Let’s create an example with the circuit
<a class="reference external" href="https://github.com/njross/optimizer/blob/master/Arithmetic_and_Toffoli/mod5_4_before">mod_5_4</a>. The circuit
<span class="math notranslate nohighlight">\(63\)</span> gates: <span class="math notranslate nohighlight">\(28\)</span> <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">T</span></code></a>. gates, <span class="math notranslate nohighlight">\(28\)</span> <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CNOT</span></code></a>, <span class="math notranslate nohighlight">\(6\)</span>
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hadamard</span></code></a> and <span class="math notranslate nohighlight">\(1\)</span> <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">PauliX</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">to_zx</span>
<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mod_5_4</span><span class="p">():</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="pennylane.PauliX" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="pennylane.T" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">T</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="pennylane.CNOT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">0</span><span class="p">))</span>


<span class="n">g</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mod_5_4</span></a><span class="p">()</span>
<span class="n">pyzx</span><span class="o">.</span><span class="n">simplify</span><span class="o">.</span><span class="n">full_reduce</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">pyzx</span><span class="o">.</span><span class="n">draw_matplotlib</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="c1"># The following lines are added because the figure is automatically closed by PyZX.</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span>
<span class="n">manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_canvas</span><span class="p">(</span><span class="n">manager</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_zx_calculus_002.png" srcset="../_images/sphx_glr_tutorial_zx_calculus_002.png" alt="tutorial zx calculus" class = "sphx-glr-single-img"/><p>We see that after applying the procedure, we end up with only 16 interior Z-spiders and 5 boundary spiders. We also
see that all non-Clifford phases appear on the interior spiders. The simplification procedure was successful,
but we have a graph-like ZX-diagram with no quantum circuit equivalent. We need to extract a circuit!</p>
<p>The extraction of circuits is a highly non-trivial task and can be a #P-hard problem as shown in this paper <a class="footnote-reference brackets" href="#beaudrap2021" id="id22">9</a> by de Beaudrap et al . There are
two different algorithms introduced in the same paper. First, for Clifford circuits, the procedure will erase all
interior spiders, and the diagram is left in a graph-state from which a Clifford circuit can be
extracted using a total of eight layers with only one layer of CNOTs.</p>
<p>For non-Clifford circuits, the problem is more complex because we are left with non-Clifford interior spiders. From
the diagram produced by the simplification procedure, the extraction progresses through the diagram from
right-to-left, consuming gates on the left and adding gates on the right. It produces better results than other
cut-and-resynthesize techniques. The extraction procedure is implemented in PyZX as the function
<code class="docutils literal notranslate"><span class="pre">pyzx.circuit.extract_circuit</span></code>. We can apply this procedure to the example <cite>mod_5_4</cite> above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_extracted</span> <span class="o">=</span> <span class="n">pyzx</span><span class="o">.</span><span class="n">extract_circuit</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circuit_extracted</span><span class="o">.</span><span class="n">stats</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Circuit  on 5 qubits with 56 gates.
        8 is the T-count
        48 Cliffords among which
        22 2-qubit gates (0 CNOT, 22 other) and
        26 Hadamard gates.
</pre></div>
</div>
<div class="section" id="example-t-count-optimization">
<h3>Example: T-count optimization<a class="headerlink" href="#example-t-count-optimization" title="Permalink to this headline">¶</a></h3>
<p>A concrete application of these ZX optimization techniques is the reduction of the expensive non-Clifford T-count
of a quantum circuit. Indeed, T-count optimization is an area where the ZX-calculus has shown very good results <a class="footnote-reference brackets" href="#kissinger2021" id="id23">8</a> .</p>
<p>Let’s start by using with the <cite>mod_5_4</cite> circuit introduced above. We applied the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.transforms.to_zx.html#pennylane.transforms.to_zx" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_zx()</span></code></a>
decorator in order to transform our circuit to a ZX graph. You can get this PyZX graph by calling the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QNode</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mod_5_4</span></a><span class="p">()</span>
<span class="n">t_count</span> <span class="o">=</span> <span class="n">pyzx</span><span class="o">.</span><span class="n">tcount</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T count before optimization:&quot;</span><span class="p">,</span> <span class="n">t_count</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>T count before optimization: 28
</pre></div>
</div>
<p>PyZX gives multiple options for optimizing ZX graphs: <code class="xref py py-func docutils literal notranslate"><span class="pre">full_reduce()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">teleport_reduce()</span></code>
to name a couple. The <code class="xref py py-func docutils literal notranslate"><span class="pre">full_reduce()</span></code> applies all optimization passes, but the final result may not be
circuit-like. Converting back to a quantum circuit from a fully reduced graph might be difficult or impossible.
Therefore, we instead recommend using <code class="xref py py-func docutils literal notranslate"><span class="pre">teleport_reduce()</span></code>, as it preserves the diagram structure.
Because of this, the circuit does not need to be extracted and can be directly sent back to PennyLane. Let’s see
how it works:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">pyzx</span><span class="o">.</span><span class="n">simplify</span><span class="o">.</span><span class="n">teleport_reduce</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="n">opt_t_count</span> <span class="o">=</span> <span class="n">pyzx</span><span class="o">.</span><span class="n">tcount</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T count after optimization:&quot;</span><span class="p">,</span> <span class="n">opt_t_count</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>T count after optimization: 8
</pre></div>
</div>
<p>The <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.transforms.from_zx.html#pennylane.transforms.from_zx" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_zx()</span></code></a> transform converts the optimized circuit back into PennyLane format,
and which is made possible because we used <cite>pyzx.teleport_reduce</cite> and do not need to extract
the circuit.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.tape.QuantumScript.html#pennylane.tape.QuantumScript" title="pennylane.tape.QuantumScript" class="sphx-glr-backref-module-pennylane-tape sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qscript_opt</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.transforms.from_zx.html#pennylane.transforms.from_zx" title="pennylane.transforms.from_zx" class="sphx-glr-backref-module-pennylane-transforms sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">from_zx</span></a><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">wires</span><span class="o">.</span><span class="n">Wires</span></a><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">wires_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qscript_opt</span><span class="o">.</span><span class="n">wires</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="p">))</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.tape.QuantumScript.html#pennylane.tape.QuantumScript" title="pennylane.tape.QuantumScript" class="sphx-glr-backref-module-pennylane-tape sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qscript_opt_reorder</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.map_wires.html#pennylane.map_wires" title="pennylane.map_wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">map_wires</span></a><span class="p">(</span><span class="nb">input</span><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.tape.QuantumScript.html#pennylane.tape.QuantumScript" title="pennylane.tape.QuantumScript" class="sphx-glr-backref-module-pennylane-tape sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qscript_opt</span></a><span class="p">,</span> <span class="n">wire_map</span><span class="o">=</span><span class="n">wires_map</span><span class="p">)</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mod_5_4</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.tape.QuantumScript.html#pennylane.tape.QuantumScript" title="pennylane.tape.QuantumScript" class="sphx-glr-backref-module-pennylane-tape sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qscript_opt_reorder</span></a><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.apply.html#pennylane.apply" title="pennylane.apply" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">apply</span></a><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliZ.html#pennylane.PauliZ" title="pennylane.PauliZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.wires.Wires.html#pennylane.wires.Wires" title="pennylane.wires.Wires" class="sphx-glr-backref-module-pennylane-wires sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">wires</span></a><span class="o">=</span><span class="mi">0</span><span class="p">))</span>


<span class="n">specs</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.specs.html#pennylane.specs" title="pennylane.specs" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">specs</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mod_5_4</span></a><span class="p">)()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of quantum gates:&quot;</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s2">&quot;num_operations&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit gates:&quot;</span><span class="p">,</span> <span class="n">specs</span><span class="p">[</span><span class="s2">&quot;gate_types&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of quantum gates: 53
Circuit gates: defaultdict(&lt;class &#39;int&#39;&gt;, {&#39;PauliX&#39;: 1, &#39;Hadamard&#39;: 6, &#39;CNOT&#39;: 28, &#39;T&#39;: 4, &#39;S&#39;: 6, &#39;Adjoint(T)&#39;: 4, &#39;Adjoint(S)&#39;: 4})
</pre></div>
</div>
<p>We have reduced the T-count! Taking a full census, the circuit contains <span class="math notranslate nohighlight">\(53\)</span> gates: <span class="math notranslate nohighlight">\(8\)</span>
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.T.html#pennylane.T" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">T</span></code></a> gates, <span class="math notranslate nohighlight">\(28\)</span> <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CNOT</span></code></a>, <span class="math notranslate nohighlight">\(6\)</span> <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hadamard</span></code></a>,
<span class="math notranslate nohighlight">\(1\)</span> <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">PauliX</span></code></a> and <span class="math notranslate nohighlight">\(10\)</span> <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.S.html#pennylane.S" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">S</span></code></a>. We successfully reduced the T-count by
20 and have 10 additional <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.S.html#pennylane.S" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">S</span></code></a> gates. The number of <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CNOT.html#pennylane.CNOT" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CNOT</span></code></a> gates remained the
same.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Now that you have read this tutorial, you should be able to use the ZX-calculus to solve your quantum problems.
You can describe quantum circuits with the ZX-spiders and the H-box and create ZXH-diagrams.
Furthermore, you can use the simplifying rules to get another view of the underlying structure of your
circuit. We have proved its utility for optimizing quantum circuits and shown that the
ZX-calculus is more than promising for quantum machine learning. It was not covered in this introduction, but the
ZX-calculus can also be used for quantum-error correction — it’s no wonder why some quantum physicists
call ZX-calculus the “Swiss army knife” of quantum computing tools!</p>
</div>
<div class="section" id="acknowledgement">
<h2>Acknowledgement<a class="headerlink" href="#acknowledgement" title="Permalink to this headline">¶</a></h2>
<p>The author would also like to acknowledge the helpful inputs of Richard East, David Wakeham and Isaac De Vlugt. The
author is also thankful for the beautiful drawings by Guillermo Alonso and for the great thumbnail and teleportation
gif by Tarik El-Khateeb.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="coecke"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id7">2</a>)</span></dt>
<dd><p>Bob Coecke and Ross Duncan. “Interacting Quantum Observables: Categorical Algebra and Diagrammatics.”
<a class="reference external" href="https://arxiv.org/pdf/0906.4725.pdf">ArXiv</a>.</p>
</dd>
<dt class="label" id="pyzx"><span class="brackets">2</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id17">2</a>)</span></dt>
<dd><p>John van de Wetering. “PyZX.”
<a class="reference external" href="https://github.com/Quantomatic/pyzx">PyZX GitHub</a>.</p>
</dd>
<dt class="label" id="east2021"><span class="brackets">3</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id5">2</a>,<a href="#id13">3</a>)</span></dt>
<dd><p>Richard D. P. East, John van de Wetering, Nicholas Chancellor and Adolfo G. Grushin. “AKLT-states as ZX-diagrams:
diagrammatic reasoning for quantum states.”
<a class="reference external" href="https://arxiv.org/pdf/2012.01219.pdf">ArXiv</a>.</p>
</dd>
<dt class="label" id="jvdw2020"><span class="brackets">4</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id6">2</a>,<a href="#id8">3</a>,<a href="#id9">4</a>,<a href="#id10">5</a>,<a href="#id11">6</a>,<a href="#id12">7</a>)</span></dt>
<dd><p>John van de Wetering. “ZX-calculus for the working quantum computer scientist.”
<a class="reference external" href="https://arxiv.org/abs/2012.13966">ArXiv</a>.</p>
</dd>
<dt class="label" id="zhao2021"><span class="brackets">5</span><span class="fn-backref">(<a href="#id14">1</a>,<a href="#id15">2</a>)</span></dt>
<dd><p>Chen Zhao and Xiao-Shan Gao. “Analyzing the barren plateau phenomenon in training quantum neural networks with the
ZX-calculus” <a class="reference external" href="https://quantum-journal.org/papers/q-2021-06-04-466/pdf/">Quantum Journal</a>.</p>
</dd>
<dt class="label" id="wang2022"><span class="brackets"><a class="fn-backref" href="#id16">6</a></span></dt>
<dd><p>Quanlong Wang, Richie Yeung, and Mark Koch. “Differentiating and Integrating ZX Diagrams with Applications to
Quantum Machine Learning” <a class="reference external" href="https://arxiv.org/pdf/2201.13250.pdf">Quantum Journal</a>.</p>
</dd>
<dt class="label" id="duncan2020"><span class="brackets">7</span><span class="fn-backref">(<a href="#id18">1</a>,<a href="#id19">2</a>,<a href="#id20">3</a>,<a href="#id21">4</a>)</span></dt>
<dd><p>Ross Duncan, Aleks Kissinger, Simon Perdrix, and John van de Wetering. “Graph-theoretic Simplification of Quantum
Circuits with the ZX-calculus.”
<a class="reference external" href="https://quantum-journal.org/papers/q-2020-06-04-279/pdf/">Quantum Journal</a>.</p>
</dd>
<dt class="label" id="kissinger2021"><span class="brackets"><a class="fn-backref" href="#id23">8</a></span></dt>
<dd><p>Aleks Kissinger and John van de Wetering. “Reducing T-count with the ZX-calculus.”
<a class="reference external" href="https://arxiv.org/pdf/1903.10477.pdf">ArXiv</a>.</p>
</dd>
<dt class="label" id="beaudrap2021"><span class="brackets"><a class="fn-backref" href="#id22">9</a></span></dt>
<dd><p>Niel de Beaudrap, Aleks Kissinger and John van de Wetering. “Circuit Extraction for ZX-diagrams can be #P-hard.”
<a class="reference external" href="https://arxiv.org/pdf/2202.09194.pdf">ArXiv</a>.</p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/romain_moyard.jpg" alt="Romain Moyard" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Romain Moyard</h4>
        <p class="bio-text__author-description">Romain is currently a quantum software developer at Xanadu working on PennyLane. He works on developing useful quantum machine learning tools.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.300 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-zx-calculus-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/4a39d47dd612a96c07204201b9e5236d/tutorial_zx_calculus.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_zx_calculus.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/d913bce2702a22d99c343e1508db0923/tutorial_zx_calculus.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_zx_calculus.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_zx_calculus</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Introduction to the ZX-calculus</a><ul class='current'>
<li class='current'><a class="reference internal" href="#zx-diagrams">ZX-diagrams</a></li>
<li class='current'><a class="reference internal" href="#zx-calculus-rewriting-rules">ZX-calculus: rewriting rules</a></li>
<li class='current'><a class="reference internal" href="#teleportation">Teleportation</a></li>
<li class='current'><a class="reference internal" href="#the-zxh-calculus">The ZXH-calculus</a></li>
<li class='current'><a class="reference internal" href="#the-zx-calculus-for-quantum-machine-learning">The ZX-calculus for quantum machine learning</a><ul class='current'>
<li class='current'><a class="reference internal" href="#partial-derivative-as-a-zx-diagram">Partial derivative as a ZX-diagram</a></li>
<li class='current'><a class="reference internal" href="#parameter-shift-rule-as-a-zx-diagram">Parameter-shift rule as a ZX-diagram</a></li>
</ul>
</li>
<li class='current'><a class="reference internal" href="#zx-diagrams-with-pennylane">ZX-diagrams with PennyLane</a></li>
<li class='current'><a class="reference internal" href="#diagram-optimization-and-circuit-extraction">Diagram optimization and circuit extraction</a><ul class='current'>
<li class='current'><a class="reference internal" href="#example-t-count-optimization">Example: T-count optimization</a></li>
</ul>
</li>
<li class='current'><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li class='current'><a class="reference internal" href="#acknowledgement">Acknowledgement</a></li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_zx_calculus</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_quantum-computing.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial_pulse_programming101.html" title="Differentiable pulse programming with qubits in PennyLane"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_mbqc.html" title="Measurement-based quantum computation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-computing.html" >Quantum Computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Introduction to the ZX-calculus</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>