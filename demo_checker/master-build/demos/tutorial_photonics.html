
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Learn how photonic quantum computers work through code" property="og:description" />
<meta content="https://pennylane.ai/qml/_images/photonics_tn.png" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Photonic quantum computers &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_photonics.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Learn how photonic quantum computers work through code" property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Photonic quantum computers &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_photonics.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modeling the toric code on a quantum computer" href="tutorial_toric_code.html" />
    <link rel="prev" title="Quantum computing with superconducting qubits" href="tutorial_sc_qubits.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial_toric_code.html" title="Modeling the toric code on a quantum computer"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_sc_qubits.html" title="Quantum computing with superconducting qubits"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-computing.html" accesskey="U">Quantum Computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Photonic quantum computers</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-demos-tutorial-photonics-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="photonic-quantum-computers">
<span id="photonics"></span><span id="sphx-glr-demos-tutorial-photonics-py"></span><h1>Photonic quantum computers<a class="headerlink" href="#photonic-quantum-computers" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = ["tutorial_pasqal.html", "tutorial_trapped_ions.html", "tutorial_sc_qubits.html", "gbs.html"];
    var related_tutorials_titles = ['Quantum computation with neutral atoms', 'Trapped ion quantum computing', 'Quantum computing with superconducting qubits', 'Quantum advantage with Gaussian Boson Sampling'];
</script></p>
<p><em>Author: Alvaro Ballon — Posted: 31 May 2022. Last updated: 16 June 2022.</em></p>
<p>To create a functional quantum computer, we need to produce and control a
large number of qubits. This feat has proven difficult, although significant
progress has been made using trapped ions, superconducting circuits,
and many other technologies. Scalability—the ability to put many
qubits together—is limited because individual qubits in a multi-qubit
system lose their quantum properties quickly. This phenomenon,
known as decoherence, happens due to the interactions of the qubits with
their surroundings. One way to get scalable structures is to
use photons (particles of light). The quantum states of photons
are more robust against decoherence, so we may be onto something!</p>
<p>Indeed, many approaches to use photons for quantum
computing have been proposed. We will focus on <em>linear optical quantum computing</em>,
an approach that has already achieved quantum advantage. It
is being developed further by Xanadu, PsiQuantum, and other institutions
around the globe. Unlike other physical systems, photonics allows us access to
an infinite number of states. How can we leverage these extra states to make quantum computers?
By the end of this demo, you will be able to explain how photonic
devices can be used to build universal quantum computers. You will learn how to prepare,
measure, and manipulate the quantum states of light, and how we can encode
qubits in photons. Moreover, you will identify
the strengths and weaknesses of photonic devices in terms of
Di Vincenzo’s criteria, introduced in the blue box below.</p>
<div class="alert alert-block alert-info docutils container">
<p><strong>Di Vincenzo’s criteria</strong>: In the year 2000, David DiVincenzo proposed a
wishlist for the experimental characteristics of a quantum computer <a class="footnote-reference brackets" href="#divincenzo2000" id="id1">1</a>.
DiVincenzo’s criteria have since become the main guideline for
physicists and engineers building quantum computers:</p>
<p>1. <strong>Well-characterized and scalable qubits</strong>. Many of the quantum systems that
we find in nature are not qubits, so we must find a way to make them behave as such.
Moreover, we need to put many of these systems together.</p>
<p>2. <strong>Qubit initialization</strong>. We must be able to prepare the same state repeatedly within
an acceptable margin of error.</p>
<p>3. <strong>Long coherence times</strong>. Qubits will lose their quantum properties after
interacting with their environment for a while. We would like them to last long
enough so that we can perform quantum operations.</p>
<p>4. <strong>Universal set of gates</strong>. We need to perform arbitrary operations on the
qubits. To do this, we require both single-qubit gates and two-qubit gates.</p>
<p>5. <strong>Measurement of individual qubits</strong>. To read the result of a quantum algorithm,
we must accurately measure the final state of a pre-chosen set of qubits.</p>
</div>
<p>Our journey will start by defining the simplest states of light, known as <em>Gaussian states</em>. We will also
describe how we can perform simple gates and measurements on such states. The next step is to
figure out reliable methods to generate the more general <em>non-Gaussian</em> states that are required for universal
quantum computing. We’ll see that we end up needing only
a special type of non-Gaussian states, known as GKP states.
Finally, we will bring all the concepts together to understand how quantum algorithms
can be performed using these tools. Let’s get started!</p>
<div class="section" id="gaussian-states-of-light">
<h2>Gaussian states of light<a class="headerlink" href="#gaussian-states-of-light" title="Permalink to this headline">¶</a></h2>
<p>Why are the quantum states of light so durable? Photons seldom interact with each other,
which means we can easily avoid uncontrolled interactions that destroy their quantum state.
However, to build a universal quantum computer, we need multi-qubit gates,
which means that photons must be made to communicate with each other somehow! We <em>can</em> make photons
affect each other by using a material as a mediator. To start with, we will focus on manipulating
photons using <em>linear materials</em>, whose properties are unchanged when they interact with light. With linear materials,
we can produce a subset of the so-called <strong>Gaussian states</strong>. They can be fabricated with a 100% success rate
using common optical devices, so they are our safest tool in photonics.</p>
<p>To precisely define a Gaussian state, we need a mathematical representation for states
of light. As is the case with qubits, states of light are represented by a linear
combination of basis vectors. But unlike qubits, two basis vectors aren’t enough.
The reason is that light is characterized by its so-called <em>position and momentum quadratures</em> <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p,\)</span>
captured by the operators <span class="math notranslate nohighlight">\(\hat{X}\)</span> and <span class="math notranslate nohighlight">\(\hat{P}\)</span> respectively. Upon measurement, these quadratures
can take any real value, which means that <span class="math notranslate nohighlight">\(\hat{X}\)</span> and
<span class="math notranslate nohighlight">\(\hat{P}\)</span> have infinitely many eigenvectors. Therefore, to describe a quantum of light
<span class="math notranslate nohighlight">\(\left\lvert \psi \right\rangle,\)</span> we need infinitely many basis vectors!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The position and momentum quadratures <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p\)</span> do not represent the position and momentum
of one photon. They describe the state of possibly many photons, and they are related
to the amplitude and phase of light. The names come from the fact that the quadrature observables <span class="math notranslate nohighlight">\(\hat{X}\)</span>
and <span class="math notranslate nohighlight">\(\hat{P}\)</span> satisfy</p>
<div class="math notranslate nohighlight">
\[\left[ \hat{X},\hat{P}\right]=i\hbar,\]</div>
<p>which is the same relation satisfied by conventional position and momentum in quantum mechanics. This means that
no simultaneous measurement of <span class="math notranslate nohighlight">\(\hat{X}\)</span> and <span class="math notranslate nohighlight">\(\hat{P}\)</span> can be performed.
Moreover, the standard deviations of the measurements of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p\)</span> satisfy the
uncertainty relation</p>
<div class="math notranslate nohighlight">
\[\Delta x \Delta p \geq 1,\]</div>
<p>where we work in units where <span class="math notranslate nohighlight">\(\hbar = 2.\)</span> Sometimes the word “quadratures” is omitted for simplicity.</p>
</div>
<p>For example, we write</p>
<div class="math notranslate nohighlight">
\[\left\lvert \psi \right\rangle = \int_\mathbb{R}\psi(x)\vert x \rangle dx,\]</div>
<p>where <span class="math notranslate nohighlight">\(\vert x \rangle\)</span> is the eigenstate of <span class="math notranslate nohighlight">\(\hat{X}\)</span> with eigenvalue
<span class="math notranslate nohighlight">\(x,\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> is a complex-valued function known as the <em>wave function</em>.
A similar expansion can be done in terms of the eigenstates <span class="math notranslate nohighlight">\(\vert p \rangle\)</span> of <span class="math notranslate nohighlight">\(\hat{P}.\)</span>
Note that an integral is used here rather than an infinite sum because the eigenvalues of <span class="math notranslate nohighlight">\(\hat{X}\)</span> and <span class="math notranslate nohighlight">\(\hat{P}\)</span> are continuous.
So how do we define a Gaussian state using this representation? It is a state that is completely
determined by the average values <span class="math notranslate nohighlight">\(\bar{x}\)</span> and <span class="math notranslate nohighlight">\(\bar{p}\)</span> of the position and momentum quadratures,
as well as their standard deviations <span class="math notranslate nohighlight">\(\Delta x\)</span> and <span class="math notranslate nohighlight">\(\Delta p.\)</span> The most trivial
Gaussian state is the <em>vacuum</em>—the state with no photons. Let us see what happens if
we sample measurements of the quadratures <span class="math notranslate nohighlight">\(\hat{X}\)</span> and <span class="math notranslate nohighlight">\(\hat{P}\)</span> when light is in the vacuum.
We can use PennyLane’s <code class="docutils literal notranslate"><span class="pre">default.gaussian</span></code> device, which lets us create, manipulate, and measure Gaussian
states of light. Let’s first call the usual imports,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">from</span> <span class="nn">pennylane</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>and define the device.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.gaussian&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>What do the wires represent in a photonic device? They are independent
information carriers known as <strong>qumodes</strong>. In photonic quantum computers, these are waves of light
contained inside an optical cavity. Qumodes are not two-level systems in general, so we must use an
infinite superposition of basis states to represent their quantum state.</p>
</div>
<p>We would like to know how the measured values of position and momentum
are distributed in the <span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(p\)</span> space, usually called <a class="reference external" href="https://en.wikipedia.org/wiki/Optical_phase_space">phase space</a>.
The initial state in <code class="docutils literal notranslate"><span class="pre">default.gaussian</span></code> is the vacuum, so the circuits
to measure the quadratures need not contain any operations, except for measurements!
We plot 1000 measurement results for both <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p.\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">vacuum_measure_x</span><span class="p">():</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.X.html#pennylane.X" title="pennylane.X" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">X</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Samples X quadratures</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">vacuum_measure_p</span><span class="p">():</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.P.html#pennylane.P" title="pennylane.P" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">P</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Samples P quadrature</span>


<span class="c1"># Sample measurements in phase space</span>
<span class="n">x_sample</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vacuum_measure_x</span></a><span class="p">()</span>
<span class="n">p_sample</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vacuum_measure_p</span></a><span class="p">()</span>

<span class="c1"># Import some libraries for a nicer plot</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gaussian_kde</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">vstack</span> <span class="k">as</span> <span class="n">vstack</span>

<span class="c1"># Point density calculation</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">([</span><span class="n">x_sample</span><span class="p">,</span> <span class="n">p_sample</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">xp</span><span class="p">)(</span><span class="n">xp</span><span class="p">)</span>

<span class="c1"># Sort the points by density</span>
<span class="nb">sorted</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">x_sample</span><span class="p">[</span><span class="nb">sorted</span><span class="p">],</span> <span class="n">p_sample</span><span class="p">[</span><span class="nb">sorted</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="nb">sorted</span><span class="p">]</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">z</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdYlGn&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Vacuum&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span> <span class="o">=</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_photonics_001.png" srcset="../_images/sphx_glr_tutorial_photonics_001.png" alt="Vacuum" class = "sphx-glr-single-img"/><p>We observe that the values of the quadratures are distributed around the
origin with a spread of approximately 1. We can check these eyeballed values explicitly,
using a device without shots this time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev_exact</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.gaussian&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># No explicit shots gives analytic calculations</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev_exact</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">vacuum_mean_x</span><span class="p">():</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.X.html#pennylane.X" title="pennylane.X" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">X</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Returns exact expecation value of x</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev_exact</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">vacuum_mean_p</span><span class="p">():</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.P.html#pennylane.P" title="pennylane.P" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">P</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Returns exact expectation value of p</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev_exact</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">vacuum_var_x</span><span class="p">():</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.var.html#pennylane.var" title="pennylane.var" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">var</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.X.html#pennylane.X" title="pennylane.X" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">X</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Returns exact variance of x</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev_exact</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">vacuum_var_p</span><span class="p">():</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.var.html#pennylane.var" title="pennylane.var" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">var</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.P.html#pennylane.P" title="pennylane.P" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">P</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Returns exact variance of p</span>


<span class="c1"># Print calculated statistical quantities</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expectation value of x-quadrature: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vacuum_mean_x</span></a><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expectation value of p-quadrature: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vacuum_mean_p</span></a><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variance of x-quadrature: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vacuum_var_x</span></a><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variance of p-quadrature: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vacuum_var_p</span></a><span class="p">()))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Expectation value of x-quadrature: 0.0
Expectation value of p-quadrature: 0.0
Variance of x-quadrature: 1.0
Variance of p-quadrature: 1.0
</pre></div>
</div>
<p>But where does the name Gaussian come from? If we plot the density
of quadrature measurements for the vacuum state in three dimensions, we obtain the following plot.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/vacuum_wigner.png"><img alt="../_images/vacuum_wigner.png" src="../_images/vacuum_wigner.png" style="width: 70%;" /></a>
<div class="legend">
<p>Density of measurement results in phase space for the vacuum state</p>
</div>
</div>
<p>The density has the shape of a 2-dimensional Gaussian surface, hence the name. <em>For Gaussian
states only</em>, the density is exactly equal to the so-called <a class="reference external" href="https://en.wikipedia.org/wiki/Wigner_quasiprobability_distribution">Wigner function</a> <span class="math notranslate nohighlight">\(W(x,p),\)</span>
defined using the wave function <span class="math notranslate nohighlight">\(\psi(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[W(x,p) = \frac{1}{\pi\hbar}\int_{-\infty}^{\infty}\psi^{*}(x+y)\psi(x-y)e^{2ipy/\hbar}dy.\]</div>
<p>Since the Wigner function satisfies</p>
<div class="math notranslate nohighlight">
\[\int_{\mathbb{R}^2}W(x,p)dxdp = 1\]</div>
<p>and is positive for Gaussian states,
it is <em>almost as if</em>  the values of the momentum and position had an underlying classical
probability distribution, save for the fact that the quadratures can’t be measured simultaneously.
For this reason, Gaussian states are considered to be “classical” states of light. Now we’re ready
for the technical definition of a Gaussian state.</p>
<div class="defn admonition">
<p class="admonition-title">Definition</p>
<p>A photonic system is said to be in a <strong>Gaussian</strong> state if its Wigner function is a two-dimensional
Gaussian function <a class="footnote-reference brackets" href="#weedbrook2012" id="id2">2</a>.</p>
</div>
<p>What other Gaussian states are there? The states produced by lasers are called <em>coherent states</em>,
which are also Gaussian with <span class="math notranslate nohighlight">\(\Delta x = \Delta p = 1.\)</span> Coherent states, in general,
can have non-zero expectation values for the
quadratures (i.e., they are not centered around the origin).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">default.gaussian</span></code> device allows for the easy preparation of coherent states
through the function <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoherentState</span></code></a>, which takes two parameters <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\phi.\)</span>
Here, <span class="math notranslate nohighlight">\(\alpha=\sqrt{\vert\bar{x}\vert^2+\vert\bar{p}\vert^2}\)</span> is the magnitude
and <span class="math notranslate nohighlight">\(\phi\)</span> is the polar angle of the point <span class="math notranslate nohighlight">\((\bar{x}, \bar{p}).\)</span>
Let us plot sample quadrature measurements for a coherent state.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">measure_coherent_x</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Prepares coherent state</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.X.html#pennylane.X" title="pennylane.X" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">X</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Measures X quadrature</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">measure_coherent_p</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Prepares coherent state</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.P.html#pennylane.P" title="pennylane.P" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">P</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Measures P quadrature</span>


<span class="c1"># Choose alpha and phi and sample 1000 measurements</span>
<span class="n">x_sample_coherent</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measure_coherent_x</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">p_sample_coherent</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measure_coherent_p</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Plot as before</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">([</span><span class="n">x_sample_coherent</span><span class="p">,</span> <span class="n">p_sample_coherent</span><span class="p">])</span>
<span class="n">z1</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">xp</span><span class="p">)(</span><span class="n">xp</span><span class="p">)</span>

<span class="nb">sorted</span> <span class="o">=</span> <span class="n">z1</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">x_sample_coherent</span><span class="p">[</span><span class="nb">sorted</span><span class="p">],</span> <span class="n">p_sample_coherent</span><span class="p">[</span><span class="nb">sorted</span><span class="p">],</span> <span class="n">z1</span><span class="p">[</span><span class="nb">sorted</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">z</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdYlGn&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Coherent State&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span> <span class="o">=</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_photonics_002.png" srcset="../_images/sphx_glr_tutorial_photonics_002.png" alt="Coherent State" class = "sphx-glr-single-img"/><p>Indeed, we see that the distribution of quadrature measurements is similar to that of the vacuum, except that
it is not centered at the origin. Instead it is centred at the alpha and phi coordinates we chose in the code above.</p>
</div>
<div class="section" id="gaussian-operations">
<h2>Gaussian operations<a class="headerlink" href="#gaussian-operations" title="Permalink to this headline">¶</a></h2>
<p>We have only learned about two types of Gaussian states so far. The vacuum can be obtained
by carefully isolating a system from any environmental influences, and a coherent state can be produced
by a laser, so we already have these at hand. But how can we obtain any Gaussian state of our liking?
This is achieved through <em>Gaussian operations</em>, which transform a Gaussian state to
another Gaussian state. These operations are relatively easy to implement in a lab
using some of the optical elements introduced in the table below.</p>
<table class="docstable docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 39%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p class="centered">
<strong>Element</strong></p></th>
<th class="head"><p class="centered">
<strong>Diagram</strong></p></th>
<th class="head"><p class="centered">
<strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Waveguide</p></td>
<td><div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Waveguide.png"><img alt="../_images/Waveguide.png" src="../_images/Waveguide.png" style="width: 70%;" /></a>
</div>
</td>
<td><p>A long strip of material that contains and guides
electromagentic waves. For example, an optical fibre is a type
of waveguide.</p></td>
</tr>
<tr class="row-odd"><td><p>Phase-shifter</p></td>
<td><div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Thermo-optic.png"><img alt="../_images/Thermo-optic.png" src="../_images/Thermo-optic.png" style="width: 70%;" /></a>
</div>
</td>
<td><p>A piece of material that changes the phase of light. The figure
shows a particular implementation known as a thermo-optic phase
shifter <a class="footnote-reference brackets" href="#sabouri2021" id="id3">3</a>, which is a (sometimes curved) waveguide
that changes properties when heated up using a resistor.
This allows us to control the applied phase difference.</p></td>
</tr>
<tr class="row-even"><td><p>Beamsplitter</p></td>
<td><div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Beam_splitter.png"><img alt="../_images/Beam_splitter.png" src="../_images/Beam_splitter.png" style="width: 100%;" /></a>
</div>
</td>
<td><p>An element with two input and two output qumodes. It transmits a
fraction <span class="math notranslate nohighlight">\(T\)</span> of the photons coming in through either entry
port, and reflects a fraction <span class="math notranslate nohighlight">\(R=1-T.\)</span> The input qumodes can
be combined to create entangled states across the output ports.
In a photonic quantum computing chip, a <a class="reference external" href="https://en.wikipedia.org/wiki/Power_dividers_and_directional_couplers">directional coupler</a>
is used.</p></td>
</tr>
</tbody>
</table>
<p>The vacuum is centered at the origin in phase space. It is advantageous to generate states that
are centered at any point in phase space.
How would we, for example, change the mean <span class="math notranslate nohighlight">\(\bar{x}\)</span> of the <span class="math notranslate nohighlight">\(x\)</span>-quadrature
without changing anything else about the state? This can be done
via the <em>displacement operator</em>, implemented in PennyLane via <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Displacement.html#pennylane.Displacement" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Displacement</span></code></a>.
Let’s see the effect of this operation on an intial coherent state.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">displace_coherent_x</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Create coherent state</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Displacement.html#pennylane.Displacement" title="pennylane.Displacement" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Displacement</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Second argument is the displacement direction in phase space</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.X.html#pennylane.X" title="pennylane.X" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">X</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">displace_coherent_p</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Displacement.html#pennylane.Displacement" title="pennylane.Displacement" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Displacement</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.P.html#pennylane.P" title="pennylane.P" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">P</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>


<span class="c1"># We plot both the initial and displaced state</span>
<span class="n">initial_x</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">displace_coherent_x</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># initial state amounts to 0 displacement</span>
<span class="n">initial_p</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">displace_coherent_p</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">displaced_x</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">displace_coherent_x</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># displace x=3 in x-direction</span>
<span class="n">displaced_p</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">displace_coherent_p</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1"># Plot as before</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">xp1</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">([</span><span class="n">initial_x</span><span class="p">,</span> <span class="n">initial_p</span><span class="p">])</span>
<span class="n">z1</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">xp1</span><span class="p">)(</span><span class="n">xp1</span><span class="p">)</span>
<span class="n">sorted1</span> <span class="o">=</span> <span class="n">z1</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">initial_x</span><span class="p">[</span><span class="n">sorted1</span><span class="p">],</span> <span class="n">initial_p</span><span class="p">[</span><span class="n">sorted1</span><span class="p">],</span> <span class="n">z1</span><span class="p">[</span><span class="n">sorted1</span><span class="p">]</span>
<span class="n">xp2</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">([</span><span class="n">displaced_x</span><span class="p">,</span> <span class="n">displaced_p</span><span class="p">])</span>
<span class="n">z2</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">xp2</span><span class="p">)(</span><span class="n">xp2</span><span class="p">)</span>
<span class="n">sorted2</span> <span class="o">=</span> <span class="n">z2</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">displaced_x</span><span class="p">[</span><span class="n">sorted2</span><span class="p">],</span> <span class="n">displaced_p</span><span class="p">[</span><span class="n">sorted2</span><span class="p">],</span> <span class="n">z2</span><span class="p">[</span><span class="n">sorted2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">z1</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span>  <span class="o">=</span><span class="s2">&quot;RdYlGn&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">z2</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdYlGn&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;Before displacement&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;After displacement&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Displacing coherent states&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span> <span class="o">=</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_photonics_003.png" srcset="../_images/sphx_glr_tutorial_photonics_003.png" alt="Displacing coherent states" class = "sphx-glr-single-img"/><p>Note that setting <span class="math notranslate nohighlight">\(x=3\)</span> gave a displacement of 6 units in the horizontal direction in phase space.
This is because the scale of phase space is set by our choice of units <span class="math notranslate nohighlight">\(\hbar=2.\)</span></p>
<p>So how do we make a displacement operation in the lab? One method
is shown below, which uses a beamsplitter and a source of <strong>high-intensity coherent light</strong> <a class="footnote-reference brackets" href="#paris1996" id="id4">4</a>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Displacement.png"><img alt="../_images/Displacement.png" src="../_images/Displacement.png" style="width: 70%;" /></a>
<div class="legend">
<p>This setup displaces the input state <span class="math notranslate nohighlight">\(\lvert\psi\rangle\)</span> by a quantity proportional to <span class="math notranslate nohighlight">\(z.\)</span></p>
</div>
</div>
<p>We can check that this setup implements a displacement operator using PennyLane. This time,
we need two qumodes, since we rely on combining the input state that we want to displace with a
coherent state in a beamsplitter. Let us code this circuit in the case that the input is a coherent state
as a particular case (the operation will work for any state).
Let us be mindful that this will only work when the amplitude of the input state is much smaller
than that of the auxiliary coherent state.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev2</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.gaussian&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">disp_optics</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># High-amplitude auxiliary coherent state</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Input state (e.g. low amplitude coherent state)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Beamsplitter.html#pennylane.Beamsplitter" title="pennylane.Beamsplitter" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Beamsplitter</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">z</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Beamsplitter</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.X.html#pennylane.X" title="pennylane.X" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">X</span></a><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># Measure x quadrature</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mom_optics</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Beamsplitter.html#pennylane.Beamsplitter" title="pennylane.Beamsplitter" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Beamsplitter</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">z</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.P.html#pennylane.P" title="pennylane.P" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">P</span></a><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># Measure p quadrature</span>


<span class="c1"># Plot quadrature measurement before and after implementation of displacement</span>
<span class="n">initial_x</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">disp_optics</span></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Initial corresponds to beamsplitter with t=0 (x=0)</span>
<span class="n">initial_p</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mom_optics</span></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Amplitude of coherent state must be large</span>
<span class="n">displaced_x</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">disp_optics</span></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">displaced_p</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mom_optics</span></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Set some non-trivial t</span>
<span class="c1"># Plot as before</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">xp1</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">([</span><span class="n">initial_x</span><span class="p">,</span> <span class="n">initial_p</span><span class="p">])</span>
<span class="n">z1</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">xp1</span><span class="p">)(</span><span class="n">xp1</span><span class="p">)</span>
<span class="n">sorted1</span> <span class="o">=</span> <span class="n">z1</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">initial_x</span><span class="p">[</span><span class="n">sorted1</span><span class="p">],</span> <span class="n">initial_p</span><span class="p">[</span><span class="n">sorted1</span><span class="p">],</span> <span class="n">z1</span><span class="p">[</span><span class="n">sorted1</span><span class="p">]</span>
<span class="n">xp2</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">([</span><span class="n">displaced_x</span><span class="p">,</span> <span class="n">displaced_p</span><span class="p">])</span>
<span class="n">z2</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">xp2</span><span class="p">)(</span><span class="n">xp2</span><span class="p">)</span>
<span class="n">sorted2</span> <span class="o">=</span> <span class="n">z2</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">displaced_x</span><span class="p">[</span><span class="n">sorted2</span><span class="p">],</span> <span class="n">displaced_p</span><span class="p">[</span><span class="n">sorted2</span><span class="p">],</span> <span class="n">z2</span><span class="p">[</span><span class="n">sorted2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">z1</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdYlGn&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">z2</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdYlGn&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Initial&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;Before displacement&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;After displacement&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Implementation of displacement operator&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_photonics_004.png" srcset="../_images/sphx_glr_tutorial_photonics_004.png" alt="Implementation of displacement operator" class = "sphx-glr-single-img"/><p>We see that we get a displaced state. The amount of displacement can be adjusted by
changing the parameters of the beamsplitter.
Similarly, we can implement rotations in phase space using <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Rotation.html#pennylane.Rotation" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rotation</span></code></a>, which
simply amounts to changing the phase of light using a phase shifter. In phase space,
this amounts to rotating the point <span class="math notranslate nohighlight">\((\bar{x},\bar{p})\)</span> around the origin.</p>
<p>So far, we have focused on changing the mean values of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p.\)</span>
But what if we also want to change the spread of the quadratures while keeping <span class="math notranslate nohighlight">\(\Delta x\Delta p =1\)</span>?.
This would “squeeze” the Wigner function in one direction. Aptly, the resulting state
is known as a <em>squeezed state</em>, which is more difficult to obtain.
It requires shining light through non-linear
materials, where the state of light will undergo unitary evolution in a
way that changes <span class="math notranslate nohighlight">\(\Delta x\)</span> and <span class="math notranslate nohighlight">\(\Delta p.\)</span></p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Squeezer.png"><img alt="../_images/Squeezer.png" src="../_images/Squeezer.png" style="width: 70%;" /></a>
<div class="legend">
<p>A non-linear material can work as a squeezer <a class="footnote-reference brackets" href="#braunstein2005" id="id5">5</a>.</p>
</div>
</div>
<p>We won’t go into detail here,
but we note that the technology to produce these states is quite mature.
In PennyLane, we can generate squeezed states through the squeezing
operator <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Squeezing.html#pennylane.Squeezing" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Squeezing</span></code></a>. This function depends on the squeezing parameter
<span class="math notranslate nohighlight">\(r\)</span> which tells us how much the variance in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p\)</span> changes, and <span class="math notranslate nohighlight">\(\phi,\)</span>
which rotates the state in phase space. Let’s take a look at how squeezing changes the distribution
of quadrature measurements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">measure_squeezed_x</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Squeezing.html#pennylane.Squeezing" title="pennylane.Squeezing" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Squeezing</span></a><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.X.html#pennylane.X" title="pennylane.X" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">X</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">measure_squeezed_p</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Squeezing.html#pennylane.Squeezing" title="pennylane.Squeezing" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Squeezing</span></a><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.P.html#pennylane.P" title="pennylane.P" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">P</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>


<span class="c1"># Choose alpha and phi and sample 1000 measurements</span>
<span class="n">x_sample_squeezed</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measure_squeezed_x</span></a><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">p_sample_squeezed</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measure_squeezed_p</span></a><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>

<span class="c1"># Plot as before</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">([</span><span class="n">x_sample_squeezed</span><span class="p">,</span> <span class="n">p_sample_squeezed</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">xp</span><span class="p">)(</span><span class="n">xp</span><span class="p">)</span>

<span class="n">sorted_meas</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">x_sample_squeezed</span><span class="p">[</span><span class="n">sorted_meas</span><span class="p">],</span> <span class="n">p_sample_squeezed</span><span class="p">[</span><span class="n">sorted_meas</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="n">sorted_meas</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">z</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdYlGn&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Squeezed State&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span> <span class="o">=</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_photonics_005.png" srcset="../_images/sphx_glr_tutorial_photonics_005.png" alt="Squeezed State" class = "sphx-glr-single-img"/><p>This confirms that squeezing changes the variances of the quadratures.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The squeezed states produced above satisfy <span class="math notranslate nohighlight">\(\Delta x \Delta p = 1,\)</span>
but more general Gaussian states need not satisfy these. For the purposes
of photonic quantum computing, we won’t need these generalized states.</p>
</div>
</div>
<div class="section" id="measuring-quadratures">
<h2>Measuring quadratures<a class="headerlink" href="#measuring-quadratures" title="Permalink to this headline">¶</a></h2>
<p>Now that we know how to manipulate Gaussian states, we would like to perform measurements
on them. So far, we have taken for granted that we can measure the quadratures
<span class="math notranslate nohighlight">\(\hat{X}\)</span> and <span class="math notranslate nohighlight">\(\hat{P}.\)</span> But how do we actually measure them using optical elements?
We will need a measuring device known as a photodetector. These contain a piece of a
photoelectric material, where each outer electron can be stimulated by a photon.
The more photons that are incident on the photodetector, the more electrons that are
freed in the material, which in turn form an electric current. Mathematically,</p>
<div class="math notranslate nohighlight">
\[I = qN,\]</div>
<p>where <span class="math notranslate nohighlight">\(I\)</span> is the electric current, <span class="math notranslate nohighlight">\(N\)</span> is the number of photons, and <span class="math notranslate nohighlight">\(q\)</span> is a detector-dependent
proportionality constant <a class="footnote-reference brackets" href="#braunstein2005" id="id6">5</a>. Hence, measuring the current amounts to measuring the number of photons indirectly!</p>
<p>The number of photons in a quantum of light is not fixed. It is measured by the quantum
photon-number observable <span class="math notranslate nohighlight">\(\hat{N},\)</span> which has eigenstates denoted <span class="math notranslate nohighlight">\(\vert 0 \rangle, \vert 1\rangle, \vert 2 \rangle,\dots\)</span>
These states, known as <em>Fock states</em>, do have a well-defined number of photons:
repeated measurements of <span class="math notranslate nohighlight">\(\hat{N}\)</span> on the same state will yield the same output.
The natural number <span class="math notranslate nohighlight">\(n\)</span> in the Fock state <span class="math notranslate nohighlight">\(\vert n \rangle\)</span> denotes the only possible
result we would get upon measuring the photon number. But nothing prevents light from being in a superposition of
Fock states. For example, when we measure <span class="math notranslate nohighlight">\(\hat{N}\)</span> for the state</p>
<div class="math notranslate nohighlight">
\[\vert \psi \rangle = \frac{1}{\sqrt{3}}\left(\vert 0 \rangle + \vert 1 \rangle + \vert 2 \rangle\right),\]</div>
<p>we get 0, 1, or 2 photons, each with probability <span class="math notranslate nohighlight">\(\frac{1}{3}.\)</span></p>
<p>Except for the vacuum <span class="math notranslate nohighlight">\(\vert 0 \rangle,\)</span> <em>Fock states are not Gaussian</em>. But all states of light
are superpositions of Fock States, including Gaussian states!
For example, let’s measure the expected photon number for some squeezed state:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev3</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.gaussian&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">measure_n_coherent</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Squeezing.html#pennylane.Squeezing" title="pennylane.Squeezing" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Squeezing</span></a><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.NumberOperator.html#pennylane.NumberOperator" title="pennylane.NumberOperator" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">NumberOperator</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>


<span class="n">coherent_expval</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measure_n_coherent</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expected number of photons: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coherent_expval</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Expected number of photons: 1.3810978455418157
</pre></div>
</div>
<p>Since the expectation value is not an integer number, the measurement results cannot have been all the same integer.
This squeezed state cannot be a Fock state!</p>
<p>But what about the promised quadrature measurements? We can perform them through a
combination of photodetectors and a beamsplitter,
as shown in the diagram below <a class="footnote-reference brackets" href="#braunstein2005" id="id7">5</a>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Homodyne.png"><img alt="../_images/Homodyne.png" src="../_images/Homodyne.png" style="width: 70%;" /></a>
<div class="legend">
<p>Measuring quadratures using photodetectors</p>
</div>
</div>
<p>Let’s code this setup using PennyLane and check that it amounts to the measurement of quadratures.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev_exact2</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.gaussian&quot;</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev_exact2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">measurement</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Displacement.html#pennylane.Displacement" title="pennylane.Displacement" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Displacement</span></a><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Implement displacement using PennyLane</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.X.html#pennylane.X" title="pennylane.X" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">X</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>


<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev_exact2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">measurement2_0</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Displacement.html#pennylane.Displacement" title="pennylane.Displacement" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Displacement</span></a><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># We choose the initial to be a displaced vacuum</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Prepare coherent as second qumode</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Beamsplitter.html#pennylane.Beamsplitter" title="pennylane.Beamsplitter" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Beamsplitter</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Interfere both states</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.NumberOperator.html#pennylane.NumberOperator" title="pennylane.NumberOperator" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">NumberOperator</span></a><span class="p">(</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># Read out N</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev_exact2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">measurement2_1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Displacement.html#pennylane.Displacement" title="pennylane.Displacement" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Displacement</span></a><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># We choose the initial to be a displaced vacuum</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.CoherentState.html#pennylane.CoherentState" title="pennylane.CoherentState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">CoherentState</span></a><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Prepare coherent as second qumode</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Beamsplitter.html#pennylane.Beamsplitter" title="pennylane.Beamsplitter" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Beamsplitter</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Interfere both states</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.NumberOperator.html#pennylane.NumberOperator" title="pennylane.NumberOperator" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">NumberOperator</span></a><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># Read out N</span>


<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Expectation value of x-quadrature after displacement: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measurement</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expected current in each detector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detector 1: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measurement2_0</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detector 2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measurement2_1</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Difference between currents: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measurement2_1</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">measurement2_0</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Expectation value of x-quadrature after displacement: 6.0

Expected current in each detector:
Detector 1: 2.000000000000001
Detector 2: 7.999999999999998
Difference between currents: 5.999999999999997
</pre></div>
</div>
<p>Here we used <span class="math notranslate nohighlight">\(q=1\)</span> as the detector constant, but we should note that this quantity can’t really be measured
precisely. However, we only care about distinguishing different states of light, so knowing the constant isn’t really needed!</p>
<p>Trying the above with many input states should convince you that this setup, known as <em>homodyne measurement</em>,
allows us to measure the quadratures <span class="math notranslate nohighlight">\(\hat{X}\)</span> and <span class="math notranslate nohighlight">\(\hat{P}.\)</span> Feel free to play around
changing the values of <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(a\)</span>!</p>
</div>
<div class="section" id="beyond-gaussian-states">
<h2>Beyond Gaussian states<a class="headerlink" href="#beyond-gaussian-states" title="Permalink to this headline">¶</a></h2>
<p>We’ve learned a lot about Gaussian states now, but they don’t seem to have many quantum properties.
They are described by their positive Wigner
function, which is to an extent analogous to a
probability distribution. Are they really different from classical states? Not that much! To build a universal photonic
quantum computer we need both Gaussian <em>and</em> non-Gaussian states. Moreover,
we need to be able to entangle any two states.</p>
<p>Entanglement is not a problem, since combinations of Gaussian operations involving
squeezers and beamsplitters can easily create entangled states!
Let us set on the more challenging mission to find a way to prepare non-Gaussian states.
All of the operations that we have learned so far—displacements, rotations, squeezing—are Gaussian.
Do we need some kind of strange material that will implement a non-Gaussian operation? That’s certainly
a possibility, and there are materials which can provide non-Gaussian interactions—like the <a class="reference external" href="https://en.wikipedia.org/wiki/Kerr_effect">Kerr effect</a>. But relying
on these non-linear materials is far from optimal, since the Kerr effect is weak and we don’t have much freedom to manipulate
the setup into getting an arbitrary non-Gaussian state.</p>
<p>But there’s one non-Gausian operation that’s been right in front of our eyes all this time.
The measurement of the number of photons takes a Gaussian state and collapses it into a Fock state (although this destroys the photons);
therefore, photon-number detection is not a Gaussian operation. Measuring the exact number of photons is not that easy.
We need fancy devices known a photon-number resolving detectors (commonly abbreviated as PNRs),
which are superconductor-based, so they work only at low temperatures. Combined with squeezed states and beamsplitters,
we have all the ingredients to produce non-Gaussian states.</p>
<p>Let’s explore how this works. The main idea is to tweak a particular photonic circuit known
as a <em>Gaussian Boson Sampler</em> <a class="footnote-reference brackets" href="#hamilton2017" id="id8">6</a>, which is shown below.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/GBS.png"><img alt="../_images/GBS.png" src="../_images/GBS.png" style="width: 70%;" /></a>
<div class="legend">
<p>A Gaussian Boson Sampling circuit. The beamsplitters here may include phase shifts.</p>
</div>
</div>
<p>Gaussian boson sampling (GBS) is interesting on its own
(see <a class="reference internal" href="gbs.html"><span class="doc">this tutorial</span></a> for an in-depth discussion).
So far, two quantum devices have used large-scale versions of this circuit
to achieve quantum advantage on a particular computation, which involves sampling from
a probability distribution that classical computers take too long to simulate. In 2019, USTC’s Jiuzhang device took 200 seconds
to perform this sampling, which would take 2.5 billion years for some of our most powerful supercomputers <a class="footnote-reference brackets" href="#zhong2020" id="id9">7</a>. In 2022,
Xanadu’s Borealis performed the same calculation in 36 microseconds, with the added benefit of being programmable
and available on the Cloud <a class="footnote-reference brackets" href="#madsen2020" id="id10">8</a>.</p>
<p>But the most interesting application of GBS comes from removing the PNR in the last wire, as shown below.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/GKP_Circuit.png"><img alt="../_images/GKP_Circuit.png" src="../_images/GKP_Circuit.png" style="width: 70%;" /></a>
<div class="legend">
<p>Circuit to produce non-Gaussian states probabilistically</p>
</div>
</div>
<p>Circuits like the above can, after photon detection of the other qumodes,
produce non-Gaussian states. The reason is that the
final state of the circuit is entangled, and we apply a non-Gaussian operation to some of the
qumodes. This measurement affects the remaining qumode, whose state becomes non-Gaussian in general. This is
the magic of quantum mechanics: due to entanglement, a measurement on a physical system can affect the state of another! Moreover,
one can show that generalizations of the GBS circuit above can be built to produce any non-Gaussian state that we want <a class="footnote-reference brackets" href="#tzitrin2020" id="id11">9</a>.</p>
<p>For example, the choice of parameters</p>
<div class="math notranslate nohighlight">
\[t_1 = 0.8624, \quad t_2=0.7688, \quad t_3 = 0.7848,\]</div>
<div class="math notranslate nohighlight">
\[S_1 = -1.38, \quad S_2 = -1.22, \quad S_3 = 0.780 \quad S_4 = 0.196,\]</div>
<p>for this generalized GBS circuit produces, with some probability,  the following state (expressed as a combination of Fock states)</p>
<div class="math notranslate nohighlight">
\[\vert \psi \rangle = S(0.196)\left(0.661 \vert 0\rangle -0.343 \vert 2\rangle + 0.253\vert 4\rangle -0.368\vert 6\rangle
+0.377 \vert 8\rangle + 0.323 \vert 10\rangle + 0.325\vert 12\rangle\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is the squeezing operator <a class="footnote-reference brackets" href="#tzitrin2020" id="id12">9</a>. This state’s
Wigner function is shown below.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/gkp_wigner.png"><img alt="../_images/gkp_wigner.png" src="../_images/gkp_wigner.png" style="width: 70%;" /></a>
<div class="legend">
<p>Wigner function of non-Gaussian state</p>
</div>
</div>
<p>This Wigner function does not have the shape of a Gaussian and moreover, it can be negative—a tell-tale feature of
non-Gaussian states (we can only interpret the Wigner function as some sort of probability distribution for the case of Gaussian states!).
The only issue is that the non-Gaussian state is produced only with some probability, that is,
<em>when the detectors measure some particular number of photons</em>. But, at the very least, we can
be sure that we have obtained the non-Gaussian state we wanted, and otherwise we
just discard the qumode. For more precise calculations, you can check out <a class="reference external" href="https://the-walrus.readthedocs.io/en/latest/gallery/gkp.html">this
tutorial</a> from PennyLane’s sister library The Walrus,
which is optimized for simulating this type of circuit.</p>
</div>
<div class="section" id="encoding-qubits-into-qumodes">
<h2>Encoding qubits into qumodes<a class="headerlink" href="#encoding-qubits-into-qumodes" title="Permalink to this headline">¶</a></h2>
<p>It’s great that we can manipulate quantum states of light so freely, but we haven’t discussed how
to use them for quantum computing. We would like a way to encode qubits into qumodes, so
that we can run any qubit-based quantum algorithm using qumodes.
Surely there’s more than one way to encode a two-dimensional subspace into an infinite-dimensional
one. The only problem is that most of these encodings are extremely sensitive to the noise
affecting the larger space. A way that has proven to be quite robust to errors is to
encode qubits in states of light is using a special type of non-Gaussian states called <em>GKP states</em> <a class="footnote-reference brackets" href="#gottesman2001" id="id13">10</a>.</p>
<p>GKP states are linear combinations of the following two basis states:</p>
<div class="math notranslate nohighlight">
\[\vert 0 \rangle_{GKP} = \sum_{n} \vert 2n\pi\rangle_x,\]</div>
<div class="math notranslate nohighlight">
\[\vert 1 \rangle_{GKP} = \sum_{n} \vert (2n+1)\pi\rangle_x,\]</div>
<p>where the subscript <span class="math notranslate nohighlight">\(x\)</span> means that the kets in the sum are eigenstates of the quadrature observable
<span class="math notranslate nohighlight">\(\hat{X}.\)</span> Therefore, an arbitrary qubit <span class="math notranslate nohighlight">\(\vert \psi \rangle = \alpha\vert 0 \rangle + \beta\vert 1 \rangle\)</span>
can be expressed through the qumode as</p>
<div class="math notranslate nohighlight">
\[\vert \psi \rangle_{GKP} = \alpha\vert 0 \rangle_{GKP} + \beta\vert 1 \rangle_{GKP}.\]</div>
<p>The only problem is that producing these GKP states is physically impossible, doing so would require infinite energy.
Instead, we can produce approximate versions of them and still
run a quantum computation with great precision. In fact, the GBS circuit we built to produce non-Gaussian states can also produce
approximate GKP states. This will only happen when we measure 5 and 7 photons in each of the detectors <a class="footnote-reference brackets" href="#tzitrin2020" id="id14">9</a>. The probability of this happening
is rather small but finite.</p>
<p>We can remain within the subspace spanned by the GKP basis states by restricting the operations we apply
on our qumodes. For example, we see that applying a displacement by <span class="math notranslate nohighlight">\(\sqrt{\pi}\)</span> to <span class="math notranslate nohighlight">\(\vert 0 \rangle_{GKP}\)</span> gives the
<span class="math notranslate nohighlight">\(\vert 1 \rangle_{GKP}\)</span> state, and vice versa. Therefore, the displacement operator corresponds to the qubit
bit-flip gate <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.PauliX.html#pennylane.PauliX" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">PauliX</span></code></a>. Similarly, a rotation operator by <span class="math notranslate nohighlight">\(\pi/2\)</span> implements the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hadamard</span></code></a> gate.
The table below gives more detail on how to implement all the gates we need for
universal quantum computation using optical gates on  exact GKP states <a class="footnote-reference brackets" href="#bourassa2021" id="id15">11</a> (on approximate GKP states, the effects of these
gates will be approximate on the qubit level).</p>
<table class="docstable docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 41%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p class="centered">
<strong>Qumode Gate</strong></p></th>
<th class="head"><p class="centered">
<strong>Optical Diagram</strong></p></th>
<th class="head"><p class="centered">
<strong>Qubit gate on GKP states</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Displacement</p></td>
<td><div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Displacement.png"><img alt="../_images/Displacement.png" src="../_images/Displacement.png" style="width: 70%;" /></a>
</div>
</td>
<td><p><em>Pauli X</em> gate if the displacement is by <span class="math notranslate nohighlight">\(\sqrt{\pi}\)</span> in
the <span class="math notranslate nohighlight">\(x\)</span>-direction. <em>Pauli Z</em> if the same displacement is
in the <span class="math notranslate nohighlight">\(p\)</span>-direction</p></td>
</tr>
<tr class="row-odd"><td><p>Rotation</p></td>
<td><div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Rotation.png"><img alt="../_images/Rotation.png" src="../_images/Rotation.png" style="width: 70%;" /></a>
</div>
</td>
<td><p><em>Hadamard</em> gate for <span class="math notranslate nohighlight">\(\phi=\frac{\pi}{2}.\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Continuous variable
CNOT</p></td>
<td><div class="figure align-center">
<a class="reference internal image-reference" href="../_images/CV_ctrlz.png"><img alt="../_images/CV_ctrlz.png" src="../_images/CV_ctrlz.png" style="width: 100%;" /></a>
</div>
</td>
<td><p>The squeezing parameter is given by <span class="math notranslate nohighlight">\(r=\sinh^{-1}(1/2)\)</span> and
the beamsplitters have <span class="math notranslate nohighlight">\(T=\frac{1}{4}(1-\tanh(r)).\)</span>
Applies a <em>Control-Z</em> operation on the GKP states when
<span class="math notranslate nohighlight">\(\phi = 0\)</span> and a <em>CNOT</em> operation when <span class="math notranslate nohighlight">\(\phi=\pi/2.\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Magic state
teleportation</p></td>
<td><div class="figure align-center">
<a class="reference internal image-reference" href="../_images/Tgate.png"><img alt="../_images/Tgate.png" src="../_images/Tgate.png" style="width: 100%;" /></a>
</div>
</td>
<td><p>We use an auxiliary <em>magic state</em> <span class="math notranslate nohighlight">\(\vert M\rangle,\)</span>
which is the GKP state
<span class="math notranslate nohighlight">\(\vert M\rangle = \vert +\rangle +e^{i\pi/4} \vert -\rangle,\)</span>
and a <span class="math notranslate nohighlight">\(\hat{P}\)</span> homodyne measurement. If we measure
<span class="math notranslate nohighlight">\(\vert -\rangle,\)</span> we apply the shown rotations and squeezers
with <span class="math notranslate nohighlight">\(r=\cosh^{-1}(3/4),\)</span> <span class="math notranslate nohighlight">\(\theta=\tan^{-1}(1/2),\)</span>
and <span class="math notranslate nohighlight">\(\phi=-\pi/2-\theta,\)</span> resulting in a GKP <em>T gate</em>.</p></td>
</tr>
</tbody>
</table>
<p>Even if their effect is approximate, these gates are quick
and quite straightforward to implement with our current technology.  Therefore, we have all the ingredients to build a universal
quantum computer using photons, summarized in the formula (see <a class="reference external" href="https://medium.com/xanaduai/riding-bosonic-qubits-towards-fault-tolerant-quantum-computation-95b92c78cb43">this medium article</a>):</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/formula_qc.png"><img alt="../_images/formula_qc.png" src="../_images/formula_qc.png" style="width: 70%;" /></a>
</div>
</div>
<div class="section" id="the-state-of-the-art">
<h2>The state of the art<a class="headerlink" href="#the-state-of-the-art" title="Permalink to this headline">¶</a></h2>
<p>We have now learned the basics of how to build a quantum computer using photonics. So what challenges
are there to overcome for scaling further?
Let us analyze what we have learned in terms of Di Vincenzo’s criteria, so we can understand
what Xanadu is doing to achieve the ambitious goal of building a million-qubit quantum computer.</p>
<p>Looking at the first criterion, we already know that our qubits are far from perfect.
Photonics rely on imperfect realizations of GKP states, which in turn makes quantum computations only approximate.
Moreover, while we know a lot about GKP states, it is not easy to characterize them after taking into account the noise,
so the qubits are not as well-defined as we would like. But our qubits are scalable: GBS circuits can be built on
small chips, which we can stack and connect together using optical fibers. Moreover, compared to other implementations where
low temperatures are needed everywhere, in photonic quantum computers we only need them for the PNRs to work.
Since cryogenics are a bulky part of quantum computing architectures, photonic technology promises to be more scalable than, for example,
<a class="reference internal" href="tutorial_trapped_ions.html"><span class="doc">trapped ion</span></a> or <a class="reference internal" href="tutorial_sc_qubits.html"><span class="doc">superconducting</span></a> devices.</p>
<p>The second criterion, the ability to prepare a qubit, is clearly a challenge. We need GKP states,
but these cannot be prepared deterministically; we need to get a bit lucky.
We can bypass this by <em>multiplexing</em>, that is, using many
Gaussian Boson Sampling circuits in parallel. Moreover, higher-quality GKP states need larger circuits,
which in turn can decrease the probability of qubit production. How can we try to solve this?
Xanadu is currently following a hybrid approach.
When we fail to produce a GKP state, Xanadu’s architecture produces squeezed states using a separate squeezer.
Strongly-entangled squeezed states are a precious resource, since other encodings beyond GKP allow us
to use these states as a resource for (non-universal) quantum computing <a class="footnote-reference brackets" href="#bourassa2021" id="id16">11</a>.</p>
<p>The third criterion of long decoherence times seems innocuous at a first glance. However, although the quantum state of individual photons
is robust, we do need to minimize the number of photons that escape to the environment. Recall that all quantum states
of light are superpositions of Fock states. If a photon escapes, our state changes! The technology for the minimization of photon loss
has come a long way, but it’s not perfect yet. We can avoid losses by optimizing the depth of our circuits, so that photons
have a smaller probability of escaping. The GKP encoding also works in our favour, since it is robust against noise and small
displacements from GKP states can be easily steered back.</p>
<p>The fourth criterion is pretty much satisfied by photonic quantum computers. We have seen that we can perform universal computations
using Gaussian operations, provided that we have GKP states. Barring our imperfect qubits, quantum computing
gates are straightforward to implement with good precision inside a chip. Moreover, entangling photons is relatively easy using
common optical devices, as opposed to other technologies that rely on rather complicated and slow gates.</p>
<p>Finally, we need to be able to measure qubits. Homodyne detection can be done easily and with great precision. In general,
we do not need to measure the number of photons at the end of a quantum computation, quadrature measurement is enough to distinguish quantum
states. The fancy PNRs are only required for qubit production!</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/chip.png"><img alt="../_images/chip.png" src="../_images/chip.png" style="width: 40%;" /></a>
<div class="legend">
<p>Xanadu’s X8 Gaussian Boson Sampling chip. Variants of this chip can be used to generate approximate GKP states.</p>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>The approach of photonic devices to quantum computing is quite different from other technologies. Recent theoretical
and technological developments have given a boost to their status as a scalable approach, although the generation of qubits
remains a challenge to overcome. The variety of ways that we can encode
qubits into photonic states leave plenty of room for creativity, and opens the
door for further research and engineering breakthroughs. If you would like to learn more about photonics, make sure to
check out the <a class="reference external" href="https://strawberryfields.ai/photonics/demonstrations.html">Strawberry Fields demos</a>,
as well as the references listed below.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="divincenzo2000"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>D. DiVincenzo. (2000) “The Physical Implementation of Quantum Computation”,
<a class="reference external" href="https://onlinelibrary.wiley.com/doi/10.1002/1521-3978(200009)48:9/11%3C771::AID-PROP771%3E3.0.CO;2-E">Fortschritte der Physik 48 (9–11): 771–783</a>.
(<a class="reference external" href="https://arxiv.org/abs/quant-ph/0002077">arXiv</a>)</p>
</dd>
<dt class="label" id="weedbrook2012"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>C. Weedbrook, et al. (2012) “Gaussian Quantum Information”,
<a class="reference external" href="https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.84.621">Rev. Mod. Phys. 84, 621</a>.
(<a class="reference external" href="https://arxiv.org/abs/1110.3234">arXiv</a>)</p>
</dd>
<dt class="label" id="sabouri2021"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>S. Sabouri, et al. (2021) “Thermo Optical Phase Shifter With Low Thermal Crosstalk for SOI Strip Waveguide”
<a class="reference external" href="https://ieeexplore.ieee.org/document/9345963">IEEE Photonics Journal vol. 13, no. 2, 6600112</a>.</p>
</dd>
<dt class="label" id="paris1996"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>M. Paris. (1996) “Displacement operator by beam splitter”,
<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/0375960196003398?via%3Dihub">Physics Letters A, 217 (2-3): 78-80</a>.</p>
</dd>
<dt class="label" id="braunstein2005"><span class="brackets">5</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>,<a href="#id7">3</a>)</span></dt>
<dd><p>S. Braunstein, P. van Loock. (2005) “Quantum information with continuous variables”,
<a class="reference external" href="https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.77.513">Rev. Mod. Phys. 77, 513</a>.
(<a class="reference external" href="https://arxiv.org/abs/quant-ph/0410100">arXiv</a>)</p>
</dd>
<dt class="label" id="hamilton2017"><span class="brackets"><a class="fn-backref" href="#id8">6</a></span></dt>
<dd><p>C. Hamilton , et al. (2017) “Gaussian Boson Sampling”,
<a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.119.170501">Phys. Rev. Lett. 119, 170501</a>.
(<a class="reference external" href="https://arxiv.org/abs/1612.01199">arXiv</a>)</p>
</dd>
<dt class="label" id="zhong2020"><span class="brackets"><a class="fn-backref" href="#id9">7</a></span></dt>
<dd><p>H.S. Zhong, et al. (2020) “Quantum computational advantage using photons”,
<a class="reference external" href="https://www.science.org/doi/10.1126/science.abe8770">Science 370, 6523: 1460-1463</a>.
(<a class="reference external" href="https://arxiv.org/abs/2012.01625">arXiv</a>)</p>
</dd>
<dt class="label" id="madsen2020"><span class="brackets"><a class="fn-backref" href="#id10">8</a></span></dt>
<dd><p>L. Madsen, et al. (2022) “Quantum computational advantage with a programmable photonic processor”
<a class="reference external" href="https://www.nature.com/articles/s41586-022-04725-x">Nature 606, 75-81</a>.</p>
</dd>
<dt class="label" id="tzitrin2020"><span class="brackets">9</span><span class="fn-backref">(<a href="#id11">1</a>,<a href="#id12">2</a>,<a href="#id14">3</a>)</span></dt>
<dd><p>I. Tzitrin, et al. (2020) “Progress towards practical qubit computation using approximate Gottesman-Kitaev-Preskill codes”
<a class="reference external" href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.101.032315">Phys. Rev. A 101, 032315</a>.
(<a class="reference external" href="https://arxiv.org/abs/1910.03673">arXiv</a>)</p>
</dd>
<dt class="label" id="gottesman2001"><span class="brackets"><a class="fn-backref" href="#id13">10</a></span></dt>
<dd><p>D. Gotesman, A. Kitaev, J. Preskill. (2001) “Encoding a qubit in an oscillator”,
<a class="reference external" href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.64.012310">Phys. Rev. A 64, 012310</a>.
(<a class="reference external" href="https://arxiv.org/abs/quant-ph/0008040">arXiv</a>)</p>
</dd>
<dt class="label" id="bourassa2021"><span class="brackets">11</span><span class="fn-backref">(<a href="#id15">1</a>,<a href="#id16">2</a>)</span></dt>
<dd><p>E. Bourassa, et al. (2021) “Blueprint for a Scalable Photonic Fault-Tolerant Quantum Computer”,
<a class="reference external" href="https://quantum-journal.org/papers/q-2021-02-04-392/">Quantum 5, 392</a>.
(<a class="reference external" href="https://arxiv.org/abs/2010.02905">arXiv</a>)</p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/alvaro_ballon.png" alt="Alvaro Ballon" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Alvaro Ballon</h4>
        <p class="bio-text__author-description">Alvaro is a quantum computing educator at Xanadu. His work involves making the latest developments in quantum computing accessible to the community.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.048 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-photonics-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9c044b28e667350a01860dac4a776392/tutorial_photonics.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_photonics.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ca61e3633b7e537670afb33ca2e5bfc5/tutorial_photonics.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_photonics.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_photonics</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Photonic quantum computers</a><ul class='current'>
<li class='current'><a class="reference internal" href="#gaussian-states-of-light">Gaussian states of light</a></li>
<li class='current'><a class="reference internal" href="#gaussian-operations">Gaussian operations</a></li>
<li class='current'><a class="reference internal" href="#measuring-quadratures">Measuring quadratures</a></li>
<li class='current'><a class="reference internal" href="#beyond-gaussian-states">Beyond Gaussian states</a></li>
<li class='current'><a class="reference internal" href="#encoding-qubits-into-qumodes">Encoding qubits into qumodes</a></li>
<li class='current'><a class="reference internal" href="#the-state-of-the-art">The state of the art</a></li>
<li class='current'><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_photonics</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_quantum-computing.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial_toric_code.html" title="Modeling the toric code on a quantum computer"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_sc_qubits.html" title="Quantum computing with superconducting qubits"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-computing.html" >Quantum Computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Photonic quantum computers</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>