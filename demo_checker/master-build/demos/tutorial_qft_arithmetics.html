
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Learn how to use the quantum Fourier transform (QFT) to do basic arithmetic" property="og:description" />
<meta content="https://pennylane.ai/qml/_images/qft_arithmetics_thumbnail.png" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Basic arithmetic with the quantum Fourier transform (QFT) &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_qft_arithmetics.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Learn how to use the quantum Fourier transform (QFT) to do basic arithmetic" property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Basic arithmetic with the quantum Fourier transform (QFT) &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_qft_arithmetics.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum machine learning" href="../demos_qml.html" />
    <link rel="prev" title="Optimizing noisy circuits with Cirq" href="tutorial_noisy_circuit_optimization.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../demos_qml.html" title="Quantum machine learning"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_noisy_circuit_optimization.html" title="Optimizing noisy circuits with Cirq"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_getting-started.html" accesskey="U">Getting Started</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Basic arithmetic with the quantum Fourier transform (QFT)</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-demos-tutorial-qft-arithmetics-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="basic-arithmetic-with-the-quantum-fourier-transform-qft">
<span id="qft-arithmetics"></span><span id="sphx-glr-demos-tutorial-qft-arithmetics-py"></span><h1>Basic arithmetic with the quantum Fourier transform (QFT)<a class="headerlink" href="#basic-arithmetic-with-the-quantum-fourier-transform-qft" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = ["tutorial_qubit_rotation.html"];
    var related_tutorials_titles = ['Basis tutorial: qubit rotation'];
</script></p>
<p><em>Author: Guillermo Alonso-Linaje — Posted: 07 November 2022.</em></p>
<p>Arithmetic is a fundamental branch of mathematics that consists of the study of the main operations with numbers such as
addition, multiplication, subtraction and division. Using arithmetic operations we can understand the world around us
and solve many of our daily tasks.</p>
<p>Arithmetic is crucial for the implementation of any kind of algorithm in classical computer science, but also in quantum computing. For this reason, in this demo we are going to show
an approach to defining arithmetic operations on quantum computers.  The simplest and most direct way to achieve this goal is to use the
quantum Fourier transform (QFT), which we will demonstrate on a basic level.</p>
<p>In this demo we will not focus on understanding how the QFT is built,
as we can find a great explanation in the
<a class="reference external" href="https://codebook.xanadu.ai/F.1">Xanadu Quantum Codebook</a>. Instead, we will develop the
intuition for how it works and how we can best take advantage of it.</p>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>The first question we have to ask ourselves is whether it makes sense to perform these basic operations on a quantum computer. Is the
goal purely academic or is it really something that is needed in certain algorithms?  Why implement in a quantum computer
something that we can do with a calculator?</p>
<p>When it comes to basic quantum computing algorithms like the Deustch–Jozsa or
Grover’s algorithm, we might think that we have never needed to apply any arithmetic operations such as addition or multiplication.
However, the reality is different. When we learn about these algorithms from an academic point of view,
we work with a ready-made operator that we never have to worry about, the <em>oracle</em>.
Unfortunately, in real-world situations, we will have to build this seemingly magical operator by hand.
As an example, let’s imagine that we want to use Grover’s algorithm to search for <a class="reference external" href="https://en.wikipedia.org/wiki/Magic_square">magic squares</a>.
To define the oracle, which determines whether a solution is valid or not, we must perform sums over the rows and
columns to check that they all have the same value. Therefore, to create this oracle,
we will need to define a sum operator within the quantum computer.</p>
<p>The second question we face is why we should work with the QFT at all. There are other procedures that could be used to perform these basic operations; for example, by
imitating the classical algorithm. But, as we can see in <a class="footnote-reference brackets" href="#draper2000" id="id1">1</a>, it has already been proven that the QFT needs fewer qubits to perform these operations, which is
nowadays of vital importance.</p>
<p>We will organize the demo as follows. Initially, we will talk about the Fourier basis to give an intuitive idea of how
it works, after which we will address different basic arithmetic operations. Finally, we will move on to a practical example
in which we will factor numbers using Grover’s algorithm.</p>
</div>
<div class="section" id="qft-representation">
<h2>QFT representation<a class="headerlink" href="#qft-representation" title="Permalink to this headline">¶</a></h2>
<p>To apply the QFT to basic arithmetic operations, our objective now is to learn how to add,
subtract and multiply numbers using quantum devices. As we are working with qubits,
—which, like bits, can take the
values <span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(1\)</span>—we will represent the numbers in binary. For the
purposes of this tutorial, we will assume that we are working only with
integers. Therefore, if we have <span class="math notranslate nohighlight">\(n\)</span> qubits, we will be able to
represent the numbers from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(2^n-1\)</span>.</p>
<p>The first thing we need to know is PennyLane’s
standard for encoding numbers in a binary format. A binary number can be
represented as a string of 1s and 0s, which we can represent as the multi-qubit state</p>
<div class="math notranslate nohighlight">
\[\vert m \rangle = \vert \overline{q_0q_1...q_{n-1}}\rangle,\]</div>
<p>where the formula to obtain the equivalent decimal number <span class="math notranslate nohighlight">\(m\)</span> will be:</p>
<div class="math notranslate nohighlight">
\[m= \sum_{i = 0}^{n-1}2^{n-1-i}q_i.\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\vert m \rangle\)</span> refers to the basic state
generated by the binary encoding of the number <span class="math notranslate nohighlight">\(m\)</span>.
For instance, the natural number <span class="math notranslate nohighlight">\(6\)</span>
is represented by the quantum state <span class="math notranslate nohighlight">\(\vert 110\rangle,\)</span> since <span class="math notranslate nohighlight">\(\vert 110 \rangle = 1 \cdot 2^2 + 1\cdot 2^1+0\cdot 2^0 = 6\)</span>.</p>
<p>Let’s see how we would represent all the integers from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(7\)</span> using the product state of three qubits, visualized by separate Bloch spheres for each qubit.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../_images/3_qubits_computational_basis.gif"><img alt="../_images/3_qubits_computational_basis.gif" src="../_images/3_qubits_computational_basis.gif" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">Representation of integers using a computational basis of three qubits.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Bloch_sphere">Bloch sphere</a>
is a way of graphically representing the state of a qubit.
At the top of the sphere we place the state <span class="math notranslate nohighlight">\(\vert 0 \rangle,\)</span> at the bottom
<span class="math notranslate nohighlight">\(\vert 1 \rangle\)</span>, and in the rest of the
sphere we will place the possible states in superposition. It is a very useful
representation that helps better visualize and interpret quantum gates such as rotations.</p>
</div>
<p>We can use
the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisEmbedding.html#pennylane.BasisEmbedding" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">qml.BasisEmbedding</span></code></a>
template to obtain the binary representation in a simple way.
Let’s see how we would code the number <span class="math notranslate nohighlight">\(6\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="nd">@qml</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">basis_embedding_circuit</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisEmbedding.html#pennylane.BasisEmbedding" title="pennylane.BasisEmbedding" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisEmbedding</span></a><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.state.html#pennylane.state" title="pennylane.state" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">state</span></a><span class="p">()</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># number to be encoded</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.draw_mpl.html#pennylane.draw_mpl" title="pennylane.draw_mpl" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">draw_mpl</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">basis_embedding_circuit</span></a><span class="p">,</span> <span class="n">show_all_wires</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_qft_arithmetics_001.png" srcset="../_images/sphx_glr_tutorial_qft_arithmetics_001.png" alt="tutorial qft arithmetics" class = "sphx-glr-single-img"/><p>As we can see, the first qubit—the <span class="math notranslate nohighlight">\(0\)</span>-th wire—is placed on top and the rest of the qubits are
below it. However, this is not the only way we could represent numbers.
We can also represent them in different bases, such as the so-called <em>Fourier base</em>.</p>
<p>In this case, all the states of the basis will be represented via qubits in
the XY-plane of the Bloch sphere, each rotated by a certain
amount.</p>
<p>How do we know how much we must rotate each qubit to represent a certain number?
It is actually very easy! Suppose we are working with
<span class="math notranslate nohighlight">\(n\)</span> qubits and we want to represent the number <span class="math notranslate nohighlight">\(m\)</span> in the
Fourier basis. Then the <span class="math notranslate nohighlight">\(j\)</span>-th qubit will have the phase:</p>
<div class="math notranslate nohighlight">
\[\alpha_j = \frac{2m\pi}{2^{j}}.\]</div>
<p>Now we can represent numbers in the Fourier basis using three qubits:</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/3_qubits_fourier_basis.gif"><img alt="../_images/3_qubits_fourier_basis.gif" src="../_images/3_qubits_fourier_basis.gif" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">Representation of integers using the Fourier basis with three qubits</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>As we can see, the third qubit will rotate
<span class="math notranslate nohighlight">\(\frac{1}{8}\)</span> of a turn counterclockwise with each number. The next qubit
rotates <span class="math notranslate nohighlight">\(\frac{1}{4}\)</span> of a full turn and, finally, the first qubit rotates
half a turn for each increase in number.</p>
</div>
<div class="section" id="adding-a-number-to-a-register">
<h2>Adding a number to a register<a class="headerlink" href="#adding-a-number-to-a-register" title="Permalink to this headline">¶</a></h2>
<p>The fact that the states encoding the numbers are now in phase gives us great
flexibility in carrying out our arithmetic operations. To see this in practice,
let’s look at the situation in which want to create an operator Sum
such that:</p>
<div class="math notranslate nohighlight">
\[\text{Sum(k)}\vert m \rangle = \vert m + k \rangle.\]</div>
<p>The procedure to implement this unitary operation is the following:</p>
<ol class="arabic simple">
<li><p>We convert the state from the computational basis into the Fourier basis by applying the QFT to the <span class="math notranslate nohighlight">\(\vert m \rangle\)</span> state via the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QFT.html#pennylane.QFT" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QFT</span></code></a> operator.</p></li>
<li><p>We rotate the <span class="math notranslate nohighlight">\(j\)</span>-th qubit by the angle <span class="math notranslate nohighlight">\(\frac{2k\pi}{2^{j}}\)</span> using the <span class="math notranslate nohighlight">\(R_Z\)</span> gate, which leads to the new phases, <span class="math notranslate nohighlight">\(\frac{2(m + k)\pi}{2^{j}}\)</span>.</p></li>
<li><p>We apply the QFT inverse to return to the computational basis and obtain <span class="math notranslate nohighlight">\(m+k\)</span>.</p></li>
</ol>
<p>Let’s see how this process would look in PennyLane.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">from</span> <span class="nn">pennylane</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">n_wires</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add_k_fourier</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">wires</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires</span><span class="p">)):</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.RZ.html#pennylane.RZ" title="pennylane.RZ" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">RZ</span></a><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">j</span><span class="p">),</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisEmbedding.html#pennylane.BasisEmbedding" title="pennylane.BasisEmbedding" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisEmbedding</span></a><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">))</span>  <span class="c1"># m encoding</span>

    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QFT.html#pennylane.QFT" title="pennylane.QFT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">QFT</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">))</span>  <span class="c1"># step 1</span>

    <span class="n">add_k_fourier</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">))</span>  <span class="c1"># step 2</span>

    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QFT.html#pennylane.QFT" title="pennylane.QFT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">QFT</span></a><span class="p">)(</span><span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">))</span>  <span class="c1"># step 3</span>

    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The ket representation of the sum of 3 and 4 is </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The ket representation of the sum of 3 and 4 is [0 1 1 1]
</pre></div>
</div>
<p>Perfect, we have obtained <span class="math notranslate nohighlight">\(\vert 0111 \rangle\)</span>, which is equivalent to the number <span class="math notranslate nohighlight">\(7\)</span> in binary!</p>
<p>Note that this is a deterministic algorithm, which means that we have obtained the desired solution by executing a single shot.
On the other hand, if the result of an operation is greater than the maximum
value <span class="math notranslate nohighlight">\(2^n-1\)</span>, we will start again from zero, that is to say, we
will calculate the sum modulo <span class="math notranslate nohighlight">\(2^n-1.\)</span> For instance, in our three-qubit example, suppose that
we want to calculate <span class="math notranslate nohighlight">\(6+3.\)</span> We see that we do not have
enough memory space, as <span class="math notranslate nohighlight">\(6+3 = 9 &gt; 2^3-1\)</span>. The result we will get will
be <span class="math notranslate nohighlight">\(9 \pmod 8 = 1\)</span>, or <span class="math notranslate nohighlight">\(\vert 001 \rangle\)</span> in binary. Make sure to use
enough qubits to represent your solutions!
Finally, it is important to point out that it is not necessary to know how the
QFT is constructed in order to use it. By knowing the properties of the
new basis, we can use it in a simple way.</p>
</div>
<div class="section" id="adding-two-different-registers">
<h2>Adding two different registers<a class="headerlink" href="#adding-two-different-registers" title="Permalink to this headline">¶</a></h2>
<p>In this previous algorithm, we had to pass to the operator the value of <span class="math notranslate nohighlight">\(k\)</span> that we wanted to add to the starting state.
But at other times, instead of passing that value to the operator, we would like it to pull the information from another register.
That is, we are looking for a new operator <span class="math notranslate nohighlight">\(\text{Sum}_2\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\text{Sum}_2\vert m \rangle \vert k \rangle \vert 0 \rangle = \vert m \rangle \vert k \rangle \vert m+k \rangle.\]</div>
<p>In this case, we can understand the third register (which is initially
at <span class="math notranslate nohighlight">\(0\)</span>) as a counter that will tally as many units as <span class="math notranslate nohighlight">\(m\)</span> and
<span class="math notranslate nohighlight">\(k\)</span> combined. The binary decomposition will
make this simple. If we have <span class="math notranslate nohighlight">\(\vert m \rangle = \vert \overline{q_0q_1q_2} \rangle\)</span>, we will
have to add <span class="math notranslate nohighlight">\(1\)</span> to the counter if <span class="math notranslate nohighlight">\(q_2 = 1\)</span> and nothing
otherwise. In general, we should add <span class="math notranslate nohighlight">\(2^{n-i-1}\)</span> units if the <span class="math notranslate nohighlight">\(i\)</span>-th
qubit is in state <span class="math notranslate nohighlight">\(\vert 1 \rangle\)</span> and 0 otherwise. As we can see, this is the same idea that is also
behind the concept of a controlled gate. Indeed, observe that we will, indeed, apply a corresponding
phase if indeed the control qubit is in the state <span class="math notranslate nohighlight">\(\vert 1\rangle\)</span>.
Let us now code the <span class="math notranslate nohighlight">\(\text{Sum}_2\)</span> operator.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wires_m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>             <span class="c1"># qubits needed to encode m</span>
<span class="n">wires_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>             <span class="c1"># qubits needed to encode k</span>
<span class="n">wires_solution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>   <span class="c1"># qubits needed to encode the solution</span>

<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires_m</span> <span class="o">+</span> <span class="n">wires_k</span> <span class="o">+</span> <span class="n">wires_solution</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">n_wires</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QubitDevice.html#pennylane.QubitDevice.wires" title="pennylane.QubitDevice.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">dev</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span> <span class="c1"># total number of qubits used</span>

<span class="k">def</span> <span class="nf">addition</span><span class="p">(</span><span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">):</span>
    <span class="c1"># prepare solution qubits to counting</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QFT.html#pennylane.QFT" title="pennylane.QFT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">QFT</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>

    <span class="c1"># add m to the counter</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_m</span><span class="p">)):</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.ctrl.html#pennylane.ctrl" title="pennylane.ctrl" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">ctrl</span></a><span class="p">(</span><span class="n">add_k_fourier</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="n">wires_m</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span><span class="mi">2</span> <span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_m</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">wires_solution</span><span class="p">)</span>

    <span class="c1"># add k to the counter</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_k</span><span class="p">)):</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.ctrl.html#pennylane.ctrl" title="pennylane.ctrl" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">ctrl</span></a><span class="p">(</span><span class="n">add_k_fourier</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="n">wires_k</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span><span class="mi">2</span> <span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_k</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">wires_solution</span><span class="p">)</span>

    <span class="c1"># return to computational basis</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QFT.html#pennylane.QFT" title="pennylane.QFT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">QFT</span></a><span class="p">)(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sum2</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">):</span>
    <span class="c1"># m and k codification</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisEmbedding.html#pennylane.BasisEmbedding" title="pennylane.BasisEmbedding" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisEmbedding</span></a><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires_m</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisEmbedding.html#pennylane.BasisEmbedding" title="pennylane.BasisEmbedding" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisEmbedding</span></a><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires_k</span><span class="p">)</span>

    <span class="c1"># apply the addition circuit</span>
    <span class="n">addition</span><span class="p">(</span><span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">)</span>

    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The ket representation of the sum of 7 and 3 is &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sum2</span></a><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">wires_m</span><span class="p">,</span><span class="w"> </span><span class="n">wires_k</span><span class="p">,</span><span class="w"> </span><span class="n">wires_solution</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.draw_mpl.html#pennylane.draw_mpl" title="pennylane.draw_mpl" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">draw_mpl</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sum2</span></a><span class="p">,</span> <span class="n">show_all_wires</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_qft_arithmetics_002.png" srcset="../_images/sphx_glr_tutorial_qft_arithmetics_002.png" alt="tutorial qft arithmetics" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The ket representation of the sum of 7 and 3 is [1 0 1 0]
</pre></div>
</div>
<p>Great! We have just seen how to add a number to a counter. In the example above,
we added <span class="math notranslate nohighlight">\(3 + 7\)</span> to get <span class="math notranslate nohighlight">\(10\)</span>, which in binary
is <span class="math notranslate nohighlight">\(\vert 1010 \rangle\)</span>.</p>
</div>
<div class="section" id="multiplying-qubits">
<h2>Multiplying qubits<a class="headerlink" href="#multiplying-qubits" title="Permalink to this headline">¶</a></h2>
<p>Following the same idea, we will see how easily we can
implement multiplication. For this purpose we’ll take two arbitrary numbers <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(k\)</span>
to carry out the operation. This time, we look for an operator Mul such that</p>
<div class="math notranslate nohighlight">
\[\text{Mul}\vert m \rangle \vert k \rangle \vert 0 \rangle = \vert m \rangle \vert k \rangle \vert m\cdot k \rangle.\]</div>
<p>To understand the multiplication process, let’s work with the binary decomposition of
<span class="math notranslate nohighlight">\(k:=\sum_{i=0}^{n-1}2^{n-i-1}k_i\)</span> and
<span class="math notranslate nohighlight">\(m:=\sum_{j=0}^{l-1}2^{l-j-1}m_i\)</span>. In this case, the product would
be:</p>
<div class="math notranslate nohighlight">
\[k \cdot m = \sum_{i=0}^{n-1}\sum_{j = 0}^{l-1}m_ik_i (2^{n-i-1} \cdot 2^{l-j-1}).\]</div>
<p>In other words, if <span class="math notranslate nohighlight">\(k_i = 1\)</span> and <span class="math notranslate nohighlight">\(m_i = 1\)</span>, we would add
<span class="math notranslate nohighlight">\(2^{n-i-1} \cdot 2^{l-j-1}\)</span> units to the counter, where <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(l\)</span>
are the number of qubits with which we encode <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(k\)</span> respectively.
Let’s code to see how it works!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wires_m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>           <span class="c1"># qubits needed to encode m</span>
<span class="n">wires_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>           <span class="c1"># qubits needed to encode k</span>
<span class="n">wires_solution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>  <span class="c1"># qubits needed to encode the solution</span>

<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires_m</span> <span class="o">+</span> <span class="n">wires_k</span> <span class="o">+</span> <span class="n">wires_solution</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">n_wires</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QubitDevice.html#pennylane.QubitDevice.wires" title="pennylane.QubitDevice.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">dev</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>

<span class="k">def</span> <span class="nf">multiplication</span><span class="p">(</span><span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">):</span>
    <span class="c1"># prepare sol-qubits to counting</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QFT.html#pennylane.QFT" title="pennylane.QFT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">QFT</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>

    <span class="c1"># add m to the counter</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_k</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_m</span><span class="p">)):</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_m</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">wires_k</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
            <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.ctrl.html#pennylane.ctrl" title="pennylane.ctrl" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">ctrl</span></a><span class="p">(</span><span class="n">add_k_fourier</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="p">[</span><span class="n">wires_k</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">wires_m</span><span class="p">[</span><span class="n">j</span><span class="p">]])(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">)</span>

    <span class="c1"># return to computational basis</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QFT.html#pennylane.QFT" title="pennylane.QFT" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">QFT</span></a><span class="p">)(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="c1"># m and k codification</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisEmbedding.html#pennylane.BasisEmbedding" title="pennylane.BasisEmbedding" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisEmbedding</span></a><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires_m</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisEmbedding.html#pennylane.BasisEmbedding" title="pennylane.BasisEmbedding" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisEmbedding</span></a><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires_k</span><span class="p">)</span>

    <span class="c1"># Apply multiplication</span>
    <span class="n">multiplication</span><span class="p">(</span><span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">)</span>

    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.sample.html#pennylane.sample" title="pennylane.sample" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">sample</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The ket representation of the multiplication of 3 and 7 is </span><span class="si">{</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mul</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.draw_mpl.html#pennylane.draw_mpl" title="pennylane.draw_mpl" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">draw_mpl</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mul</span></a><span class="p">,</span> <span class="n">show_all_wires</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_qft_arithmetics_003.png" srcset="../_images/sphx_glr_tutorial_qft_arithmetics_003.png" alt="tutorial qft arithmetics" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The ket representation of the multiplication of 3 and 7 is [1 0 1 0 1]
</pre></div>
</div>
<p>Awesome! We have multiplied <span class="math notranslate nohighlight">\(7 \cdot 3\)</span> and, as a result, we have
<span class="math notranslate nohighlight">\(\vert 10101 \rangle\)</span>, which is <span class="math notranslate nohighlight">\(21\)</span> in binary.</p>
</div>
<div class="section" id="factorization-with-grover">
<h2>Factorization with Grover<a class="headerlink" href="#factorization-with-grover" title="Permalink to this headline">¶</a></h2>
<p>With this, we have already gained a large repertoire of interesting
operations that we can do, but we can give the idea one more twist and
apply what we have learned in an example.</p>
<p>Let’s imagine now that we want just the opposite: to factor the
number <span class="math notranslate nohighlight">\(21\)</span> as a product of two terms. Is this something we could do
using our previous reasoning? The answer is yes! We can make use of
<a class="reference external" href="https://en.wikipedia.org/wiki/Grover%27s_algorithm">Grover’s algorithm</a> to
amplify the states whose product is the number we
are looking for. All we would need is to construct the oracle <span class="math notranslate nohighlight">\(U\)</span>, i.e., an
operator such that</p>
<div class="math notranslate nohighlight">
\[U\vert m \rangle \vert k \rangle = \vert m \rangle \vert k \rangle \text{ if }m\cdot k \not = 21,\]</div>
<div class="math notranslate nohighlight">
\[U\vert m \rangle \vert k \rangle = -\vert m \rangle \vert k \rangle \text{ if }m\cdot k  = 21\]</div>
<p>The idea of the oracle is as simple as this:</p>
<ol class="arabic simple">
<li><p>use auxiliary registers to store the product,</p></li>
<li><p>check if the product state is <span class="math notranslate nohighlight">\(\vert 10101 \rangle\)</span> and, in that case, change the sign,</p></li>
<li><p>execute the inverse of the circuit to clear the auxiliary qubits.</p></li>
<li><p>calculate the probabilities and see which states have been amplified.</p></li>
</ol>
<p>Let’s go back to PennyLane to implement this idea.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">21</span> <span class="c1"># number we want to factor</span>

<span class="n">wires_m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>                 <span class="c1"># qubits needed to encode m</span>
<span class="n">wires_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>                 <span class="c1"># qubits needed to encode k</span>
<span class="n">wires_solution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>   <span class="c1"># qubits needed to encode the solution</span>

<span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires_m</span> <span class="o">+</span> <span class="n">wires_k</span> <span class="o">+</span> <span class="n">wires_solution</span><span class="p">)</span>

<span class="n">n_wires</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QubitDevice.html#pennylane.QubitDevice.wires" title="pennylane.QubitDevice.wires" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-attribute"><span class="n">dev</span><span class="o">.</span><span class="n">wires</span></a><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">factorization</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">):</span>
    <span class="c1"># Superposition of the input</span>
    <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="n">wires_m</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wire</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="n">wires_k</span><span class="p">:</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hadamard.html#pennylane.Hadamard" title="pennylane.Hadamard" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Hadamard</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wire</span><span class="p">)</span>

    <span class="c1"># Apply the multiplication</span>
    <span class="n">multiplication</span><span class="p">(</span><span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">)</span>

    <span class="c1"># Change sign of n</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.FlipSign.html#pennylane.FlipSign" title="pennylane.FlipSign" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">FlipSign</span></a><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>

    <span class="c1"># Uncompute multiplication</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.adjoint.html#pennylane.adjoint" title="pennylane.adjoint" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">adjoint</span></a><span class="p">(</span><span class="n">multiplication</span><span class="p">)(</span><span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">)</span>

    <span class="c1"># Apply Grover operator</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.GroverOperator.html#pennylane.GroverOperator" title="pennylane.GroverOperator" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">GroverOperator</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_m</span> <span class="o">+</span> <span class="n">wires_k</span><span class="p">)</span>

    <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.probs.html#pennylane.probs" title="pennylane.probs" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">probs</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_m</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="nb">len</span><span class="p">(</span><span class="n">wires_m</span><span class="p">)),</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">factorization</span></a><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Basic states&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_qft_arithmetics_004.png" srcset="../_images/sphx_glr_tutorial_qft_arithmetics_004.png" alt="tutorial qft arithmetics" class = "sphx-glr-single-img"/><p>By plotting the probabilities of obtaining each basic state we see that
prime factors have been amplified! Factorization via Grover’s algorithm
does not achieve exponential improvement that
<a class="reference external" href="https://en.wikipedia.org/wiki/Shor%27s_algorithm">Shor’s algorithm</a> does, but we
can see that this construction is simple and a great example to
illustrate basic arithmetic!</p>
<p>I hope we can now all see that oracles are not something magical and that there
is a lot of work behind their construction! This will help us in the future to build
more complicated operators, but until then, let’s keep on learning. 🚀</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="draper2000"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Thomas G. Draper, “Addition on a Quantum Computer”. <a class="reference external" href="https://arxiv.org/abs/quant-ph/0008033">arXiv:quant-ph/0008033</a>.</p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/guillermo_alonso.jpeg" alt="Guillermo Alonso-Linaje" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Guillermo Alonso-Linaje</h4>
        <p class="bio-text__author-description">Guillermo is a mathematics and computer science graduate from the university of Valladolid and is currently working as an educator and quantum researcher at Xanadu. Fun fact, Guillermo is a great foosball player and is also a paella master.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.582 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-qft-arithmetics-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/bc3ac63027a94e04e41ced056335a05e/tutorial_qft_arithmetics.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_qft_arithmetics.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/999c6e9303b3197c03c327e2c9137b88/tutorial_qft_arithmetics.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_qft_arithmetics.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_qft_arithmetics</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Basic arithmetic with the quantum Fourier transform (QFT)</a><ul class='current'>
<li class='current'><a class="reference internal" href="#motivation">Motivation</a></li>
<li class='current'><a class="reference internal" href="#qft-representation">QFT representation</a></li>
<li class='current'><a class="reference internal" href="#adding-a-number-to-a-register">Adding a number to a register</a></li>
<li class='current'><a class="reference internal" href="#adding-two-different-registers">Adding two different registers</a></li>
<li class='current'><a class="reference internal" href="#multiplying-qubits">Multiplying qubits</a></li>
<li class='current'><a class="reference internal" href="#factorization-with-grover">Factorization with Grover</a></li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_qft_arithmetics</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_getting-started.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../demos_qml.html" title="Quantum machine learning"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_noisy_circuit_optimization.html" title="Optimizing noisy circuits with Cirq"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_getting-started.html" >Getting Started</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Basic arithmetic with the quantum Fourier transform (QFT)</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>